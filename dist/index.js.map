{"version":3,"sources":["webpack://cui-light/webpack/universalModuleDefinition","webpack://cui-light/webpack/bootstrap","webpack://cui-light/./src/core/utils/functions.ts","webpack://cui-light/./src/core/utils/statics.ts","webpack://cui-light/./src/core/utils/logger.ts","webpack://cui-light/./src/core/factories/logger.ts","webpack://cui-light/./src/core/models/errors.ts","webpack://cui-light/./src/core/models/setup.ts","webpack://cui-light/./src/core/helpers/helpers.ts","webpack://cui-light/./src/core/utils/actions.ts","webpack://cui-light/./src/app/managers/element.ts","webpack://cui-light/./src/app/observers/mutations.ts","webpack://cui-light/./src/app/managers/toast.ts","webpack://cui-light/./src/app/helpers/collection.ts","webpack://cui-light/./src/app/managers/collection.ts","webpack://cui-light/./src/app/managers/plugins.ts","webpack://cui-light/./src/app/instance.ts","webpack://cui-light/./src/core/listeners/media.ts","webpack://cui-light/./src/plugins/light/light.ts","webpack://cui-light/./src/app/handlers/base.ts","webpack://cui-light/./src/components/icon/icon.ts","webpack://cui-light/./src/components/circle/circle.ts","webpack://cui-light/./src/components/spinner/spinner.ts","webpack://cui-light/./src/components/dummy/dummy.ts","webpack://cui-light/./src/components/scroll/scroll.ts","webpack://cui-light/./src/core/listeners/scroll.ts","webpack://cui-light/./src/components/scrollspy/scrollspy.ts","webpack://cui-light/./src/plugins/print/print.ts","webpack://cui-light/./src/app/observers/intersection.ts","webpack://cui-light/./src/components/intersection/intersection.ts","webpack://cui-light/./src/components/open/open.ts","webpack://cui-light/./src/components/close/close.ts","webpack://cui-light/./src/components/toggle/toggle.ts","webpack://cui-light/./src/components/resize/resize.ts","webpack://cui-light/./src/core/listeners/keys.ts","webpack://cui-light/./src/plugins/keys/observer.ts","webpack://cui-light/./src/plugins/keys/keys.ts","webpack://cui-light/./src/app/initializer.ts","webpack://cui-light/./src/core/utils/interactions.ts","webpack://cui-light/./src/core/utils/dictionary.ts","webpack://cui-light/./src/app/managers/cache.ts","webpack://cui-light/./src/core/bus/bus.ts","webpack://cui-light/./src/core/bus/handlers.ts","webpack://cui-light/./src/core/bus/executors.ts","webpack://cui-light/./src/core/styles/appender.ts","webpack://cui-light/./src/app/handlers/colors.ts","webpack://cui-light/./src/app/observers/resize.ts","webpack://cui-light/./src/core/models/utils.ts","webpack://cui-light/./src/core/factories/interactions.ts","webpack://cui-light/./src/index.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","is","val","typecheck","length","Array","isArray","getName","prefix","sleep","timeout","Promise","resolve","setTimeout","createElementFromString","htmlString","template","document","createElement","innerHTML","content","children","getRangeValue","min","max","getRangeValueOrDefault","def","isNaN","clone","assign","joinAttributesForQuery","attributes","join","getSystemLightMode","matchMedia","matches","getSystemPrintMode","are","calcWindowSize","width","getOffsetTop","element","offsetTop","parseInt","getStyleValue","getOffsetLeft","offsetLeft","getIntOrDefault","integer","target","currentStyle","getComputedStyle","getPropertyValue","isInRange","getActiveClass","parseAttribute","attribute","ret","out","startsWith","endsWith","JSON","parse","e","console","error","component","functionName","Date","toLocaleString","trim","includes","split","forEach","sp","parseAttributeString","getAttribute","getStringOrDefault","toLowerCase","isString","replacePrefix","replace","generateCUID","next","generateRandomString","rand","getRandomInt","rand2","Math","floor","random","ceil","registerCuiElement","node","components","utils","$handlers","matching","hasAttribute","filter","a","match","find","styleAppender","append","getStyle","handler","handle","message","$cuid","tagName","counter","idx","CLASSES","dark","animProgress","print","active","ICONS","close","accordion","special_menu","special_fail","special_success","CSS_APP_BACKGROUND_COLORS","light","CSS_COMPONENT_BACKGROUND_COLORS","CSS_COMPONENT_BORDER_COLORS","CSS_THEMES","base","muted","accent","secondary","success","warning","CSS_VARIABLES","fontSize","lineHeight","animationTime","animationTimeLong","animationTimeShort","colorLightAppBackground","colorLightBackground","colorLightBorder","colorLightBase","colorLightActive","colorLightMuted","colorDarkAppBackground","colorDarkBackground","colorDarkBorder","colorDarkBase","colorDarkActive","colorDarkMuted","colorAccent","colorAccentActive","colorAccentMuted","colorAccentShade","colorAccentShadeDark","colorSecondary","colorSecondaryActive","colorSecondaryMuted","colorSecondaryShade","colorSecondaryShadeDark","colorWarning","colorWarningActive","colorWarningMuted","colorWarningShade","colorWarningShadeDark","colorSuccess","colorSuccessActive","colorSuccessMuted","colorSuccessShade","colorSuccessShadeDark","colorError","colorErrorActive","colorErrorMuted","colorErrorShade","colorErrorShadeDark","inputBackground","colorShade","colorShadeDarker","colorShadeLight","colorShadeLighter","outline","borderRadius","padding","margin","scrollbarWidth","componentSpace","STATICS","logLevel","EVENTS","INSTANCE_INITIALIZED","INSTANCE_FINISHED","ON_RESIZE","ON_OPEN","ON_CLOSE","ON_TOGGLE","ON_SCROLL","ON_TARGET_CHANGE","ON_INTERSECTION","ON_KEYDOWN","ON_SCROLLBY","COMPONENTS_COUNTER","CuiLogger","level","this","id","log","prepString","warn","exception","stack","callback","start","now","ErrorBase","Error","super","setPrototypeOf","ItemNotFoundError","ArgumentError","CuiInstanceInitError","CuiScrollSpyOutOfRangeError","RegisterElementError","CuiSetup","autoLightMode","scrollThreshold","resizeThreshold","plugins","init","cacheSize","CuiSetupInit","app","interaction","body","interactions","action","mutate","add","classList","remove","className","contains","CuiInboundAction","setLightMode","setDarkMode","getLightMode","DummyAction","substring","elements","classes","fetch","attributeName","reduce","current","push","attributeValue","setAttribute","removeAttribute","onClick","addEventListener","eventName","lock","index","unlock","delay","setup","change","openClass","animationClass","performAction","then","closeClass","args","_log","subtree","childList","attributeFilter","debug","MutationObserver","mutationCallback","observe","disconnect","mutations","observer","mutation","type","item","refresh","handleChildListMutation","onMutation","addedLen","addedNodes","removedLen","removedNodes","handleAddedNodes","handleRemovedNodes","nodes","childrens","hasChildNodes","querySelectorAll","child","destroySingleElement","destroy","toastElement","querySelector","appendChild","currentElement","nextElement","animIn","animOut","count","newIndex","animClassIn","animClassOut","duration","addAnimationClass","setFinalClasses","len","setElements","setToggle","set","check","newIdx","getCurrentIndex","verifyIndex","setCurrent","setCurrentWithAnimation","plugin","description","tasks","all","mutatedAttributes","map","x","initElements","setComponents","setAttributes","setPlugins","setProperty","bus","emit","stop","selector","existing","cache","newElement","put","manager","show","event","context","on","CuiMediaQueryListener","mediaQuery","removeEventListener","ev","autoLightInit","autoLight","setCallback","onChange","attach","detach","autoLightSetup","componentName","cuid","data","icon","CuiIconComponent","addIcon","svg","iconStr","iconSvg","build","childNodes","insertBefore","iconElement","firstChild","svgString","style","scale","created","IconScaleAppender","height","toString","getTotalLength","readStyle","strokeDashoffset","progress","updateStyle","spinnerName","svgIcon","addSpinner","CuiDummyComponent","parseArguments","to","by","scrollTop","scrollBy","top","behavior","emitEvent","parent","timestamp","preventDefault","parentElement","threshold","listener","scrollLeft","passedThreshold","requestAnimationFrame","left","offset","link","linkAction","CuiScrollspyComponent","calculateCurrent","onScroll","abs","calculateCurrentLeft","newTarget","scroll","findIndex","ratio","clientHeight","clientWidth","autoPrintInit","autoPrint","setPrintMode","CuiIntersectionObserver","IntersectionObserver","rootMargin","unobserve","CuiIntersectionComponent","onIntersection","connect","prev","entries","entry","getAction","isIntersecting","intersectionRatio","emitIntersection","CuiOpenComponent","isValid","emitOpen","CuiCloseComponent","getTarget","emitClose","CuiToggleComponent","toggle","CuiResizeComponent","resize","singleEmit","keys","onKeyDown","onKeyUp","code","keySetup","settings","appPrefix","result","icons","initializer","pluginList","componentList","FastDom","isScheduled","raf","writes","reads","ctx","createTask","schedule","task","shift","recursion","flush","rec","run","SyncInteractions","isRunning","throwOnEmptyKey","containsKey","indexOf","splice","maxSize","has","update","clean","clear","emitHandler","cui","prepareEventId","getCuid","getId","isAttached","g","queue","isBusy","emitId","handleId","executor","events","perform","promises","idMatches","execute","apply","head","getElementsByTagName","text","createTextNode","documentElement","setPropertyIn","toCssString","colors","baseColor","mutedColor","lighten","activeColor","darken","factor","propertyName","innerWidth","diff","currentSize","resizeData","previous","innerHeight","initialSetup","fromInit","flag","prop","cuiInit"],"mappings":"CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,YAAa,GAAIH,GACE,iBAAZC,QACdA,QAAQ,aAAeD,IAEvBD,EAAK,aAAeC,IARtB,CASGK,QAAOA,WACV,O,YCTE,IAAIC,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GACnB,OAAOF,EAAiBE,GAAUP,QAGnC,IAAIC,EAASI,EAAiBE,GAAY,CACzCC,EAAGD,EACHE,GAAEA,EACFT,QAAS,IAUV,OANAU,EAAQH,GAAUI,KAAKV,EAAOD,QAASC,EAAQA,EAAOD,QAASM,GAG/DL,EAAOQ,KAGAR,EAAOD,QA0Df,OArDAM,EAAoBM,EAAIF,EAGxBJ,EAAoBO,EAAIR,EAGxBC,EAAoBQ,EAAI,SAASd,EAASe,EAAMC,GAC3CV,EAAoBW,EAAEjB,EAASe,IAClCG,OAAOC,eAAenB,EAASe,EAAM,CAAEK,YAAWA,EAAOC,IAAKL,KAKhEV,EAAoBgB,EAAI,SAAStB,GACX,oBAAXuB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAenB,EAASuB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAenB,EAAS,aAAc,CAAEyB,OAAMA,KAQtDnB,EAAoBoB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQnB,EAAoBmB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MAGvB,GAFAxB,EAAoBgB,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,YAAWA,EAAOK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOnB,EAAoBQ,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRvB,EAAoB2B,EAAI,SAAShC,GAChC,IAAIe,EAASf,GAAUA,EAAO2B,WAC7B,WAAwB,OAAO3B,EAAgB,SAC/C,WAA8B,OAAOA,GAEtC,OADAK,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASiB,EAAQC,GAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,EAAQC,IAGzG7B,EAAoBgC,EAAI,GAIjBhC,EAAoBA,EAAoBiC,EAAI,G,+BCjFrD/B,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,sCAAAA,EAAA,KAAAA,EAAA,GAaO,SAASgC,EAAGC,EAAUC,MACzB,QAAI,MAAOD,GACFC,GAgBN,SAAiBD,GACpB,MAAmB,iBAARA,EACe,IAAfA,EAAIE,OAEI,kBAARF,EACAA,IAEFG,MAAMC,QAAQJ,IACG,IAAfA,EAAIE,OARZ,CAbqBF,IA0BrB,SAASK,EAAQC,EAAgBhC,GACpC,IAAKyB,EAAGO,KAAYP,EAAGzB,GACnB,MAAM,IAAI,IAAc,0BAE5B,MAAO,GAAGgC,KAAUhC,IAGjB,SAASiC,EAAMC,GAClB,OAAO,IAAIC,QAAQC,GAAWC,WAAW,KACrCD,OACDF,IAOA,SAASI,EAAwBC,GACpC,IAAKd,EAAGc,GACJ,OAAO,KAEX,IAAIC,EAAWC,SAASC,cAAc,YAEtC,OADAF,EAASG,UAAYJ,EACdC,EAASI,QAAQC,SAASjB,OAAS,EAAIY,EAASI,QAAQC,SAAS,GAAK,KAyB1E,SAASC,EAAcpC,EAAeqC,EAAaC,GACtD,OAAItC,EAAQqC,EACDA,EACArC,EAAQsC,EACRA,EAEJtC,EAGJ,SAASuC,EAAuBvC,EAAeqC,EAAaC,EAAaE,GAC5E,OAAIxC,SAAkDyC,MAAMzC,GACjDwC,EAEJJ,EAAcpC,EAAOqC,EAAKC,GAW9B,SAASI,EAAMjC,GAClB,OAAKM,EAAGN,GAGDhB,OAAOkD,OAAO,GAAIlC,GAFd,KAaR,SAASmC,EAAuBC,GACnC,OAAK9B,EAAG8B,GAGD,IAAIA,EAAWC,KAAK,UAFhB,GASR,SAASC,IACZ,OAAOpE,OAAOqE,YACVrE,OAAOqE,WAAW,gCAAgCC,QAAU,OAAS,QAOtE,SAASC,IACZ,OAAOvE,OAAOqE,YACVrE,OAAOqE,WAAW,SAASC,QAO5B,SAASE,KAAON,GACnB,IAAK9B,EAAG8B,GACJ,OAAM,EAEV,IAAIzD,EAAIyD,EAAW3B,OACnB,IAAK,IAAInC,EAAI,EAAGA,EAAIK,EAAGL,IACnB,IAAKgC,EAAG8B,EAAW9D,IACf,OAAM,EAGd,OAAM,EAGH,SAASqE,EAAeC,GAC3B,OAAIA,GAAS,IACF,QACAA,EAAQ,KAAOA,GAAS,IACxB,SACAA,EAAQ,KAAOA,GAAS,KACxB,QAEJ,SA4DJ,SAASC,EAAaC,GACzB,IAAKxC,EAAGwC,GACJ,OAAQ,EAEZ,IAAIvC,EAAMuC,EAAQC,UAAYC,SAASC,EAAcH,EAAS,eAAiBE,SAASC,EAAcH,EAAS,gBAAkBE,SAASC,EAAcH,EAAS,qBACjK,OAAOvC,EAAM,EAAIuC,EAAQC,UAAYxC,EAIlC,SAAS2C,EAAcJ,GAC1B,IAAKxC,EAAGwC,GACJ,OAAQ,EAEZ,IAAIvC,EAAMuC,EAAQK,WAAaH,SAASC,EAAcH,EAAS,gBAAkBE,SAASC,EAAcH,EAAS,iBAAmBE,SAASC,EAAcH,EAAS,sBACpK,OAAOvC,EAAM,EAAIuC,EAAQK,WAAa5C,EAGnC,SAAS6C,EAAgB7D,EAAYwC,GACxC,IAAIsB,EAAUL,SAASzD,GACvB,OAAOyC,MAAMqB,GAAWtB,EAAMsB,EAG3B,SAASJ,EAAcK,EAAarD,GACvC,OAAKK,EAAGgD,IAAYhD,EAAGL,GAGnBqD,EAAOC,aACAD,EAAOC,aAAatD,GACpB/B,OAAOsF,iBACPtF,OAAOsF,iBAAiBF,EAAQ,MAAMG,iBAAiBxD,GAE3D,KAPI,KAcR,SAASyD,EAAUnE,EAAeqC,EAAaC,GAClD,OAAOvB,EAAGf,IAAUA,GAASqC,GAAOrC,GAASsC,EAG1C,SAAS8B,EAAe9C,GAC3B,OAAUA,UAAU,IAAb,UAGJ,SAAS+C,EAAed,EAAkBe,GAC7C,OAAOnB,EAAII,EAASe,GA/FjB,SAA8BA,GACjC,IAAIC,EA0BD,SAAyBD,GAC5B,IAAIE,EAAM,KACV,GAAIzD,EAAGuD,IAAcA,EAAUG,WAAW,MAAQH,EAAUI,SAAS,KAAM,CACvE,IACIF,EAaL,SAAiBF,GACpB,OAAOA,GAAaA,EAAUpD,OAAS,EAAIyD,KAAKC,MAAMN,GAAa,GADhE,CAbmBA,GAChB,MAAOO,GACLC,QAAQC,OAAoB,uBAiDOC,EAjDiB,YAiDEC,EAjDW,kBAkDlE,KAAI,IAAIC,MAAOC,qBAAqBH,MAAqBC,4BAlD6BJ,GAEzF,OAAOL,EA+CR,IAAwCQ,EAAmBC,EA7C9D,OAAO,KAVJ,CA1B4BX,EAAUc,QAezC,OAbKrE,EAAGwD,KACCD,EAAUe,SAAS,MAASf,EAAUe,SAAS,MAGhDd,EAAM,GACND,EAAUgB,MAAM,KAAKC,QAAQvE,IACzB,IAAIwE,EAAKxE,EAAIsE,MAAM,KACD,IAAdE,EAAGtE,SACHqD,EAAIiB,EAAG,GAAGJ,QAAUI,EAAG,GAAGJ,WANlCb,EAAMD,GAWPC,EA+E0BkB,CAAqBlC,EAAQmC,aAAapB,IAAc,KAgBtF,SAASqB,EAAmB3F,EAAYwC,GAC3C,OAAOzB,EAAGf,GAASA,EAAM4F,cAAgBpD,EAgBtC,SAASqD,EAAS7F,GACrB,MAAwB,iBAAVA,EASX,SAAS8F,EAAc9F,EAAesB,GACzC,OAAQP,EAAGf,GAAiBA,EAAM+F,QAAQ,WAAYzE,UAAU,IAA5CtB,EASjB,SAASgG,EAAazC,GAEzB,MAAO,GADOxC,EAAGwC,GAAWA,EAAU,iBACjB,IAAmB0C,OAAOjG,SAM5C,SAASkG,IACZ,IAAIC,EAAOC,EAAa,EAAG,KACvBC,EAAQD,EAAa,EAAG,KAC5B,MAAO,GAAGE,KAAKC,MAAMD,KAAKE,SAAWH,MAAUC,KAAKC,MAAMJ,KAQvD,SAASC,EAAa/D,EAAaC,GAGtC,OAFAD,EAAMiE,KAAKG,KAAKpE,GAChBC,EAAMgE,KAAKC,MAAMjE,GACVgE,KAAKC,MAAMD,KAAKE,UAAYlE,EAAMD,EAAM,IAAMA,EAUlD,SAASqE,EAAmBC,EAAWC,EAA6B/D,EAAsBgE,GAC7F,IAAItD,EAAUoD,EACdpD,EAAQuD,UAAY,GACpB,IAAIC,EArSD,SAA+BxD,EAAcV,GAChD,OAAKU,GAAYxC,EAAGwC,EAAQyD,cAGrBnE,EAAWoE,OAAOC,GACd3D,EAAQyD,aAAaE,IAHrB,KAFR,CAqS4CP,EAAM9D,GACjD9B,EAAGgG,KACHA,EAASxB,QAAQ4B,IACb,IAAInC,EAAY4B,EAAWQ,KAAKhI,GAAcA,EAAEkF,YAAc6C,GAC9D,GAAIpG,EAAGiE,GACH,IACI6B,EAAMQ,cAAcC,OAAOtC,EAAUuC,YACrC,IAAIC,EAAUxC,EAAUpF,IAAI+G,EAAME,GAClCtD,EAAQuD,UAAU9B,EAAUV,WAAakD,EACzCjE,EAAQuD,UAAU9B,EAAUV,WAAWmD,OAAOpD,EAAesC,EAAM3B,EAAUV,YAC/E,MAAOO,GACL,MAAM,IAAI,IAAqBA,EAAE6C,YAI7CnE,EAAQoE,MAAQ3B,EAAaW,EAAKiB,UAInC,SAAUC,IACb,IAAIC,EAAM,EACV,eACsBA,MACLA,EAAM,OACfA,EAAM,K,6BC/YlB/I,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,sCAAAA,EAAA,GAEO,MAAMgJ,EAAU,CACnBC,KAAM,OACNC,aAAc,qBACdC,MAAO,QACPC,OAAQ,UAGCC,EAAa,CACtBC,MAAO,sLACPC,UAAW,oKACXC,aAAc,oQACdC,aAAc,4ZACdC,gBAAiB,oUAKRC,EAA0C,CACnDC,MAAO,mCACPX,KAAM,mCAGGY,EAAgD,CACzDD,MAAO,+BACPX,KAAM,gCAGGa,EAA4C,CACrDF,MAAO,2BACPX,KAAM,2BAGGc,EAAa,CACtBH,MAAO,CACHI,KAAM,yBACNC,MAAO,0BACPb,OAAQ,4BAEZH,KAAM,CACFe,KAAM,wBACNC,MAAO,yBACPb,OAAQ,2BAEZc,OAAQ,CACJF,KAAM,sBACNC,MAAO,4BACPb,OAAQ,8BAEZe,UAAW,CACPH,KAAM,wBACNC,MAAO,8BACPb,OAAQ,gCAEZgB,QAAS,CACLJ,KAAM,sBACNC,MAAO,4BACPb,OAAQ,8BAEZiB,QAAS,CACLL,KAAM,sBACNC,MAAO,4BACPb,OAAQ,8BAEZpD,MAAO,CACHgE,KAAM,oBACNC,MAAO,0BACPb,OAAQ,6BAIHkB,EAAqB,CAC9BC,SAAU,uBACVC,WAAY,yBACZC,cAAe,4BACfC,kBAAmB,iCACnBC,mBAAoB,kCACpBC,wBAAyB,wCACzBC,qBAAsB,oCACtBC,iBAAkB,gCAClBC,eAAgB,8BAChBC,iBAAkB,gCAClBC,gBAAiB,+BACjBC,uBAAwB,uCACxBC,oBAAqB,mCACrBC,gBAAiB,+BACjBC,cAAe,6BACfC,gBAAiB,+BACjBC,eAAgB,8BAChBC,YAAa,2BACbC,kBAAmB,kCACnBC,iBAAkB,iCAClBC,iBAAkB,iCAClBC,qBAAsB,sCACtBC,eAAgB,6BAChBC,qBAAsB,oCACtBC,oBAAqB,mCACrBC,oBAAqB,mCACrBC,wBAAyB,wCACzBC,aAAc,2BACdC,mBAAoB,kCACpBC,kBAAmB,iCACnBC,kBAAmB,iCACnBC,sBAAuB,sCACvBC,aAAc,2BACdC,mBAAoB,kCACpBC,kBAAmB,iCACnBC,kBAAmB,iCACnBC,sBAAuB,sCACvBC,WAAY,yBACZC,iBAAkB,gCAClBC,gBAAiB,+BACjBC,gBAAiB,+BACjBC,oBAAqB,oCACrBC,gBAAiB,oCACjBC,WAAY,yBACZC,iBAAkB,gCAClBC,gBAAiB,+BACjBC,kBAAmB,uCACnBC,QAAS,qBACTC,aAAc,2BACdC,QAAS,qBACTC,OAAQ,oBACRC,eAAgB,6BAChBC,eAAgB,8BAIb,MAAMC,GACF3N,EAAA4N,SAAwB,OACxB,EAAAtL,OAAiB,MAGrB,MAAMuL,EAAS,CAClBC,qBAAsB,uBACtBC,kBAAmB,oBACnBC,UAAW,SACXC,QAAS,OACTC,SAAU,QACVC,UAAW,SACXC,UAAW,SACXC,iBAAkB,eAClBC,gBAAiB,eACjBC,WAAY,UACZC,YAAa,YAKJC,EAAqB,e,+DCrJ3B,MAAMC,EAIT,YAAYpO,EAAcqO,GACtBC,KAAKD,MAAQA,EACbC,KAAK5I,UAAY1F,EACjBsO,KAAKC,GAAK,IAGd,SAASF,GACLC,KAAKD,MAAQA,EAGjB,MAAME,GACFD,KAAKC,GAAKA,EAEd,MAAMnG,EAAiBzC,GACA,UAAf2I,KAAKD,OACL7I,QAAQgJ,IAAIF,KAAKG,WAAWrG,EAASzC,IAG7C,MAAMyC,EAAiBzC,GACA,UAAf2I,KAAKD,OAAoC,UAAfC,KAAKD,OAAoC,YAAfC,KAAKD,OACzD7I,QAAQC,MAAM6I,KAAKG,WAAWrG,EAASzC,IAG/C,QAAQyC,EAAiBzC,GACF,YAAf2I,KAAKD,OAAsC,UAAfC,KAAKD,OACjC7I,QAAQkJ,KAAKJ,KAAKG,WAAWrG,EAASzC,IAG9C,UAAUJ,EAAUI,GAChBH,QAAQC,MAAM6I,KAAKG,WAAW,yBAAyBlJ,EAAEvF,SAASuF,EAAE6C,UAAWzC,IAC5D,UAAf2I,KAAKD,OACL7I,QAAQmJ,UAAUpJ,EAAEqJ,OAG5B,YAAYC,EAAsBlJ,GAC9B,GAAmB,UAAf2I,KAAKD,MACL,OAEJ,IAAIS,EAAQlJ,KAAKmJ,MACjBF,IACArJ,QAAQgJ,IAAIF,KAAKG,WAAW,wBAAwB7I,KAAKmJ,MAAQD,MAAWnJ,IAGxE,WAAWyC,EAAiBzC,GAChC,MAAO,KAAI,IAAIC,MAAOC,qBAAqByI,KAAK5I,cAAcC,UAAgB,QAAQ2I,KAAKC,OAAOnG,M,WC3CnG,MAAM,EAKF,WAAWpI,EAAcsN,GAC5B,OAAO,IAAIc,EAAUpO,EAAMsN,UAAY,IAAQA,a,6BCdvD,IAAA/H,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,gCAAAA,EAAA,4BAAO,MAAMyJ,UAAkBC,MAC3B,YAAYjP,EAAcoI,GACtB8G,MAAM9G,GACNjI,OAAOgP,eAAeb,gBAAiBjN,WACvCiN,KAAKtO,KAAOA,GAIb,MAAMoP,UAA0BJ,EACnC,YAAY5G,GACR8G,MAAM,oBAAqB9G,IAI5B,MAAMiH,UAAsBL,EAC/B,YAAY5G,GACR8G,MAAM,gBAAiB9G,IAUxB,MAAMkH,UAA6BN,EACtC,YAAY5G,GACR8G,MAAM,uBAAwB9G,IAI/B,MAAMmH,UAAoCP,EAC7C,YAAY5G,GACR8G,MAAM,8BAA+B9G,IAKtC,MAAMoH,UAA6BR,EACtC,YAAY5G,GACR8G,MAAM,uBAAwB9G,M,6BC1BtC,IAAA7C,EAAA,gCAAAA,EAAA,4BAAO,MAAMkK,EAYT,cACInB,KAAKoB,iBACLpB,KAAKqB,gBAAkB,GACvBrB,KAAKsB,gBAAkB,GACvBtB,KAAKuB,QAAU,GAGnB,SAASC,GAWL,OAVAxB,KAAKtM,OAAS8N,EAAK9N,OACnBsM,KAAKhB,SAAWwC,EAAKxC,SACrBgB,KAAKyB,UAAYD,EAAKC,UACtBzB,KAAKoB,cAAgBI,EAAKJ,cAC1BpB,KAAKpE,cAAgB4F,EAAK5F,cAC1BoE,KAAKlE,mBAAqB0F,EAAK1F,mBAC/BkE,KAAKnE,kBAAoB2F,EAAK3F,kBAC9BmE,KAAKqB,gBAAkBG,EAAKH,gBAC5BrB,KAAKsB,gBAAkBE,EAAKF,gBAErBtB,MAKR,MAAM0B,EAcT,cACI1B,KAAKtM,OAAS,MACdsM,KAAK2B,IAAM,OACX3B,KAAKhB,SAAW,UAChBgB,KAAK4B,YAAc,QACnB5B,KAAKpE,cAAgB,IACrBoE,KAAKlE,mBAAqB,IAC1BkE,KAAKnE,kBAAoB,IACzBmE,KAAKyB,UAAY,IACjBzB,KAAKoB,iBACLpB,KAAKqB,gBAAkB,GACvBrB,KAAKsB,gBAAkB,GACvBtB,KAAKvP,KAAO0D,SAAS0N,Q,yPCxEtB,MAAM,EAET,YAAYC,GADZ,mB,8GAEI,CAAA9B,KAAI,EAAiB8B,GAGnB,cAAc3L,EAAiB4L,EAA6BnO,G,2UAC9D,OAAO,IAAIC,QAASC,IAChB,EAAAkM,KAAA,GAAmBgC,OAAO,KACtBD,EAAOE,IAAI9L,GACXA,EAAO+L,UAAUD,IAAI,IAAQ5H,cAC7BtG,WAAW,KACP,EAAAiM,KAAA,GAAmBgC,OAAO,KACtBD,EAAOI,OAAOhM,GACdA,EAAO+L,UAAUC,OAAO,IAAQ9H,cAChCvG,OACD,OACJF,IACJ,Y,oQCbR,MAAM,EAGT,YAAYwO,GAFZ,mBAGI,EAAApC,KAAI,EAAUoC,GAGlB,IAAIzM,EAAkBsD,GACd,SAAAK,EAAA,CAAI3D,EAAS,EAAAqK,KAAA,MAAiBrK,EAAQuM,UAAUG,SAAS,EAAArC,KAAA,KACzDrK,EAAQuM,UAAUD,IAAI,EAAAjC,KAAA,IAI9B,OAAOrK,EAAkBsD,GACjB,SAAAK,EAAA,CAAI3D,EAAS,EAAAqK,KAAA,KAAgBrK,EAAQuM,UAAUG,SAAS,EAAArC,KAAA,KACxDrK,EAAQuM,UAAUC,OAAO,EAAAnC,KAAA,IAIjC,OAAOrK,EAAkBsD,GACjB,SAAAK,EAAA,CAAI3D,EAAS,EAAAqK,KAAA,MACRrK,EAAQuM,UAAUG,SAAS,EAAArC,KAAA,IAG5BrK,EAAQuM,UAAUD,IAAI,EAAAjC,KAAA,IAFtBrK,EAAQuM,UAAUC,OAAO,EAAAnC,KAAA,M,cAQlC,MAAMsC,EAGT,YAAY5Q,GAFZ,mBAGI,EAAAsO,KAAI,EAAStO,GAEjB,IAAIiE,EAAkBsD,GAClB,OAAQ,EAAA+G,KAAA,IACJ,IAAK,YACD/G,EAAMsJ,aAAa,QACnB,MACJ,IAAK,aACDtJ,EAAMsJ,aAAa,UAK/B,OAAO5M,EAAkBsD,GACrB,OAAQ,EAAA+G,KAAA,IACJ,IAAK,YACD/G,EAAMsJ,aAAa,SACnB,MACJ,IAAK,aACDtJ,EAAMsJ,aAAa,SAK/B,OAAO5M,EAAkBsD,GACrB,OAAQ,EAAA+G,KAAA,IACJ,IAAK,YAGL,IAAK,aACDA,KAAKwC,YAAYvJ,IAKrB,YAAYA,GACa,SAAzBA,EAAMwJ,eACNxJ,EAAMsJ,aAAa,SAEnBtJ,EAAMsJ,aAAa,S,cAKxB,MAAMG,EACT,eAGA,IAAI/M,EAAkBsD,IAItB,OAAOtD,EAAkBsD,IAGzB,OAAOtD,EAAkBsD,KAItB,MAAM,EACF,WAAW7G,GACd,IAAK,YAAGA,GACJ,OAAO,IAAIsQ,EAGf,OADgBtQ,EAAM,IAElB,IAAK,IACD,OAAO,IAAI,EAAeA,EAAMuQ,UAAU,IAC9C,IAAK,IACD,OAAO,IAAIL,EAAiBlQ,EAAMuQ,UAAU,IAChD,QACI,OAAO,IAAI,EAAevQ,K,oiBC1GnC,MAAM,EAOT,YAAYwQ,EAAqB3J,GANjC,mBACA,mBACA,mBACA,mBACA,mBACA,mBAEI,EAAA+G,KAAI,EAAa4C,GACjB,EAAA5C,KAAI,MACJ,EAAAA,KAAI,EAAW,IAAiBhO,IAAI,mBACpC,EAAAgO,KAAI,EAAU/G,GACd,EAAA+G,KAAI,EAAQ1I,KAAKmJ,OACjB,EAAAT,KAAI,EAAkB,IAAI,EAAiB/G,EAAM6I,eAG/C,YAAYM,G,yCACd,QAAK,YAAGA,IAGDpC,KAAK1O,KAAMqE,IACTA,EAAQuM,UAAUG,SAASD,GAG5BzM,EAAQuM,UAAUC,OAAOC,GAFzBzM,EAAQuM,UAAUD,IAAIG,IAI3B,kBAGD,cAAcA,G,yCAChB,QAAK,YAAGA,IAGDpC,KAAK1O,KAAMqE,IACd,IAAIkN,EAAUlN,EAAQuM,UACtB,EAAAlC,KAAA,GAAY8B,aAAagB,MAAM,KACtBD,EAAQR,SAASD,GAGlB,EAAApC,KAAA,GAAY8B,aAAaE,OAAOa,EAAQV,OAAQU,EAAST,GAFzD,EAAApC,KAAA,GAAY8B,aAAaE,OAAOa,EAAQZ,IAAKY,EAAST,IAI3DpC,OAEJ,oBAGD,SAASoC,G,yCACX,QAAK,YAAGA,IAGDpC,KAAK1O,KAAMqE,IACTA,EAAQuM,UAAUG,SAASD,IAC5BzM,EAAQuM,UAAUD,IAAIG,IAE3B,eAGD,WAAWA,G,yCACb,QAAK,YAAGA,IAIDpC,KAAK1O,KAAMqE,IACd,IAAIkN,EAAUlN,EAAQuM,UACtB,EAAAlC,KAAA,GAAY8B,aAAagB,MAAM,KACtBD,EAAQR,SAASD,IAClB,EAAApC,KAAA,GAAY8B,aAAaE,OAAOa,EAAQZ,IAAKY,EAAST,IAE3DpC,OAEJ,iBAGD,YAAYoC,G,yCACd,QAAK,YAAGA,IAGDpC,KAAK1O,KAAMqE,IACVA,EAAQuM,UAAUG,SAASD,IAC3BzM,EAAQuM,UAAUC,OAAOC,IAE9B,kBAGD,cAAcA,G,yCAChB,QAAK,YAAGA,IAGDpC,KAAK1O,KAAMqE,IACd,IAAIkN,EAAUlN,EAAQuM,UACtB,EAAAlC,KAAA,GAAY8B,aAAagB,MAAM,KACvBD,EAAQR,SAASD,IACjB,EAAApC,KAAA,GAAY8B,aAAaE,OAAOa,EAAQV,OAAQU,EAAST,IAE9DpC,OACJ,kBAGP,aAAa+C,GACT,OAAK,YAAGA,GAGD,EAAA/C,KAAA,GAAegD,OAAiB,CAAC5P,EAAe6P,KAC/CA,EAAQ7J,aAAa2J,GACrB3P,EAAI8P,KAAKD,EAAQnL,aAAaiL,IAE9B3P,EAAI8P,KAAK,MAEN9P,GACR,IATQ,KAYT,aAAa2P,EAAuBI,G,yCACtC,QAAK,YAAGJ,IAGD/C,KAAK1O,KAAMqE,IACdA,EAAQyN,aAAaL,EAAeI,UAAkB,KACvD,mBAGD,eAAeJ,EAAuBI,G,yCACxC,QAAK,YAAGJ,IAGD/C,KAAK1O,KAAMqE,IACd,EAAAqK,KAAA,GAAY8B,aAAaE,OAAOrM,EAAQyN,aAAczN,EAASoN,EAAeI,UAAkB,KACjG,qBAGD,gBAAgBJ,G,yCAClB,QAAK,YAAGA,IAGD/C,KAAK1O,KAAMqE,IACdA,EAAQ0N,gBAAgBN,IACzB,sBAGD,kBAAkBA,G,yCACpB,QAAK,YAAGA,IAGD/C,KAAK1O,KAAMqE,IACd,EAAAqK,KAAA,GAAY8B,aAAaE,OAAOrM,EAAQ0N,gBAAiB1N,EAASoN,IACnE,wBAGD,gBAAgBA,EAAuBI,G,yCACzC,QAAK,YAAGJ,IAGD/C,KAAK1O,KAAMqE,IACVA,EAAQyD,aAAa2J,GACrBpN,EAAQ0N,gBAAgBN,GAExBpN,EAAQyN,aAAaL,EAAeI,UAAkB,KAE3D,sBAGD,kBAAkBJ,EAAuBI,G,yCAC3C,QAAK,YAAGJ,IAGD/C,KAAK1O,KAAMqE,IACd,EAAAqK,KAAA,GAAY8B,aAAagB,MAAM,KACvBnN,EAAQyD,aAAa2J,GACrB,EAAA/C,KAAA,GAAY8B,aAAaE,OAAOrM,EAAQ0N,gBAAiB1N,EAASoN,GAElE,EAAA/C,KAAA,GAAY8B,aAAaE,OAAOrM,EAAQyN,aAAczN,EAASoN,EAAeI,UAAkB,KAErGnD,OAEJ,wBAGD,MAAMsD,G,yCACR,QAAK,YAAGA,IAGDtD,KAAK1O,KAAMqE,IACdA,EAAQ4N,iBAAiB,QAASD,IACnC,YAGD,MAAME,EAAmBjD,G,yCAC3B,SAAK,YAAGiD,KAAe,YAAGjD,KAGnBP,KAAK1O,KAAMqE,IACdA,EAAQ4N,iBAAiBC,EAAWjD,IACrC,YAGD,KAAKA,EAAqDlJ,G,yCAS5D,OARI,EAAA2I,KAAA,IACA,EAAAA,KAAA,GAAa7I,MAAM,oBAAqBE,GAE5C2I,KAAKyD,OACL,EAAAzD,KAAA,GAAerI,QAAQ,CAAChC,EAAS+N,KAC7BnD,EAAS5K,EAAS+N,KAEtB1D,KAAK2D,eAIH,QAAQvB,EAAmBxO,G,yCAC7B,IAAK,YAAGwO,GACJ,OAAM,EAEV,MAAMwB,EAAQhQ,UAAW,EAAAoM,KAAA,GAAY6D,MAAMjI,cAC3C,OAAOoE,KAAK1O,KAAMqE,IACdqK,KAAK8D,OAAO,KACRnO,EAAQuM,UAAUD,IAAIG,GACtBzM,EAAQuM,UAAUD,IAAI,IAAQ5H,cAC9BtG,WAAW,KACPiM,KAAK8D,OAAO,KACRnO,EAAQuM,UAAUC,OAAOC,GACzBzM,EAAQuM,UAAUC,OAAO,IAAQ9H,iBAEtCuJ,UAKT,KAAKG,EAAmBC,EAAwBpQ,G,yCAClD,IAAK,SAAA0F,EAAA,CAAIyK,EAAWC,GAChB,OAAM,EAEV,MAAMJ,EAAQhQ,UAAW,EAAAoM,KAAA,GAAY6D,MAAMjI,cACrCmG,EAAS,IAAI,EAAeiC,GAClC,OAAOhE,KAAK1O,KAAMqE,IACd,EAAAqK,KAAA,GAAoBiE,cAActO,EAASoM,EAAQ6B,GAAOM,KAAK,KAC3DvO,EAAQuM,UAAUD,IAAI8B,UAK5B,MAAMI,EAAoBH,EAAwBpQ,G,yCACpD,IAAK,SAAA0F,EAAA,CAAI6K,EAAYH,GACjB,OAAM,EAEV,MAAMJ,EAAQhQ,UAAW,EAAAoM,KAAA,GAAY6D,MAAMjI,cACrCmG,EAAS,IAAI,EAAeiC,GAClC,OAAOhE,KAAK1O,KAAMqE,IACd,EAAAqK,KAAA,GAAoBiE,cAActO,EAASoM,EAAQ6B,GAAOM,KAAK,KAC3DvO,EAAQuM,UAAUC,OAAOgC,UAKrC,KAAK5D,KAAkB6D,GACnB,EAAApE,KAAA,GAAY8B,aAAagB,MAAMvC,EAAUP,QAASoE,GAGtD,OAAO7D,KAAkB6D,GACrB,EAAApE,KAAA,GAAY8B,aAAaE,OAAOzB,EAAUP,QAASoE,GAGvD,WACI,OAAO,EAAApE,KAAA,GAGX,QACI,OAAO,EAAAA,KAAA,GAAe1M,OAG1B,OACI,EAAA0M,KAAI,MAGR,SACI,EAAAA,KAAI,MAGR,WACI,OAAO,EAAAA,KAAA,GAGX,UACI,OAAQ1I,KAAKmJ,MAAQ,EAAAT,KAAA,GAAa,M,oVClRnC,MAAM,EAUT,YAAYrK,EAAsBsD,GARlC,mBACA,mBACA,mBAEA,mBACA,mBACA,mBACA,mBAEI,EAAA+G,KAAI,EAAa,MACjB,EAAAA,KAAI,EAAYrK,GAChBqK,KAAKqE,KAAO,IAAiBrS,IAAI,uBACjCgO,KAAKuB,QAAU,KACf,EAAAvB,KAAI,EAAe,IACnB,EAAAA,KAAI,EAAe,IACnB,EAAAA,KAAI,EAAU/G,GACd,EAAA+G,KAAI,EAAgB,IAIxB,WAAWuB,GAEP,OADAvB,KAAKuB,QAAUA,EACRvB,KAGX,cAAchH,GAEV,OADA,EAAAgH,KAAI,EAAehH,GACZgH,KAGX,cAAc/K,GASV,OARA,EAAA+K,KAAI,EAAY,CACZ/K,YAAWA,EACXqP,SAAQA,EACRC,WAAUA,EACVC,gBAAiBvP,IAErB,EAAA+K,KAAI,EAAe/K,GACnB,EAAA+K,KAAI,EAAgB,YAAuB/K,IACpC+K,KAGX,QAKI,OAJAA,KAAKqE,KAAKI,MAAM,YAChB,EAAAzE,KAAI,EAAa,IAAI0E,iBAAiB1E,KAAK2E,iBAAiBhS,KAAKqN,QACjE,EAAAA,KAAA,GAAe4E,QAAQ,EAAA5E,KAAA,KAAAA,KAAA,IACvBA,KAAKqE,KAAKI,MAAM,WACTzE,KAGX,OAOI,OANAA,KAAKqE,KAAKI,MAAM,YACO,OAAnB,EAAAzE,KAAA,IACAA,KAAKqE,KAAKI,MAAM,sBACpB,EAAAzE,KAAA,GAAe6E,aACf,EAAA7E,KAAI,EAAa,MACjBA,KAAKqE,KAAKI,MAAM,WACTzE,KAGH,iBAAiB8E,EAA6BC,GAClDD,EAAUnN,QAASqN,IACf,OAAQA,EAASC,MACb,IAAK,aACD,MAAMC,EAAOF,EAAS7O,OAClB,SAAAmD,EAAA,CAAI4L,EAAKhM,UAAWgM,EAAKhM,UAAU8L,EAASjC,iBAC5CmC,EAAKhM,UAAU8L,EAASjC,eAAeoC,QAAQ,YAAeD,EAAMF,EAASjC,gBAEjF,MAEJ,IAAK,YACD/C,KAAKoF,wBAAwBJ,GAGjC,YAAGhF,KAAKuB,UACRvB,KAAKuB,QAAQ8D,WAAWL,GAAUd,KAAK,UAO3C,wBAAwBc,GAC5B,MAAMM,EAAWN,EAASO,WAAWjS,OAC/BkS,EAAaR,EAASS,aAAanS,OACrCgS,EAAW,GACXtF,KAAKqE,KAAKI,MAAM,4BAA8Ba,GAC9CtF,KAAK0F,iBAAiBV,EAASO,aACxBC,EAAa,IACpBxF,KAAKqE,KAAKI,MAAM,mBAAqBe,GACrCxF,KAAK2F,mBAAmBX,EAASS,eAIjC,iBAAiBG,GACrBA,EAAMjO,QAASoB,IACX,IACI,OAAA9G,EAAA,GAAmB8G,EAAM,EAAAiH,KAAA,KAAAA,KAAA,KAAAA,KAAA,IACzB,IAAI6F,EAAY9M,EAAK+M,gBAAkB/M,EAAKgN,iBAAiB,EAAA/F,KAAA,IAAqB,KAC9E,YAAG6F,IACHA,EAAUlO,QAASqO,IACf,OAAA/T,EAAA,GAAmB+T,EAAO,EAAAhG,KAAA,KAAAA,KAAA,KAAAA,KAAA,MAGpC,MAAO/I,GACL+I,KAAKqE,KAAKhE,UAAUpJ,MAKxB,mBAAmB2O,GACvBA,EAAMjO,QAASoB,IACXiH,KAAKiG,qBAAqBlN,GAC1B,IAAI8M,EAAY9M,EAAK+M,gBAAkB/M,EAAKgN,iBAAiB,EAAA/F,KAAA,IAAqB,KAC9E,YAAG6F,IACHA,EAAUlO,QAASqO,IACfhG,KAAKiG,qBAAqBD,OAMlC,qBAAqBjN,GACzB,IAAIpD,EAAUoD,EACd,GAAIpD,EAAQuD,UACR,IAAK,IAAIxH,KAAQiE,EAAQuD,UACrB,GAAIvD,EAAQuD,UAAUlG,eAAetB,GACjC,IACIiE,EAAQuD,UAAUxH,GAAMwU,UAC1B,MAAOjP,GACL+I,KAAKqE,KAAKhE,UAAUpJ,EAAG,YAAcvF,K,oWC/ItD,MAAM,EAST,YAAYkQ,EAAqClO,EAAgBkI,GARjE,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBAEI,EAAAoE,KAAI,EAAiB4B,GACrB,EAAA5B,KAAI,EAAa,IAAItM,WACrB,EAAAsM,KAAI,EAAiBtM,EAAH,UAClB,EAAAsM,KAAI,EAAiBtM,EAAH,WAClB,EAAAsM,KAAI,EAAkBpE,GACtB,EAAAoE,KAAI,MACJ,EAAAA,KAAI,EAAiBtM,EAAH,uBAClB,EAAAsM,KAAI,EAAkBtM,EAAH,wBAGjB,KAAKoG,G,2UACP,GAAI,EAAAkG,KAAA,GACA,OAAM,EAEV,EAAAA,KAAI,MACJ,IAAImG,EAAehS,SAASiS,cAAc,EAAApG,KAAA,IAiC1C,OAhCK,YAAGmG,KACJA,EAAehS,SAASC,cAAc,OACtC+R,EAAajE,UAAUD,IAAI,EAAAjC,KAAA,IAC3B7L,SAAS0N,KAAKwE,YAAYF,IAG9B,EAAAnG,KAAA,GAAmBgC,OAAO,KACtBmE,EAAa9R,UAAYyF,EACzBqM,EAAajE,UAAUD,IAAI,IAAQ5H,cACnC8L,EAAajE,UAAUD,IAAI,EAAAjC,KAAA,KAC5BA,YAEG,YAAM,EAAAA,KAAA,IACZ,EAAAA,KAAA,GAAmBgC,OAAO,KACtBmE,EAAajE,UAAUC,OAAO,IAAQ9H,cACtC8L,EAAajE,UAAUC,OAAO,EAAAnC,KAAA,IAC9BmG,EAAajE,UAAUD,IAAI,EAAAjC,KAAA,KAC5BA,YACG,YAAM,KACZ,EAAAA,KAAA,GAAmBgC,OAAO,KACtBmE,EAAajE,UAAUD,IAAI,IAAQ5H,cACnC8L,EAAajE,UAAUD,IAAI,EAAAjC,KAAA,KAC5BA,MAEHjM,WAAW,KACP,EAAAiM,KAAA,GAAmBgC,OAAO,KACtBmE,EAAajE,UAAUC,OAAO,IAAQ9H,cACtC8L,EAAajE,UAAUC,OAAO,EAAAnC,KAAA,IAC9BmG,EAAajE,UAAUC,OAAO,EAAAnC,KAAA,KAC/BA,MACH,EAAAA,KAAI,OACL,EAAAA,KAAA,W,qpBCxDJ,MAAM,GAMT,YAAY8B,GALZ,mBACA,mBACA,mBACA,mBACA,mBAEI,GAAA9B,KAAI,EAAiB8B,GACrB,GAAA9B,KAAI,EAAQ,IAAiBhO,IAAI,sBAGrC,YAAY4Q,GACR,GAAA5C,KAAI,EAAa4C,GAGrB,UAAUR,GACN,GAAApC,KAAI,EAAgBoC,GAGxB,kBAAkBkE,EAAyBC,EAAsBC,EAAgBC,GAC7EF,EAAYrE,UAAUD,IAAI,IAAQ5H,cAClCiM,EAAepE,UAAUD,IAAIwE,GAC7BF,EAAYrE,UAAUD,IAAIuE,GAG9B,gBAAgBF,EAAyBC,EAAsBC,EAAgBC,GAC3EF,EAAYrE,UAAUC,OAAO,IAAQ9H,cACrCiM,EAAepE,UAAUC,OAAOsE,GAChCF,EAAYrE,UAAUC,OAAOqE,GAC7BF,EAAepE,UAAUC,OAAO,GAAAnC,KAAA,IAChCuG,EAAYrE,UAAUD,IAAI,GAAAjC,KAAA,IAG9B,YAAY0D,EAAeT,EAAiByD,GACxC,OAAOhD,GAAS,GAAKA,IAAUT,GAAWS,EAAQgD,EAGhD,WAAWC,EAAkB1D,G,0CAO/B,OANAjD,KAAKyD,OACL,GAAAzD,KAAA,GAAUyE,MAAM,yBAAyBxB,QAAc0D,KACnD1D,GAAW,GACX,GAAAjD,KAAA,GAAeiD,GAASf,UAAUC,OAAO,GAAAnC,KAAA,IAC7C,GAAAA,KAAA,GAAe2G,GAAUzE,UAAUD,IAAI,GAAAjC,KAAA,IACvCA,KAAK2D,eAIH,wBAAwBgD,EAAkBC,EAAqBC,EAAsBC,EAAkB7D,G,0CACzGjD,KAAKyD,OACL,GAAAzD,KAAA,GAAUyE,MAAM,yBAAyBxB,QAAc0D,KAEvD,MAAML,EAAiB,GAAAtG,KAAA,GAAeiD,GAChCsD,EAAc,GAAAvG,KAAA,GAAe2G,GAMnC,OALA,GAAA3G,KAAA,GAAmBgC,OAAOhC,KAAK+G,kBAAmB/G,KAAMsG,EAAgBC,EAAaK,EAAaC,GAClG9S,WAAW,KACP,GAAAiM,KAAA,GAAmBgC,OAAOhC,KAAKgH,gBAAiBhH,KAAMsG,EAAgBC,EAAaK,EAAaC,GAChG7G,KAAK2D,UACNmD,SAIP,kBACI,IAAK,YAAG,GAAA9G,KAAA,IACJ,OAAQ,EAEZ,IAAIiH,EAAMjH,KAAK0G,QACf,IAAK,IAAIvV,EAAI,EAAGA,EAAI8V,EAAK9V,IACrB,GAAI,GAAA6O,KAAA,GAAe7O,GAAG+Q,UAAUG,SAAS,GAAArC,KAAA,IACrC,OAAO7O,EAGf,OAAQ,EAGZ,WACI,OAAO,GAAA6O,KAAA,GAGX,QACI,OAAI,GAAAA,KAAA,IACA,GAAAA,KAAA,GAAUxE,QAAQ,uCAAwC,aAElD,YAAG,GAAAwE,KAAA,MAGJA,KAAK0G,SAAW,IACvB,GAAA1G,KAAA,GAAUxE,QAAQ,yBAA0B,cAH5C,GAAAwE,KAAA,GAAUxE,QAAQ,yCAA0C,aASpE,QACI,OAAO,GAAAwE,KAAA,GAAiB,GAAAA,KAAA,GAAe1M,QAAU,EAGrD,OACI,GAAA0M,KAAI,MAGR,SACI,GAAAA,KAAI,O,0mBCtGL,MAAM,GAMT,YAAY4C,EAAqBd,GALjC,oBAEA,oBACA,oBAGI,GAAA9B,KAAI,GAAQ,IAAiBhO,IAAI,sBACjC,GAAAgO,KAAI,GAAW,IAAI,GAAwB8B,IAC3C,GAAA9B,KAAA,IAAakH,YAAYtE,GACzB,GAAA5C,KAAI,GAAQ1I,KAAKmJ,OAGrB,UAAU2B,GACN,GAAApC,KAAA,IAAamH,UAAU/E,GAG3B,YAAYQ,GACR,GAAA5C,KAAA,IAAakH,YAAYtE,GAG7B,MAAMrC,GACF,GAAAP,KAAA,IAAa4C,WAAWjL,QAAQ,CAAChC,EAAS+N,KACtC/N,EAAQ4N,iBAAiB,QAAS,KAC9BvD,KAAKoH,IAAI1D,GAAOQ,KAAK,KACb3D,GACAA,EAAS5K,EAAS+N,SAOhC,O,0CACF,IAAK,GAAA1D,KAAA,IAAaqH,QACd,OAAM,EAEV,IAAIC,EAAS,GAAAtH,KAAA,IAAauH,kBAAoB,EAC9C,OAAOvH,KAAKoH,IAAIE,GAAUtH,KAAK1M,SAAW,EAAIgU,MAG5C,W,0CACF,IAAK,GAAAtH,KAAA,IAAaqH,QACd,OAAM,EAEV,IAAIC,EAAS,GAAAtH,KAAA,IAAauH,kBAAoB,EAC9C,OAAOvH,KAAKoH,IAAIE,EAAS,EAAItH,KAAK1M,SAAW,EAAIgU,MAG/C,IAAI5D,G,0CACN,IAAIT,EAAU,GAAAjD,KAAA,IAAauH,kBAC3B,SAAK,GAAAvH,KAAA,IAAaqH,UAAY,GAAArH,KAAA,IAAawH,YAAY9D,EAAOT,EAASjD,KAAK1M,YAGrE,GAAA0M,KAAA,IAAayH,WAAW/D,EAAOT,MAGpC,iBAAiBS,EAAekD,EAAqBC,EAAsBC,G,0CAC7E,IAAI7D,EAAU,GAAAjD,KAAA,IAAauH,kBAC3B,SAAK,GAAAvH,KAAA,IAAaqH,UAAY,GAAArH,KAAA,IAAawH,YAAY9D,EAAOT,EAASjD,KAAK1M,YAGrE,GAAA0M,KAAA,IAAa0H,wBAAwBhE,EAAOkD,EAAaC,EAAcC,EAAU7D,MAG5F,kBACI,OAAO,GAAAjD,KAAA,IAAauH,kBAGxB,SACI,OAAO,GAAAvH,KAAA,IAAa0G,QAGxB,UACI,OAAO1G,KAAK1M,SAAW,GAAKgE,KAAKmJ,MAAQ,GAAAT,KAAA,IAAY,M,0TCzEtD,MAAM,GAIT,YAAYuB,GAHZ,oBACA,oBACA,oBAEI,GAAAvB,KAAI,GAAYuB,UAAW,IAC3B,GAAAvB,KAAI,GAAQ,IAAiBhO,IAAI,qBAGrC,KAAKiH,GACD,GAAA+G,KAAA,IAAUyE,MAAM,mCAAqC,GAAAzE,KAAA,IAAc1M,QACnE,GAAA0M,KAAI,GAAY,GAAAA,KAAA,IAAc3G,OAAQsO,GAC3B,YAAGA,EAAO3C,YAErB,GAAAhF,KAAA,IAAcrI,QAAQgQ,IAClBA,EAAOnG,KAAKvI,GACZA,EAAM4K,MAAMtC,QAAQoG,EAAOC,aAAeD,EAAO9D,QAErD,GAAA7D,KAAA,IAAUyE,MAAM,iCAGpB,IAAI/S,GACA,GAAK,YAAGA,GAGR,OAAO,GAAAsO,KAAA,IAAcxG,KAAKvG,GAAKA,EAAEvB,OAASA,GAGxC,WAAWsT,G,2UACb,IAAI6C,EAA4B,GAKhC,OAJA,GAAA7H,KAAA,IAAcrI,QAASgQ,IACnBE,EAAM3E,KAAKyE,EAAO3C,SAASA,cAEDnR,QAAQiU,IAAID,IAC5BrO,KAAKpG,W,mTCzBpB,MAAM,GAQT,YAAYyQ,EAAqBtC,EAAuBvI,GAPxD,oBACA,oBACA,oBACA,oBAEA,oBACA,oBAEI,IAAQtF,OAASmQ,EAAMnQ,OACvB,IAAQsL,SAAW6E,EAAM7E,SACzBgB,KAAKuB,QAAU,IAAI,GAAiBA,GACpC,GAAAvB,KAAI,GAAehH,UAAc,IACjC,GAAAgH,KAAI,GAAU,IAAI,KAAS6D,IAC3B,GAAA7D,KAAI,GAAQ,IAAiBhO,IAAI,gBACjC,GAAAgO,KAAI,GAAgB6D,EAAMpT,MAG9B,OAGI,GAFA,GAAAuP,KAAA,IAAUyE,MAAM,mBAAoB,SAE/B,YAAG1T,OAAO2T,kBACX,MAAM,IAAI,KAAqB,qCAEnC,GAAA1E,KAAI,GAAiB,IAAI,EAAgB,GAAAA,KAAA,IAAY8B,aAAc,GAAA9B,KAAA,IAAY6D,MAAMnQ,OAAQ,GAAAsM,KAAA,IAAY6D,MAAMhI,oBAC/G,MAAMkM,EAA8B,GAAA/H,KAAA,IAAiBgI,IAAIC,GAAcA,EAAEvR,WACnEwR,EAAe,YAAGH,GAAqB,GAAA/H,KAAA,IAAkB+F,iBAAiB,YAAuBgC,IAAsB,KAC7H,GAAI,YAAGG,GAAe,CAClB,GAAAlI,KAAA,IAAUyE,MAAM,cAAcyD,EAAa5U,mBAC3C,IACI4U,EAAavQ,QAASuN,IAClB,OAAAjT,EAAA,GAAmBiT,EAAM,GAAAlF,KAAA,IAAkB+H,EAAmB,GAAA/H,KAAA,OAEpE,MAAO/I,GACL,GAAA+I,KAAA,IAAUK,UAAUpJ,IAwB5B,OArBA,GAAA+I,KAAA,IAAUyE,MAAM,eAAgB,QAEhCzE,KAAKuB,QAAQC,KAAK,GAAAxB,KAAA,KAEd,SAAA1G,EAAA,CAAI,GAAA0G,KAAA,IAAkB+H,KACtB,GAAA/H,KAAA,IAAUyE,MAAM,yBAA0B,QAC1C,GAAAzE,KAAI,GAAqB,IAAI,EAAoB,GAAAA,KAAA,OAAAA,KAAA,MACjD,GAAAA,KAAA,IAAuBmI,cAAc,GAAAnI,KAAA,KAAkBoI,cAAcL,GACrE,GAAA/H,KAAA,IAAuBqI,WAAWrI,KAAKuB,SACvC,GAAAvB,KAAA,IAAuBQ,SAG3B,GAAAR,KAAA,IAAUyE,MAAM,sBAAuB,QACvC,GAAAzE,KAAA,IAAY8B,aAAaE,OAAO,KAC5B,GAAAhC,KAAA,IAAYsI,YAAY,IAAczM,kBAAsB,GAAAmE,KAAA,IAAY6D,MAAMhI,kBAArB,MACzD,GAAAmE,KAAA,IAAYsI,YAAY,IAAc1M,cAAkB,GAAAoE,KAAA,IAAY6D,MAAMjI,cAArB,MACrD,GAAAoE,KAAA,IAAYsI,YAAY,IAAcxM,mBAAuB,GAAAkE,KAAA,IAAY6D,MAAM/H,mBAArB,OAC3D,MAGH,GAAAkE,KAAA,IAAYuI,IAAIC,KAAK,IAAOtJ,qBAAsB,MAC3Cc,KAGX,SACI,GAAAA,KAAA,IAAuByI,OACvB,GAAAzI,KAAA,IAAYuI,IAAIC,KAAK,IAAOrJ,kBAAmB,MAGnD,IAAIuJ,GACA,MAAMC,EAAW,GAAA3I,KAAA,IAAY4I,MAAM5W,IAAI0W,GACvC,GAAI,YAAGC,GACH,OAAOA,EAEX,MAAM/F,EAAW5C,KAAK8H,IAAIY,GAC1B,IAAK9F,EACD,OAEJ,MAAMiG,EAAa,IAAI,EAAejG,EAAU,GAAA5C,KAAA,KAEhD,OADA,GAAAA,KAAA,IAAY4I,MAAME,IAAIJ,EAAUG,GACzBA,EAGX,WAAWH,GACP,MAAMC,EAAW,GAAA3I,KAAA,IAAY4I,MAAM5W,IAAI0W,GACvC,GAAI,YAAGC,GACH,OAAOA,EAEX,MAAM/F,EAAW5C,KAAK8H,IAAIY,GAC1B,IAAK,YAAG9F,GACJ,OAEJ,IAAImG,EAAU,IAAI,GAAkBnG,EAAU,GAAA5C,KAAA,IAAY8B,cAE1D,OADA,GAAA9B,KAAA,IAAY4I,MAAME,IAAIJ,EAAUK,GACzBA,EAIL,MAAMjP,G,2UACR,QAAK,YAAGA,IAGD,GAAAkG,KAAA,IAAmBgJ,KAAKlP,MAGnC,OAAO4O,GACH,OAAOvU,SAASiS,cAAcsC,GAGlC,IAAIA,GACA,MAAM9C,EAA6BzR,SAAS4R,iBAAiB2C,GAC7D,GAAK,YAAG9C,GAGR,MAAO,IAAIA,GAGf,WACI,OAAO,GAAA5F,KAAA,IAGX,GAAGiJ,EAAe1I,EAAe2I,EAAqBvT,GAC7C,SAAA2D,EAAA,CAAI2P,EAAO1I,IACZ,GAAAP,KAAA,IAAU7I,MAAM,sBAAuB,MAE3C,GAAA6I,KAAA,IAAYuI,IAAIY,GAAGF,EAAO1I,EAAU2I,EAASvT,I,0VCtI9C,MAAMyT,GAMT,YAAYC,GAJZ,oBACA,oBACA,oBACA,oBAEI,GAAArJ,KAAI,GAAeqJ,GACnB,GAAArJ,KAAI,OAER,YAAYO,GACR,GAAAP,KAAI,GAAaO,GAGrB,eACI,OAAO,GAAAP,KAAA,IAEX,SACSjP,OAAOqE,aAAc,GAAA4K,KAAA,KAAwB,GAAAA,KAAA,MAGlDjP,OAAOqE,WAAW,GAAA4K,KAAA,KACbuD,iBAAiB,SAAUvD,KAAKiJ,MAAMtW,KAAKqN,OAChD,GAAAA,KAAI,QAGR,SACQ,GAAAA,KAAA,MACAjP,OAAOqE,WAAW,GAAA4K,KAAA,KAAkBsJ,oBAAoB,SAAUtJ,KAAKiJ,MAAMtW,KAAKqN,OAClF,GAAAA,KAAI,QAKJ,MAAMuJ,GACV,IAAI,GAAAvJ,KAAA,IAAJ,CAGA,GAAAA,KAAI,OACJ,IACI,GAAAA,KAAA,SAAAA,KAAeuJ,GACjB,MAAOtS,GACLC,QAAQC,MAAMF,G,QAEd,GAAA+I,KAAI,U,sTCrCT,MAAM,GAMT,YAAYwJ,GALZ,KAAA5B,YAAsB,mCACtB,KAAAlW,KAAe,aAEf,oBACA,oBAEIsO,KAAK4H,YAAc,yBACnB5H,KAAK6D,MAAQ2F,EAGjB,KAAKvQ,GACD,GAAA+G,KAAI,GAAU/G,GACV+G,KAAK6D,MAAM4F,WAAsC,SAAzB,eACxB,GAAAzJ,KAAA,IAAYuC,aAAa,QAE7B,GAAAvC,KAAI,GAAa,IAAIoJ,GAAsB,iCAC3C,GAAApJ,KAAA,IAAe0J,YAAY1J,KAAK2J,SAAShX,KAAKqN,OAC9C,GAAAA,KAAA,IAAe4J,SAGnB,UACI,GAAA5J,KAAA,IAAe6J,SAGnB,SAASN,G,MACL,IAAIO,EAAiB,GAAA9J,KAAA,IAAY6D,MAAMtC,QAAQvB,KAAK4H,aACX,QAA5B,EAAGkC,iBAAgBL,qBAAS,OAEjCF,EAAGlU,QACH,GAAA2K,KAAA,IAAYuC,aAAa,QAEzB,GAAAvC,KAAA,IAAYuC,aAAa,W,8BCpClC,MAAM,GAKT,YAAYwH,EAAuBpU,EAAkBsD,GACjD+G,KAAKqE,KAAO,IAAiBrS,IAAI+X,GACjC/J,KAAK/G,MAAQA,EACb+G,KAAKrK,QAAUA,EACfqK,KAAKgK,KAAarU,EAASoE,MAI/B,OAAOwG,KAAkB6D,GACrBpE,KAAK/G,MAAM6I,aAAaE,OAAOzB,EAAUP,QAASoE,GAGtD,MAAM7D,KAAkB6D,GACpBpE,KAAK/G,MAAM6I,aAAagB,MAAMvC,EAAUP,QAASoE,GAGrD,aAAa1S,GACT,MAAO,CAACA,EAAMsO,KAAKgK,MAAM9U,KAAK,KAGlC,UAAU+T,KAAkBgB,GACxBjK,KAAK/G,MAAMsP,IAAIC,KAAKS,EAAOjJ,KAAKgK,QAASC,GAG7C,QAAQhB,EAAe1I,GACnBP,KAAK/G,MAAMsP,IAAIY,GAAGF,EAAO1I,EAAUP,MAGvC,QACI,OAAOA,KAAKgK,M,sQCjCb,MAAM,GAGT,MAAM5W,GACG,YAAGA,KACJ4M,KAAKkK,KAAO,MAEZ,YAAS9W,GACT4M,KAAKkK,KAAO9W,EAGhB4M,KAAKkK,KAAO,YAAmB9W,EAAI8W,KAAM,KAI1C,MAAMC,GAET,YAAYzW,GACRsM,KAAKtJ,WAAehD,UAAU,OAAb,QAGrB,WACI,OAAO,KAGX,IAAIiC,EAAkBsD,GAClB,OAAO,IAAI,GAAetD,EAASsD,EAAO+G,KAAKtJ,YAMhD,MAAM,WAAuB,GAIhC,YAAYf,EAAkBsD,EAAiBvC,GAC3CkK,MAAM,iBAAkBjL,EAASsD,GAJrC,oBACA,oBACA,oBAGI,GAAA+G,KAAI,GAAgB,MACpB,GAAAA,KAAI,GAActJ,GAClB,GAAAsJ,KAAI,GAAS,IAAI,IAIrB,OAAOoE,GACHpE,KAAKqE,KAAKI,MAAM,cAAe,UAC/B,GAAAzE,KAAA,IAAWhJ,MAAMoN,GACS,OAAtB,GAAApE,KAAA,KAIJA,KAAKoK,QAAQ,GAAApK,KAAA,IAAWkK,MACxB,GAAAlK,KAAI,GAAgB,GAAAA,KAAA,IAAWkK,OAJ3BlK,KAAKqE,KAAKI,MAAM,4BAOxB,QAAQL,GACJpE,KAAKqE,KAAKI,MAAM,eAAgB,WAChC,GAAAzE,KAAA,IAAWhJ,MAAMoN,GACb,GAAApE,KAAA,IAAWkK,OAAS,GAAAlK,KAAA,MAGxBA,KAAKoK,QAAQ,GAAApK,KAAA,IAAWkK,MACxB,GAAAlK,KAAI,GAAgB,GAAAA,KAAA,IAAWkK,OAGnC,UACIlK,KAAKqE,KAAKI,MAAM,cAAe,WAC/B,MAAM4F,EAAMrK,KAAKrK,QAAQyQ,cAAc,OACnC,YAAGiE,IACHA,EAAIlI,SAER,GAAAnC,KAAI,GAAgB,MAGhB,QAAQkK,GACZ,MAAMI,EAAUJ,EAAO,IAAMA,GAAQ,KACrC,IAAKI,EACD,OAEJ,MAAMC,EAAU,IAAI,GAAYD,GAASE,QACnCH,EAAMrK,KAAKrK,QAAQyQ,cAAc,OACnC,YAAGiE,IACHA,EAAIlI,SAGJnC,KAAKrK,QAAQ8U,WAAWnX,OAAS,EACjC0M,KAAKgC,OAAOhC,KAAK0K,aAAcH,GAE/BvK,KAAKgC,OAAOhC,KAAKqG,YAAakE,GAI9B,aAAaI,GACjB3K,KAAKrK,QAAQ+U,aAAaC,EAAa3K,KAAKrK,QAAQiV,YAGhD,YAAYD,GAChB3K,KAAKrK,QAAQ0Q,YAAYsE,I,6CAI1B,MAAM,GAKT,YAAYE,GAJZ,oBACA,oBACA,oBAGI,GAAA7K,KAAI,GAAY6K,GAChB,GAAA7K,KAAI,GAAU,GAGlB,SAAS8K,GAEL,OADA,GAAA9K,KAAI,GAAU8K,GACP9K,KAGX,SAAS+K,GAEL,OADA,GAAA/K,KAAI,GAAU+K,GACP/K,KAGX,QACI,IAAIgL,EAAU,YAAwB,GAAAhL,KAAA,KAKtC,OAJI,YAAGgL,IAAY,GAAAhL,KAAA,MAAc,IACViL,IACVvR,OAAOsR,EAAS,GAAAhL,KAAA,KAEtBgL,G,6CAIR,MAAMC,GACT,OAAOtV,EAAkBvD,GACrB,IAAIqD,EAAQE,EAAQyD,aAAa,SAAWvD,SAASF,EAAQmC,aAAa,UAAY,GAClFoT,EAASvV,EAAQyD,aAAa,UAAYvD,SAASF,EAAQmC,aAAa,WAAa,GACzFnC,EAAQyN,aAAa,SAAU3N,EAAQrD,GAAO+Y,YAC9CxV,EAAQyN,aAAa,UAAW8H,EAAS9Y,GAAO+Y,a,yQCvIjD,MAAM,GAGT,cADA,oBAEInL,KAAKtJ,UAAY,kBACjB,IAA+B,wBAAI,kWAGvC,WACI,OAAO,KAGX,IAAIf,EAAkBsD,GAClB,OAAO,IAAI,GAAiBtD,EAASsD,EAAO+G,KAAKtJ,Y,eAIlD,MAAM,WAAyB,GAOlC,YAAYf,EAAkBsD,EAAiBvC,GAC3CkK,MAAM,mBAAoBjL,EAASsD,GAPvC,oBACA,oBACA,oBACA,oBACA,oBACA,oBAGI,GAAA+G,KAAI,MAAWA,KAAI,GAAS,IAC5B,GAAAA,KAAI,GAAS,MACb,GAAAA,KAAI,IAAe,GACnB,GAAAA,KAAI,GAActJ,GAGtB,OAAO0N,GACH,GAAI,YAAG,GAAApE,KAAA,KACH,OAEJ,MAAMuK,EAAU,IAAI,GAAY,IAA+B,yBAAGC,QAC5DH,EAAMrK,KAAKrK,QAAQyQ,cAAc,OACnC,YAAGiE,IACHA,EAAIlI,SAERnC,KAAKrK,QAAQ0Q,YAAYkE,GACzB,GAAAvK,KAAI,GAASA,KAAKrK,QAAQyQ,cAAc,0BACxC,GAAApG,KAAI,GAAS,GAAAA,KAAA,IAAWoL,kBACxB,GAAApL,KAAI,GAAW,GAAAA,KAAA,IAAa,KAC5B,GAAAA,KAAI,OACJA,KAAK8C,MAAM9C,KAAKqL,WAGpB,QAAQjH,GACJpE,KAAK8C,MAAM9C,KAAKqL,WAGpB,UACI,GAAArL,KAAI,OAGA,YAAY5N,GAChB,GAAA4N,KAAA,IAAW8K,MAAMQ,iBAAmBlZ,EAGhC,YACJ,MAAMA,EAAQ4N,KAAKrK,QAAQyD,aAAa,GAAA4G,KAAA,KAAmBnK,SAASmK,KAAKrK,QAAQmC,aAAa,GAAAkI,KAAA,MAAoB,EAClH,GAAI5N,IAAU,GAAA4N,KAAA,IACV,OAEJ,GAAAA,KAAI,GAAc5N,GAClB,MAAMmZ,EAAW,YAAcnZ,EAAO,EAAG,KAEzC4N,KAAKgC,OAAOhC,KAAKwL,YAAa,GAAAxL,KAAA,IAAa,GAAAA,KAAA,IAAeuL,I,oVCrE3D,MAAM,GAET,cACIvL,KAAKtJ,UAAY,eACjB,IAA6B,sBAAI,2mBAGrC,WACI,OAAO,KAGX,IAAIf,EAAkBsD,GAClB,OAAO,IAAI,GAAkBtD,EAASsD,EAAO+G,KAAKtJ,YAInD,MAAM,WAA0B,GAGnC,YAAYf,EAAkBsD,EAAiBvC,GAC3CkK,MAAM,oBAAqBjL,EAASsD,GAHxC,oBACA,oBAGI+G,KAAKrK,QAAUA,EACf,GAAAqK,KAAI,GAActJ,GAClB,GAAAsJ,KAAI,OAGR,OAAOoE,GACH,GAAI,GAAApE,KAAA,IACA,OAEJ,MAAMyL,EAAczL,KAAKrK,QAAQmC,aAAa,GAAAkI,KAAA,KACxC0L,EAAU,YAAGD,GAAe,IAAM,WAAWA,GAAiB,KACpE,IAAK,YAAGC,GACJ,OAEJ,MAAMf,EAAc,IAAI,GAAYe,GAASlB,QAC7CxK,KAAKrK,QAAQtB,UAAY,GACzB,GAAA2L,KAAI,OACJA,KAAKgC,OAAOhC,KAAK2L,WAAYhB,EAAac,GAG9C,QAAQrH,GACA,GAAApE,KAAA,IAKR,UACI,GAAAA,KAAI,OACJA,KAAKrK,QAAQtB,UAAY,GAGrB,WAAWsW,EAAsBjZ,GACrCsO,KAAKrK,QAAQ0Q,YAAYsE,GACzB3K,KAAKrK,QAAQuM,UAAUD,IAAI,qBAAqBvQ,I,qCCzDjD,MAAMka,GAET,cACI5L,KAAKtJ,UAAY,YAGrB,WACI,OAAO,KAGX,IAAIf,EAAkBsD,GAClB,OAAO,IAAI,GAAgBtD,EAASsD,EAAO+G,KAAKtJ,YAIjD,MAAM,WAAwB,GAGjC,YAAYf,EAAkBsD,EAAiBvC,GAC3CkK,MAAM,kBAAmBjL,EAASsD,GAFtC,oB,8GAII,CAAA+G,KAAI,GAActJ,GAGtB,OAAO0N,IAIP,QAAQA,IAIR,Y,+QC7BG,MAAM,GAET,YAAY1Q,GACRsM,KAAKtJ,UAAY,YAAGhD,GAAUA,EAAS,SAAW,aAGtD,WACI,OAAO,KAGX,IAAIiC,EAAsBsD,GACtB,OAAO,IAAI,GAAiBtD,EAASsD,EAAO+G,KAAKtJ,YAUlD,MAAM,WAAyB,GAKlC,YAAYf,EAAsBsD,EAAiBvC,GAC/CkK,MAAM,mBAAoBjL,EAASsD,GALvC,oBACA,oBACA,oBACA,oBAGI+G,KAAKrK,QAAUA,EACf,GAAAqK,KAAI,GAActJ,GAClB,GAAAsJ,KAAI,GAAS,MACb,GAAAA,KAAI,GAAW,MACf,GAAAA,KAAI,GAAW,MAGnB,OAAOoE,GACHpE,KAAK6L,eAAezH,GACpBpE,KAAKrK,QAAQ4N,iBAAiB,QAASvD,KAAKsD,QAAQ3Q,KAAKqN,OAG7D,QAAQoE,GACJpE,KAAK6L,eAAezH,GAGxB,UACIpE,KAAKrK,QAAQ2T,oBAAoB,QAAStJ,KAAKsD,QAAQ3Q,KAAKqN,OAGhE,QAAQuJ,G,MACJ,IAAK,YAAG,GAAAvJ,KAAA,KACJ,OAEJ,IAAI8L,EAAK,YAAa,GAAA9L,KAAA,KAAgB,GAAAA,KAAA,IAAapK,UAE/CmW,EAAKD,EADE,GAAA9L,KAAA,IAAagM,UAExB,GAAAhM,KAAA,IAAaiM,SAAS,CAClBC,IAAKH,EACLI,SAA6B,QAArB,EAAE,GAAAnM,KAAA,IAAWmM,oBAAQ,IAAI,SAErCnM,KAAKoM,UAAU,IAAO5M,UAAW,CAC7BsM,GAAIA,EACJC,GAAIA,EACJ5V,OAAQ,GAAA6J,KAAA,IACRqM,OAAQ,GAAArM,KAAA,IACRsM,UAAWhV,KAAKmJ,QAEpB8I,EAAGgD,iBAGC,eAAenI,GACnB,GAAApE,KAAI,GAASoE,GACb,GAAApE,KAAI,GAAW7L,SAASiS,cAAc,GAAApG,KAAA,IAAW7J,SAC7C,YAAG,GAAA6J,KAAA,MACH,GAAAA,KAAI,GAAW,YAAG,GAAAA,KAAA,IAAWqM,QAAUlY,SAASiS,cAAc,GAAApG,KAAA,IAAWqM,QAAU,GAAArM,KAAA,IAAawM,gB,kUCvErG,MAAM,GAOT,YAAYrW,EAAiBsW,GAN7B,oBACA,oBACA,oBACA,oBACA,oBACA,oBAEI,GAAAzM,KAAI,GAAW7J,GACf,GAAA6J,KAAI,OACJ,GAAAA,KAAI,GAAc,YAAuByM,EAAW,EAAG,IAAK,IAC5D,GAAAzM,KAAI,MAAUA,KAAI,GAAU,IAGhC,YAAYO,GACR,GAAAP,KAAI,GAAaO,GAGrB,SACI,GAAAP,KAAA,IAAauD,iBAAiB,SAAUvD,KAAK0M,SAAS/Z,KAAKqN,OAG/D,SACI,GAAAA,KAAA,IAAasJ,oBAAoB,SAAUtJ,KAAK0M,SAAS/Z,KAAKqN,OAGlE,eACI,OAAO,GAAAA,KAAA,IAGH,SAASuJ,GACb,GAAAvJ,KAAA,MAAAA,KAAA,IAAe,GAAAA,KAAA,IAAa2M,YAC5B,GAAA3M,KAAA,MAAAA,KAAA,IAAe,GAAAA,KAAA,IAAagM,YACxB,GAAAhM,KAAA,KAAqBA,KAAK4M,oBAG9B,GAAA5M,KAAI,OAEJ6M,sBAAsB,KAClB,GAAA7M,KAAA,SAAAA,KAAe,CACX7E,KAAMoO,EACN2C,IAAK,GAAAlM,KAAA,IAAagM,UAClBc,KAAM,GAAA9M,KAAA,IAAa2M,aAEvB,GAAA3M,KAAI,OACJ,GAAAA,KAAI,GAAU,GACd,GAAAA,KAAI,GAAU,MAId,kBACJ,OAAO,GAAAA,KAAA,KAAmB,GAAM,GAAAA,KAAA,QAAAA,KAAA,KAAkC,GAAAA,KAAA,QAAAA,KAAA,K,4WC1CnE,MAAM,GAOT,cACIA,KAAK+M,OAAS,EAElB,MAAM3I,GACF,IAAKA,EAAKsE,SACN,MAAM,IAAI/H,MAAM,uBAEpBX,KAAK0I,SAAWtE,EAAKsE,SACrB1I,KAAK+B,OAAS,EAAiB/P,IAAIoS,EAAKrC,QACxC/B,KAAKgN,KAAO5I,EAAK4I,KACjBhN,KAAKiN,WAAa,EAAiBjb,IAAIoS,EAAK6I,YAC5CjN,KAAK+M,OAAS,YAAuBlX,SAASuO,EAAK2I,SAAU,EAAG,EAAG,IAGpE,MAAMG,GAET,YAAYxZ,GACRsM,KAAKtJ,WAAehD,UAAU,OAAb,aAGrB,WACI,OAAO,KAGX,IAAIiC,EAAkBsD,GAClB,OAAO,IAAI,GAAoBtD,EAASsD,EAAO+G,KAAKtJ,YAIrD,MAAM,WAA4B,GAWrC,YAAYf,EAAkBsD,EAAiBvC,GAC3CkK,MAAM,sBAAuBjL,EAASsD,GAX1C,oBACA,oBACA,oBACA,oBACA,oBACA,oBACA,oBACA,oBACA,oBACA,oBAGI+G,KAAKrK,QAAUA,EACf,GAAAqK,KAAI,GAActJ,GAClB,GAAAsJ,KAAI,GAAa,IAAI,GAAkBA,KAAKrK,QAASqK,KAAK/G,MAAM4K,MAAMxC,kBACtE,GAAArB,KAAI,GAAS,IAAI,IACjB,GAAAA,KAAI,GAAU,IACd,GAAAA,KAAI,GAAY,IAChB,GAAAA,KAAI,MAAeA,KAAI,GAAkB,GAAAA,KAAA,IAAoB,IAGjE,OAAOoE,GACHpE,KAAKqE,KAAKI,MAAM,SAAU,UAC1B,GAAAzE,KAAI,GAAkBA,KAAKrK,QAAQqW,WACnC,GAAAhM,KAAI,GAAmBA,KAAKrK,QAAQgX,YACpC3M,KAAKvJ,eAAe2N,GACpBpE,KAAKmN,iBAAiB,GAAAnN,KAAA,KACtB,GAAAA,KAAA,IAAe0J,YAAY1J,KAAKoN,SAASza,KAAKqN,OAC9C,GAAAA,KAAA,IAAe4J,SAGnB,QAAQxF,GACJpE,KAAKqE,KAAKI,MAAM,WAChBzE,KAAKvJ,eAAe2N,GACpB,GAAApE,KAAI,GAAkBA,KAAKrK,QAAQqW,WACnC,GAAAhM,KAAI,GAAmBA,KAAKrK,QAAQgX,YACpC3M,KAAKmN,iBAAiB,GAAAnN,KAAA,KAG1B,UACI,GAAAA,KAAA,IAAe6J,SAGX,SAASN,GACb,IAAIrP,GAAO,EAMX,GAJIA,EADAxB,KAAK2U,IAAI9D,EAAGuD,KAAO,GAAA9M,KAAA,KAAwBtH,KAAK2U,IAAI9D,EAAG2C,IAAM,GAAAlM,KAAA,KACvDA,KAAKsN,qBAAqB/D,EAAGuD,MAE7B9M,KAAKmN,iBAAiB5D,EAAG2C,KAE/BhS,IAAQ,GAAA8F,KAAA,IAAkB,CAC1B,IAAIuN,EAAYvN,KAAKyH,WAAWvN,GAChC8F,KAAKoM,UAAU,IAAO3M,iBAAkB,CACpCyM,IAAK3C,EAAG2C,IACRY,KAAMvD,EAAGuD,KACT3W,OAAQoX,EACRjB,UAAWhV,KAAKmJ,QAIxB,GAAAT,KAAI,GAAkBA,KAAKrK,QAAQqW,WACnC,GAAAhM,KAAI,GAAmBA,KAAKrK,QAAQgX,YAGhC,eAAevI,GACnB,GAAApE,KAAA,IAAWhJ,MAAMoN,GACjB,GAAApE,KAAI,GAAY,IAAIA,KAAKrK,QAAQoQ,iBAAiB,GAAA/F,KAAA,IAAW0I,YAC7D,GAAA1I,KAAI,GAAU,GAAAA,KAAA,IAAWgN,KAAO,IAAI7Y,SAAS4R,iBAAiB,GAAA/F,KAAA,IAAWgN,OAAS,IAClF,GAAAhN,KAAI,GAAkB,GAAAA,KAAA,IAAc1M,QACpC,GAAA0M,KAAI,GAAgB,GAAAA,KAAA,IAAY1M,QAG5B,iBAAiBka,GACrB,OAAO,GAAAxN,KAAA,IAAcyN,UAAWtX,IAC5B,IAAI4W,EAAS,YAAa5W,GAAgB6J,KAAKrK,QAASC,UACpD8X,EAAQX,EAAS,GAAA/M,KAAA,IAAW+M,OAChC,OAAOA,EAASW,GAASF,GAAUA,EAAST,EAAS5W,EAAOwX,aAAeD,IAI3E,qBAAqBF,GACzB,OAAO,GAAAxN,KAAA,IAAcyN,UAAWtX,IAC5B,IAAI4W,EAAS,YAAc5W,GAAgB6J,KAAKrK,QAASK,WACrD0X,EAAQX,EAAS,GAAA/M,KAAA,IAAW+M,OAChC,OAAOA,EAASW,GAASF,GAAUA,EAAST,EAAS5W,EAAOyX,YAAcF,IAU1E,WAAWxT,GACf,IAAK,YAAUA,EAAK,EAAG,GAAA8F,KAAA,KACnB,MAAM,IAAI,KAA4B,sCAE1C,IAAIrJ,EAAM,GAAAqJ,KAAA,IAAc9F,GAYxB,OAXA,GAAA8F,KAAA,IAAW+B,OAAOE,IAAItL,GACtB,GAAAqJ,KAAA,IAAW+B,OAAOI,OAAO,GAAAnC,KAAA,OAAAA,KAAA,MACrB,GAAAA,KAAA,IAAoB,IAChB,YAAU9F,EAAK,EAAG,GAAA8F,KAAA,MAClB,GAAAA,KAAA,IAAWiN,WAAWhL,IAAI,GAAAjC,KAAA,IAAY9F,IAEtC,YAAU,GAAA8F,KAAA,IAAkB,EAAG,GAAAA,KAAA,MAC/B,GAAAA,KAAA,IAAWiN,WAAW9K,OAAO,GAAAnC,KAAA,OAAAA,KAAA,OAGrC,GAAAA,KAAI,GAAe9F,GACZvD,G,gZC5JR,MAAM,GAMT,YAAYkX,GALZ,KAAAjG,YAAsB,kBACtB,KAAAlW,KAAe,aAEf,oBACA,oBAEIsO,KAAK4H,YAAc,yBACnB5H,KAAK6D,MAAQgK,EAGjB,KAAK5U,GACD,GAAA+G,KAAI,GAAU/G,GACV+G,KAAK6D,MAAMiK,WAAa,eACxB,GAAA9N,KAAA,IAAY+N,cAAaA,GAE7B,GAAA/N,KAAI,GAAa,IAAIoJ,GAAsB,UAC3C,GAAApJ,KAAA,IAAe0J,YAAY1J,KAAK2J,SAAShX,KAAKqN,OAC9C,GAAAA,KAAA,IAAe4J,SAGnB,UACI,GAAA5J,KAAA,IAAe6J,SAGnB,SAASN,G,QACLvJ,KAAK6D,MAAQ,GAAA7D,KAAA,IAAY6D,MAAMtC,QAAQvB,KAAK4H,aACP,QAAxB,EAAa,QAAb,EAAG5H,KAAK6D,iBAAK,WAAEiK,qBAAS,OAEjC5W,QAAQgJ,IAAIqJ,EAAGlU,SACXkU,EAAGlU,QACH,GAAA2K,KAAA,IAAY+N,cAAaA,GAEzB,GAAA/N,KAAA,IAAY+N,cAAaA,K,2RCJlC,MAAMC,GAMT,YAAYvd,EAAegc,GAH3B,oBACA,oBACA,oBAEI,GAAAzM,KAAI,GAASvP,GACb,GAAAuP,KAAI,GAAcyM,UAAa,CAAC,EAAG,GAAK,IAAM,GAAK,MAIvD,YAAYlM,GACR,GAAAP,KAAI,GAAaO,GAGrB,UACIP,KAAK+E,SAAW,IAAIkJ,qBAAqB,GAAAjO,KAAA,IAAgB,CACrDvP,KAAM,GAAAuP,KAAA,IACNkO,WAAY,MACZzB,UAAW,GAAAzM,KAAA,MAInB,QAAQ7J,GACJ6J,KAAK+E,SAASH,QAAQzO,GAG1B,UAAUA,GACN6J,KAAK+E,SAASoJ,UAAUhY,GAG5B,aACI6J,KAAK+E,SAASF,c,6SC/Df,MAAM,GAIT,cACI7E,KAAK7J,OAAS,MACd6J,KAAK+B,OAAS,EAAiB/P,IAAI,SACnCgO,KAAK+M,OAAS,EAGlB,MAAM3I,GACFpE,KAAK7J,OAAS,YAAGiO,EAAKjO,QAAUiO,EAAKjO,OAAS,MAC9C6J,KAAK+B,OAAS,YAAGqC,EAAKrC,QAAU,EAAiB/P,IAAIoS,EAAKrC,QAAU,EAAiB/P,IAAI,SACzFgO,KAAK+M,OAAS,YAAuBlX,SAASuO,EAAK2I,QAAS,EAAG,EAAG,IAInE,MAAMqB,GAET,YAAY1a,GACRsM,KAAKtJ,WAAehD,UAAU,OAAb,gBAGrB,WACI,OAAO,KAGX,IAAIiC,EAAkBsD,GAClB,OAAO,IAAI,GAAuBtD,EAASsD,EAAO+G,KAAKtJ,YAIxD,MAAM,WAA+B,GAKxC,YAAYf,EAAkBsD,EAAiBvC,GAC3CkK,MAAM,yBAA0BjL,EAASsD,GAL7C,oBACA,oBACA,oBACA,oBAGI,GAAA+G,KAAI,GAActJ,GAClB,GAAAsJ,KAAI,GAAa,IAAIgO,GAAwBhO,KAAKrK,UAClD,GAAAqK,KAAI,GAAS,IAAI,IACjB,GAAAA,KAAI,GAAY,IAGpB,OAAOoE,GACHpE,KAAK6L,eAAe,KAAMzH,GAC1B,GAAApE,KAAA,IAAe0J,YAAY1J,KAAKqO,eAAe1b,KAAKqN,OACpD,GAAAA,KAAA,IAAesO,UACf,GAAAtO,KAAA,IAAcrI,QAAQxB,IAClB,GAAA6J,KAAA,IAAe4E,QAAQzO,KAI/B,QAAQiO,GACJ,IAAImK,EAAO,SAAA/c,EAAA,CAAM,GAAAwO,KAAA,KACjBA,KAAK6L,eAAe0C,EAAMnK,GAG9B,UACI,GAAApE,KAAA,IAAe6E,aAGnB,eAAe0J,EAAiCnK,GAC5C,GAAApE,KAAA,IAAWhJ,MAAMoN,GACJ,OAATmK,GAAiBA,EAAKpY,SAAW,GAAA6J,KAAA,IAAW7J,QAC5C,GAAA6J,KAAI,GAAY,IAAI7L,SAAS4R,iBAAiB,GAAA/F,KAAA,IAAW7J,UAIjE,eAAeqY,EAAsCzJ,GACjD,IAAK,YAAG,GAAA/E,KAAA,KACJ,OAEJ,IAAI+B,EAAS,KACbyM,EAAQ7W,QAAQ8W,IACZ1M,EAAS/B,KAAK0O,UAAUD,EAAMtY,QAC1BsY,EAAME,gBAAkBF,EAAMG,kBAAoB,GAAA5O,KAAA,IAAW+M,OAC7DhL,EAAOE,IAAIwM,EAAMtY,QAEjB4L,EAAOI,OAAOsM,EAAMtY,QAExB6J,KAAK6O,iBAAiBJ,KAI9B,UAAU9Y,GACN,OAAOA,EAAQyD,aAAa,UAAY,EAAiBpH,IAAI2D,EAAQmC,aAAa,WAAa,GAAAkI,KAAA,IAAW+B,OAG9G,iBAAiB0M,GACbzO,KAAKoM,UAAU,IAAO1M,gBAAiB,CACnC+O,MAAOA,EACP1B,OAAQ,GAAA/M,KAAA,IAAW+M,OACnBT,UAAWhV,KAAKmJ,S,kUC9FrB,MAAM,GAIT,cACIT,KAAK7J,OAAS,GACd6J,KAAK+B,OAAS,KACd/B,KAAKpM,QAAU,EAGnB,MAAMwQ,GACF,GAAI,YAAGA,IAAS,YAASA,GAIrB,OAHApE,KAAK7J,OAASiO,EACdpE,KAAK+B,OAAS,UACd/B,KAAKpM,SAAW,GAGpBoM,KAAK7J,OAAS,YAAmBiO,EAAKjO,OAAQ,MAC9C6J,KAAK+B,OAAS,EAAiB/P,IAAIoS,EAAKrC,QACxC/B,KAAKpM,QAAU,YAAgBwQ,EAAKxQ,SAAU,GAGlD,UACI,OAAO,YAAGoM,KAAK7J,SAIhB,MAAM2Y,GAGT,YAAYpb,GADZ,oBAEI,GAAAsM,KAAI,GAAWtM,UAAU,OACzBsM,KAAKtJ,UAAe,GAAAsJ,KAAA,IAAH,QAGrB,WACI,OAAO,KAGX,IAAIrK,EAAkBsD,GAClB,OAAO,IAAI,GAAetD,EAASsD,EAAO+G,KAAKtJ,UAAW,GAAAsJ,KAAA,M,eAI3D,MAAM,WAAuB,GAMhC,YAAYrK,EAAkBsD,EAAiBvC,EAAmBhD,GAC9DkN,MAAM,iBAAkBjL,EAASsD,GANrC,oBACA,oBACA,oBACA,oBACA,oBAGI,GAAA+G,KAAI,GAAkB,IAAI,EAAiB/G,EAAM6I,eACjD,GAAA9B,KAAI,GAAS,IAAI,IACjB,GAAAA,KAAI,OACJ,GAAAA,KAAI,GAAWtM,GACf,GAAAsM,KAAI,OAIR,OAAOoE,GACHpE,KAAKqE,KAAKI,MAAM,OAAQ,UACxB,GAAAzE,KAAA,IAAWhJ,MAAMoN,GACb,GAAApE,KAAA,IAAW+O,YACX/O,KAAKrK,QAAQ4N,iBAAiB,QAASvD,KAAKsD,QAAQ3Q,KAAKqN,OACzD,GAAAA,KAAI,OACJA,KAAKqE,KAAKI,MAAM,cAAe,WAKvC,QAAQL,GACJpE,KAAKqE,KAAKI,MAAM,UAAW,WAC3B,GAAAzE,KAAA,IAAWhJ,MAAMoN,GACb,GAAApE,KAAA,IAAW+O,YAAc,GAAA/O,KAAA,MACzBA,KAAKrK,QAAQ4N,iBAAiB,QAASvD,KAAKsD,QAAQ3Q,KAAKqN,OACzD,GAAAA,KAAI,OACJA,KAAKqE,KAAKI,MAAM,cAAe,YAIvC,UACIzE,KAAKqE,KAAKI,MAAM,UAAW,WACvB,GAAAzE,KAAA,MACAA,KAAKrK,QAAQ2T,oBAAoB,QAAStJ,KAAKsD,QAAQ3Q,KAAKqN,OAC5DA,KAAKqE,KAAKI,MAAM,YAAa,YAKrC,QAAQ8E,GACJ,GAAI,GAAAvJ,KAAA,IACA,OAEJ,MAAM7J,EAAShC,SAASiS,cAAc,GAAApG,KAAA,IAAW7J,QACjD,GAAK,YAAGA,GAAR,CAKA,GADA,GAAA6J,KAAI,OACA,GAAAA,KAAA,IAAW+B,SAAkC,IAAxB,GAAA/B,KAAA,IAAWpM,QAAgB,CAChD,IAAIgQ,EAAQ,GAAA5D,KAAA,IAAWpM,QAAU,EAAI,GAAAoM,KAAA,IAAWpM,QAAUoM,KAAK/G,MAAM4K,MAAMjI,cAC3E,GAAAoE,KAAA,IAAoBiE,cAAc9N,EAAQ,GAAA6J,KAAA,IAAW+B,OAAQ6B,GAAOM,KAAK,KACrE/N,EAAO+L,UAAUD,IAAI,YAAe,GAAAjC,KAAA,MACpCA,KAAKgP,SAASzF,GACd,GAAAvJ,KAAI,cAGR7J,EAAO+L,UAAUD,IAAI,YAAe,GAAAjC,KAAA,MACpCA,KAAKgP,SAASzF,GACd,GAAAvJ,KAAI,OAERuJ,EAAGgD,sBAhBCvM,KAAKqE,KAAK7I,QAAQ,UAAU,GAAAwE,KAAA,IAAW7J,mBAAoB,WAmBnE,SAASoT,GACLvJ,KAAKoM,UAAU,IAAO/M,QAAS,CAC3B4J,MAAOM,EACP+C,UAAWhV,KAAKmJ,S,iVCtHrB,MAAM,GAIT,cACIT,KAAK7J,OAAS,GACd6J,KAAK+B,OAAS,KACd/B,KAAKpM,QAAU,EAGnB,MAAMwQ,GACF,GAAI,YAAGA,IAAS,YAASA,GAIrB,OAHApE,KAAK7J,OAASiO,EACdpE,KAAK+B,OAAS,UACd/B,KAAKpM,SAAW,GAGpBoM,KAAK7J,OAAS,YAAmBiO,EAAKjO,OAAQ,MAC9C6J,KAAK+B,OAAS,EAAiB/P,IAAIoS,EAAKrC,QACxC/B,KAAKpM,QAAU,YAAgBwQ,EAAKxQ,SAAU,IAI/C,MAAMqb,GAGT,YAAYvb,GADZ,oBAEI,GAAAsM,KAAI,GAAWtM,UAAU,OACzBsM,KAAKtJ,UAAe,GAAAsJ,KAAA,IAAH,SAGrB,WACI,OAAO,KAGX,IAAIrK,EAAkBsD,GAClB,OAAO,IAAI,GAAgBtD,EAASsD,EAAO+G,KAAKtJ,UAAW,GAAAsJ,KAAA,M,eAI5D,MAAM,WAAwB,GAMjC,YAAYrK,EAAkBsD,EAAiBvC,EAAmBhD,GAC9DkN,MAAM,kBAAmBjL,EAASsD,GANtC,oBACA,oBACA,oBACA,oBACA,oBAGI,GAAA+G,KAAI,GAAiB,IAAI,EAAiB/G,EAAM6I,eAChD,GAAA9B,KAAI,GAAS,IAAI,IACjB,GAAAA,KAAI,OACJ,GAAAA,KAAI,GAAWtM,GAGnB,OAAO0Q,GACHpE,KAAKqE,KAAKI,MAAM,OAAQ,UACxB,GAAAzE,KAAA,IAAWhJ,MAAMoN,GACjBpE,KAAKrK,QAAQ4N,iBAAiB,QAASvD,KAAKsD,QAAQ3Q,KAAKqN,OACzD,GAAAA,KAAI,OACJA,KAAKqE,KAAKI,MAAM,cAAe,UAGnC,QAAQL,GACJpE,KAAKqE,KAAKI,MAAM,UAAW,WAC3B,GAAAzE,KAAA,IAAWhJ,MAAMoN,GACZ,GAAApE,KAAA,MACDA,KAAKrK,QAAQ4N,iBAAiB,QAASvD,KAAKsD,QAAQ3Q,KAAKqN,OACzD,GAAAA,KAAI,OACJA,KAAKqE,KAAKI,MAAM,cAAe,YAIvC,UACIzE,KAAKqE,KAAKI,MAAM,UAAW,WACvB,GAAAzE,KAAA,MACAA,KAAKrK,QAAQ2T,oBAAoB,QAAStJ,KAAKsD,QAAQ3Q,KAAKqN,OAC5DA,KAAKqE,KAAKI,MAAM,YAAa,YAIrC,QAAQ8E,GACJ,GAAI,GAAAvJ,KAAA,IACA,OAEJ,MAAM7J,EAAS6J,KAAKkP,YACpB,GAAK,YAAG/Y,GAAR,CAKA,GADA,GAAA6J,KAAI,OACA,GAAAA,KAAA,IAAW+B,SAAkC,IAAxB,GAAA/B,KAAA,IAAWpM,QAAgB,CAChD,IAAIgQ,EAAQ,GAAA5D,KAAA,IAAWpM,QAAU,EAAI,GAAAoM,KAAA,IAAWpM,QAAUoM,KAAK/G,MAAM4K,MAAMjI,cAC3E,GAAAoE,KAAA,IAAmBiE,cAAc9N,EAAQ,GAAA6J,KAAA,IAAW+B,OAAQ6B,GAAOM,KAAK,KACpE/N,EAAO+L,UAAUC,OAAO,YAAe,GAAAnC,KAAA,MACvCA,KAAKmP,UAAU5F,GACf,GAAAvJ,KAAI,cAGR7J,EAAO+L,UAAUC,OAAO,YAAe,GAAAnC,KAAA,MACvCA,KAAKmP,UAAU5F,GACf,GAAAvJ,KAAI,OAERuJ,EAAGgD,sBAhBCvM,KAAKqE,KAAK7I,QAAQ,UAAU,GAAAwE,KAAA,IAAW7J,mBAAoB,WAmB3D,YACJ,OAAO,YAAG,GAAA6J,KAAA,IAAW7J,QAAUhC,SAASiS,cAAc,GAAApG,KAAA,IAAW7J,QAAU6J,KAAKrK,QAAQ6W,cAGpF,UAAUjD,GACdvJ,KAAKoM,UAAU,IAAO9M,SAAU,CAC5BgN,UAAWhV,KAAKmJ,MAChBwI,MAAOM,K,2UCjHZ,MAAM,GAGT,cACIvJ,KAAK+B,OAAS,KACd/B,KAAK7J,OAAS,KAGlB,MAAMiO,GACE,YAAGA,IAAS,YAASA,GACrBpE,KAAK+B,OAAS,EAAiB/P,IAAIoS,IAEnCpE,KAAK7J,OAAS,YAAmBiO,EAAKjO,OAAQ,MAC9C6J,KAAK+B,OAAS,EAAiB/P,IAAIoS,EAAKrC,UAI7C,MAAMqN,GAET,YAAY1b,GACRsM,KAAKtJ,WAAehD,UAAU,OAAb,UAGrB,WACI,OAAO,KAGX,IAAIiC,EAAkBsD,GAClB,OAAO,IAAI,GAAiBtD,EAASsD,EAAO+G,KAAKtJ,YAIlD,MAAM,WAAyB,GAKlC,YAAYf,EAAkBsD,EAAiBvC,GAC3CkK,MAAM,mBAAoBjL,EAASsD,GALvC,oBACA,oBACA,oBACA,oBAGI,GAAA+G,KAAI,GAActJ,GAClB,GAAAsJ,KAAI,GAAS,IAAI,IACjB,GAAAA,KAAI,GAAWA,KAAKrK,SACpB,GAAAqK,KAAI,GAAU/G,GAGlB,OAAOmL,GACH,GAAApE,KAAA,IAAWhJ,MAAMoN,GACjB,GAAApE,KAAI,GAAWA,KAAKkP,aACpBlP,KAAKrK,QAAQ4N,iBAAiB,QAASvD,KAAKsD,QAAQ3Q,KAAKqN,OAG7D,QAAQoE,GACJ,GAAApE,KAAA,IAAWhJ,MAAMoN,GACjB,GAAApE,KAAI,GAAWA,KAAKkP,aAGxB,UACIlP,KAAKrK,QAAQ2T,oBAAoB,QAAStJ,KAAKsD,QAAQ3Q,KAAKqN,OAGhE,QAAQuJ,GACJ,GAAAvJ,KAAA,IAAW+B,OAAOsN,OAAO,GAAArP,KAAA,OAAAA,KAAA,KACzBA,KAAKoM,UAAU,IAAO7M,UAAW,CAC7BwC,OAAQ,GAAA/B,KAAA,IAAW+B,OACnB5L,OAAQ,GAAA6J,KAAA,IACRsM,UAAWhV,KAAKmJ,QAEpB8I,EAAGgD,iBAGP,YACI,OAAO,YAAG,GAAAvM,KAAA,IAAW7J,QAAUhC,SAASiS,cAAc,GAAApG,KAAA,IAAW7J,QAAU6J,KAAKrK,S,sTCvEjF,MAAM2Z,GAET,cACItP,KAAKtJ,UAAY,aAGrB,WACI,OAAO,KAGX,IAAIf,EAAkBsD,GAClB,OAAO,IAAI,GAAiBtD,EAASsD,EAAO+G,KAAKtJ,YAIlD,MAAM,WAAyB,GAIlC,YAAYf,EAAkBsD,EAAiBvC,GAC3CkK,MAAM,mBAAoBjL,EAASsD,GAHvC,oBACA,oBAGI,GAAA+G,KAAI,GAActJ,GAClB,GAAAsJ,KAAI,GAAQ/G,EAAMsP,KAItB,OAAOnE,GAEH,GAAApE,KAAA,IAAUmJ,GAAG,IAAO/J,UAAWY,KAAKuP,OAAQvP,MAGhD,QAAQoE,IAIR,UACI,GAAApE,KAAA,IAAU6J,OAAO,IAAOzK,UAAWY,MAGvC,OAAOiK,GACH/S,QAAQgJ,IAAI+J,GAGhB,QACI,OAAO,YAAa,GAAAjK,KAAA,M,8RChDrB,MAAM,GAKT,YAAYwP,EAAqBC,GAJjC,oBACA,oBACA,oBACA,oBAEI,GAAAzP,KAAI,GAASyP,GACb,GAAAzP,KAAI,OACJ,GAAAA,KAAI,OAGR,YAAYO,GACR,GAAAP,KAAI,GAAaO,GAGrB,eACI,OAAO,GAAAP,KAAA,IAGX,SACI7L,SAASoP,iBAAiB,UAAWvD,KAAK0P,UAAU/c,KAAKqN,OACrD,GAAAA,KAAA,KACA7L,SAASoP,iBAAiB,QAASvD,KAAK2P,QAAQhd,KAAKqN,OAI7D,SACI7L,SAASmV,oBAAoB,UAAWtJ,KAAK0P,UAAU/c,KAAKqN,OACxD,GAAAA,KAAA,KACA7L,SAASoP,iBAAiB,QAASvD,KAAK2P,QAAQhd,KAAKqN,OAI7D,UAAUuJ,GACN,IAAI,GAAAvJ,KAAA,IAAJ,CAGA,GAAAA,KAAI,OACJ,IACS,YAAG,GAAAA,KAAA,OAAe,GAAAA,KAAA,IAAWvI,SAAS8R,EAAGqG,OAC1C,GAAA5P,KAAA,SAAAA,KAAeuJ,GAGrB,MAAOtS,GACLC,QAAQC,MAAMF,G,QAET,GAAA+I,KAAA,KACD,GAAAA,KAAI,SAIhB,QAAQuJ,GACJ,GAAAvJ,KAAI,Q,sTC5CL,MAAM,GAGT,YAAYuI,GAFZ,oBACA,oBAEI,GAAAvI,KAAI,GAAQuI,GACZ,GAAAvI,KAAI,GAAa,IAAI,QACrB,GAAAA,KAAA,IAAe0J,YAAY1J,KAAK0P,UAAU/c,KAAKqN,OAEnD,UACI,GAAAA,KAAA,IAAe4J,SAEnB,aACI,GAAA5J,KAAA,IAAe6J,SAGnB,UAAUN,GACN,GAAAvJ,KAAA,IAAUwI,KAAK,IAAO7I,WAAY,KAAM,CACpC2M,UAAWhV,KAAKmJ,MAChBwI,MAAOM,K,0JCpBZ,MAAM,GAKT,YAAYsG,GAHZ,KAAAne,KAAe,gBAEf,oBAEIsO,KAAK4H,YAAc,wBACnB5H,KAAK6D,MAAQgM,EAGjB,KAAK5W,I,+GACD,CAAA+G,KAAI,GAAiB,IAAI,GAAgB/G,EAAMsP,MAC/C,GAAAvI,KAAA,IAAmBsO,UAGvB,UACI,GAAAtO,KAAA,IAAmB6E,c,gjBCLpB,MAAM,GAET,cADA,oBAEI,GAAA7E,KAAI,GAAWjP,QAGb,KAAK8S,G,0CACP,IAAIiM,EAAQ,+BAAuB,IAAI,KAAmBjM,EAAMA,OAChE,MAAMkM,EAAoBD,EAASnO,IAC7BqO,EAAwB,CAC1BA,QAAOA,GAEX,GAAI,YAAG,GAAAhQ,KAAA,IAAa+P,IAEhB,OADAC,EAAOlW,QAAU,kCACVkW,EAEX,GAAI,YAAGnM,EAAMoM,OACT,IAAK,IAAI/F,KAAQrG,EAAMoM,MACnB,IAAM/F,GAAQrG,EAAMoM,MAAM/F,GAGlC,IACI,GAAAlK,KAAA,IAAa+P,GAAa,IAAI,GAAYD,EAAUjM,EAAMtC,QAASsC,EAAM7K,YACzE,GAAAgH,KAAA,IAAa+P,GAAWvO,OAC1B,MAAOvK,GAGL,OAFAC,QAAQC,MAAMF,GACd+Y,EAAOlW,QAAU,yCACVkW,EAGX,OADAA,EAAOA,UACAA,M,eAIR,MAAM,GAET,cADA,oBAEI,GAAAhQ,KAAI,OAGF,KAAKiK,G,gDACP,GAAI,GAAAjK,KAAA,IAEA,OADA9I,QAAQgJ,IAAI,oCAGhB,MAAMgQ,EAAc,IAAI,GAClBC,EAA2B,CAC7B,IAAI,GAAuB,CAAE1G,WAAUA,IACvC,IAAI,GAAuB,CAAEqE,WAAUA,IACvC,IAAI,GAAsB,OAGxBsC,EAAiC,CACnC,IAAIjG,GACJ,IAAI,GACJ,IAAI,GACJ,IAAIyB,GACJ,IAAI,GACJ,IAAIsB,GACJ,IAAIkB,GACJ,IAAIU,GACJ,IAAIG,GACJ,IAAIG,GACJ,IAAIE,IAGR,IAAIU,QAAeE,EAAY1O,KAAK,CAChCqC,MAAOoG,EAAKpG,MACZoM,MAAOhG,EAAKgG,MACZ1O,QAAS,YAAG0I,EAAK1I,SAAW,IAAI4O,KAAelG,EAAK1I,SAAW4O,EAC/DnX,WAAY,YAAGiR,EAAKjR,YAAc,IAAIoX,KAAkBnG,EAAKjR,YAAcoX,IAE/E,OAAIJ,EAAOA,QACP,GAAAhQ,KAAI,QAAkB,IAGtB9I,QAAQC,MAAM,yCAAuD,QAAd,EAAA6Y,EAAOlW,mBAAO,IAAI,QAE7E5C,QAAQgJ,IAAI,oC,4FChGb,MAAMmQ,EAOT,cAHQ,KAAAC,eACR,mBAGItQ,KAAKuQ,IAAMxf,OAAO8b,sBAAsBla,KAAK5B,QAC7CiP,KAAKwQ,OAAS,GACdxQ,KAAKyQ,MAAQ,G,8GACb,CAAAzQ,KAAI,EAAU,GAElB,OAAOO,EAAemQ,KAAatM,GAC/BpE,KAAKyQ,MAAMvN,KAAKlD,KAAK2Q,WAAWpQ,EAAUmQ,KAAQtM,IAClDpE,KAAK4Q,WAGT,MAAMrQ,EAAemQ,KAAatM,GAC9BpE,KAAKwQ,OAAOtN,KAAKlD,KAAK2Q,WAAWpQ,EAAUmQ,KAAQtM,IACnDpE,KAAK4Q,WAGD,WAAWrQ,EAAemQ,KAAatM,GAC3C,OAAOsM,GAAOtM,EAAO7D,EAAS5N,KAAK+d,KAAQtM,GAAQ7D,EAG/C,IAAIsH,GACR,IAAIgJ,EAAO,KACX,KAAOA,EAAOhJ,EAAMiJ,SAChBD,IAIA,SAASE,GACb,IAAK/Q,KAAKsQ,YAAa,CAEnB,GADAtQ,KAAKsQ,eACDS,G,iHAAa,CAAJ,QACT,MAAM,IAAIpQ,MAAM,0BAEhBX,KAAKuQ,IAAIvQ,KAAKgR,MAAMre,KAAKqN,KAAM+Q,KAMnC,MAAMA,GACV,IAAIE,EAAcF,UAAa,EAC3B5Z,EAAQ,KACRqZ,EAASxQ,KAAKwQ,OACdC,EAAQzQ,KAAKyQ,MAEjB,IACIzQ,KAAKkR,IAAIT,GACTzQ,KAAKkR,IAAIV,GACX,MAAOvZ,GACLE,EAAQF,EACRC,QAAQC,MAAMF,GAElB+I,KAAKsQ,eAEDnZ,GACA6I,KAAK4Q,SAASK,EAAM,IAEpBjR,KAAKwQ,OAAOld,QAAU0M,KAAKyQ,MAAMnd,SACjC0M,KAAK4Q,SAASG,EAAY,I,cAK/B,MAAMI,EAIT,cADA,KAAAC,aAEIpR,KAAK6H,MAAQ,GACb7H,KAAKuQ,IAAMxf,OAAO8b,sBAAsBla,KAAK5B,QAGjD,OAAOwP,EAAemQ,KAAatM,GAC/BpE,KAAK6H,MAAM3E,KAAKlD,KAAK2Q,WAAWpQ,EAAUmQ,KAAQtM,IAClDpE,KAAK4Q,WAGT,MAAMrQ,EAAemQ,KAAatM,GAC9BpE,KAAK6H,MAAM3E,KAAKlD,KAAK2Q,WAAWpQ,EAAUmQ,KAAQtM,IAClDpE,KAAK4Q,WAGD,WACC5Q,KAAKoR,YACNpR,KAAKoR,aACLpR,KAAKuQ,IAAIvQ,KAAKgR,MAAMre,KAAKqN,QAIzB,QACJ,IAAI6Q,EAAO,KACX,KAAOA,EAAO7Q,KAAK6H,MAAMiJ,SACrB,IACID,IAEJ,MAAO5Z,IAGX+I,KAAKoR,aAGD,WAAW7Q,EAAemQ,KAAatM,GAC3C,OAAOsM,GAAOtM,EAAO7D,EAAS5N,KAAK+d,KAAQtM,GAAQ7D,G,oQC3GpD,MAAM,EAKT,YAAYiB,GAHZ,mBACA,mBAGI,EAAAxB,KAAI,EAAS,IACb,EAAAA,KAAI,EAAW,IAEXwB,GACAA,EAAK7J,QAAQsQ,IACT,IAAK,YAAGA,EAAEvV,KAGN,MAFA,EAAAsN,KAAI,EAAS,IACb,EAAAA,KAAI,EAAW,IACT,IAAI,IAAc,gBAE5BA,KAAKiC,IAAIgG,EAAEvV,IAAKuV,EAAE7V,SAK9B,IAAIM,EAAaN,GAEb,GADA4N,KAAKqR,gBAAgB3e,GACjBsN,KAAKsR,YAAY5e,GACjB,MAAM,IAAIiO,MAAM,sBACpB,EAAAX,KAAA,GAAWkD,KAAKxQ,GAChB,EAAAsN,KAAA,GAAakD,KAAK9Q,GAGtB,OAAOM,GACH,IAAK,YAAGA,GACJ,OAEJ,IAAIgR,EAAQ,EAAA1D,KAAA,GAAWuR,QAAQ7e,GAC3BgR,GAAS,IACT,EAAA1D,KAAA,GAAWwR,OAAO9N,EAAO,GACzB,EAAA1D,KAAA,GAAawR,OAAO9N,EAAO,IAGnC,IAAIhR,GACAsN,KAAKqR,gBAAgB3e,GACrB,IAAIgR,EAAQ1D,KAAKuR,QAAQ7e,GACzB,KAAIgR,EAAQ,GAGZ,OAAO,EAAA1D,KAAA,GAAa0D,GAExB,YAAYhR,GACR,OAAO,YAAGA,IAAQsN,KAAKuR,QAAQ7e,IAAQ,EAE3C,OACI,OAAO,EAAAsN,KAAA,GAEX,SACI,OAAO,EAAAA,KAAA,GAGX,QAAQtN,GACJ,OAAO,YAAGA,GAAO,EAAAsN,KAAA,GAAWuR,QAAQ7e,IAAQ,EAGhD,OAAOA,EAAaN,GAChB4N,KAAKqR,gBAAgB3e,GACrB,IAAIgR,EAAQ1D,KAAKuR,QAAQ7e,GACzB,GAAIgR,EAAQ,EACR,MAAM,IAAI,IAAkB,kBAAkBhR,gBAElD,EAAAsN,KAAA,GAAa0D,GAAStR,EAG1B,QACI,EAAA4N,KAAI,EAAW,IACf,EAAAA,KAAI,EAAS,IAGT,gBAAgBtN,GACpB,IAAK,YAAGA,GACJ,MAAM,IAAI,IAAc,iB,kRC7E7B,MAAM,EAGT,YAAY+e,GAFZ,mBACA,mBAEI,EAAAzR,KAAI,EAAU,IAAI,GAClB,EAAAA,KAAI,EAAYyR,UAAW,KAE/B,IAAI/e,EAAaiD,GACR,YAAGjD,KACJsN,KAAK0R,IAAIhf,GACT,EAAAsN,KAAA,GAAY2R,OAAOjf,EAAKiD,IAG5BqK,KAAK4R,QACL,EAAA5R,KAAA,GAAYiC,IAAIvP,EAAKiD,KAGzB,IAAIjD,GACA,IAAK,YAAGA,GAAM,OAAO,KACrB,GAAIsN,KAAK0R,IAAIhf,GAAM,CACf,IAAIwS,EAAO,EAAAlF,KAAA,GAAYhO,IAAIU,GAC3B,GAAIwS,EAAKC,UACL,OAAOD,EAEX,EAAAlF,KAAA,GAAYmC,OAAOzP,GAEvB,OAAO,KAGX,IAAIA,GACA,QAAO,YAAGA,IAAO,EAAAsN,KAAA,GAAYsR,YAAY5e,GAG7C,OAAOA,GACH,QAAK,YAAGA,MACJsN,KAAK0R,IAAIhf,KACT,EAAAsN,KAAA,GAAYmC,OAAOzP,OAM3B,QACI,EAAAsN,KAAA,GAAY6R,QAGR,QACA,EAAA7R,KAAA,GAAYyP,OAAOnc,QAAU,EAAA0M,KAAA,IAC7B,EAAAA,KAAA,GAAYmC,OAAO,EAAAnC,KAAA,GAAYyP,OAAO,K,2RC/C3C,MAAM,EAKT,YAAYqC,GAJZ,mBACA,mBACA,mBAGI,EAAA9R,KAAI,EAAW,IACf,EAAAA,KAAI,EAAiB8R,GACrB,EAAA9R,KAAI,EAAQ,IAAiBhO,IAAI,gBAWrC,GAAGN,EAAc6O,EAAemQ,EAAiBqB,GAC7C,IAAK,SAAAzY,EAAA,CAAI5H,EAAM6O,GACX,MAAM,IAAI,IAAc,oBAG5B,IAAIN,EAAKD,KAAKgS,eAAetB,GAO7B,OANA,EAAA1Q,KAAA,GAAUyE,MAAM,yBAAyB/S,YAAeuO,MACnD,EAAAD,KAAA,GAAatO,KACd,EAAAsO,KAAA,GAAatO,GAAQ,IAGzB,EAAAsO,KAAA,GAAatO,GAAMuO,GAAM,CAAEyQ,IAAKA,EAAKnQ,SAAUA,EAAUxG,MAAOiG,KAAKiS,QAAQF,IACtE9R,EAUX,OAAOvO,EAAcgf,EAAiBqB,GAClC,IAAK,SAAAzY,EAAA,CAAI5H,EAAMgf,GACX,MAAM,IAAI,IAAc,oBAE5B,IAAInH,EAAK,EAAAvJ,KAAA,GAAatO,GAClBuO,EAAKyQ,EAAIwB,QACb,EAAAlS,KAAA,GAAUyE,MAAM,oBAAoBxE,YAAavO,MAC7CsO,KAAKmS,WAAW5I,EAAItJ,WACbsJ,EAAGtJ,GASlB,UAAUvO,GACF,YAAGA,IAAS,EAAAsO,KAAA,GAAatO,UAClB,EAAAsO,KAAA,GAAatO,GAEpB,EAAAsO,KAAA,GAAU7I,MAAM,qCAAsC,aAWxD,KAAK8R,EAAee,KAAiB5F,G,2UACvC,IAAK,YAAG6E,GACJ,MAAM,IAAI,IAAc,2BAI5B,OAFA,EAAAjJ,KAAA,GAAUyE,MAAM,UAAUwE,YACpB,EAAAjJ,KAAA,GAAmBnG,OAAO,EAAAmG,KAAA,GAAaiJ,GAAQe,EAAM5F,SAW/D,cAAc1S,EAAcgf,EAAiBqB,GACzC,IAAIxI,EAAK,EAAAvJ,KAAA,GAAatO,GACtB,OAAOsO,KAAKmS,WAAW5I,EAAImH,EAAIwB,QAASH,GAGpC,WAAWxI,EAAsBtJ,EAAY8R,GACjD,OAAI,YAAGA,GACI,YAAGxI,IAAO,YAAGtJ,IAAO,YAAGsJ,EAAGtJ,KAAQ,YAAGsJ,EAAGtJ,GAAIlG,QAAUgY,EAAIhY,OAE9D,YAAGwP,IAAO,YAAGtJ,IAAO,YAAGsJ,EAAGtJ,IAG7B,QAAQ8R,GACZ,OAAO,YAAGA,GAAOA,EAAIhY,MAAQ,KAGzB,eAAe2W,GACnB,OAAO,SAAApX,EAAA,CAAIoX,GAAOA,EAAIwB,QAAU,SAAAE,EAAA,I,keC1CjC,MAAM,UA3Db,MAGI,cACIpS,KAAKqS,MAAQ,GACbrS,KAAKsS,UAET,UAAUC,EAAgBC,GACtB,OAAQ,YAAGD,IAAY,YAAGA,IAAWA,IAAWC,IAqDpD,YAAYC,GACR7R,QAFJ,mB,8GAGI,CAAAZ,KAAI,EAAayS,GAGf,OAAOC,EAA0B1I,EAAc5F,G,yCAC5C,YAAGsO,KAGR1S,KAAKqS,MAAMnP,KAAK,CACZwP,OAAQA,EACR1I,KAAMA,EACN5F,KAAMA,IAELpE,KAAKsS,SACNtS,KAAKsS,UACLtS,KAAK2S,UACD3S,KAAKqS,MAAM/e,OAAS,GACpB0M,KAAK2S,UAET3S,KAAKsS,eAKC,U,yCACV,IAAIzB,EAAO7Q,KAAKqS,MAAMvB,QAClB8B,EAA4B,GAChC,IAAK,IAAI3S,KAAM4Q,EAAK6B,OAAQ,CACxB,IAAIzJ,EAAQ4H,EAAK6B,OAAOzS,GACpBD,KAAK6S,UAAUhC,EAAK7G,KAAMf,EAAMlP,QAChC6Y,EAAS1P,KAAK,EAAAlD,KAAA,GAAe8S,QAAQ7J,EAAM1I,SAAU0I,EAAMyH,IAAKG,EAAKzM,OAE7E,OAAOvQ,QAAQiU,IAAI8K,O,cCrGpB,MAAM,EACH,QAAQrS,EAAemQ,EAAUtM,G,2UACnCA,EAAOA,UAAQ,GACX,YAAGsM,GACHnQ,EAASwS,MAAMrC,EAAKtM,GAEpB7D,KAAY6D,O,aCDjB,MAAM,EAET,YAAYtC,GADZ,mB,8GAEI,CAAA9B,KAAI,EAAiB8B,GAGzB,OAAOgJ,GACH,GAAI,YAAGA,GAAQ,CACX,MAAMkI,EAAO7e,SAAS6e,MAAQ7e,SAAS8e,qBAAqB,QAAQ,GAC9Dla,EAAO5E,SAASC,cAAc,SAC9B8e,EAAO/e,SAASgf,eAAerI,GACrC/R,EAAKkM,KAAO,WACZlM,EAAKsN,YAAY6M,GACjBF,EAAK3M,YAAYtN,GAErB,OAAM,G,wQCjBP,MAAM,EAMT,YAAY+I,GALZ,mBACA,mBACA,WAA0B,IAC1B,WAAyB,IAGrB,EAAA9B,KAAI,EAAS7L,SAASif,iBACtB,EAAApT,KAAI,EAAiB8B,GAGzB,iBAAiB/G,EAAiBX,GAC9B4F,KAAKqT,cAAc,IAA0BtY,MAAOA,EAAMuY,eAC1DtT,KAAKqT,cAAc,IAA0BjZ,KAAMA,EAAKkZ,eAG5D,uBAAuBvY,EAAiBX,GACpC4F,KAAKqT,cAAc,IAAgCtY,MAAOA,EAAMuY,eAChEtT,KAAKqT,cAAc,IAAgCjZ,KAAMA,EAAKkZ,eAGlE,iBAAiBvY,EAAiBX,GAC9B4F,KAAKqT,cAAc,IAA4BtY,MAAOA,EAAMuY,eAC5DtT,KAAKqT,cAAc,IAA4BjZ,KAAMA,EAAKkZ,eAG9D,SAASrO,EAAuBmC,G,QAC5B,MAAMmM,EAAS,IAAWtO,GACpBuO,EAAYpM,EAAIjM,KACtB,IAAK,YAAGoY,KAAY,YAAGC,GACnB,OAEJ,MAAMC,EAAsB,QAAZ,EAAGrM,EAAIhM,iBAAK,IAAIoY,EAAU1e,QAAQ4e,QAAQ,EAAA1T,KAAA,IACpD2T,EAAwB,QAAb,EAAGvM,EAAI7M,kBAAM,IAAIiZ,EAAU1e,QAAQ8e,OAAO,EAAA5T,KAAA,IAE3D,EAAAA,KAAA,GAAmBgC,OAAO,KACtBhC,KAAKsI,YAAYiL,EAAOpY,KAAMqY,EAAUF,eACxCtT,KAAKsI,YAAYiL,EAAOhZ,OAAQoZ,EAAYL,eAC5CtT,KAAKsI,YAAYiL,EAAOnY,MAAOqY,EAAWH,gBAC3CtT,MAIP,iBAAiB6T,GACb,EAAA7T,KAAI,EAAmB,YAAc6T,EAAQ,EAAG,MAGpD,gBAAgBA,GACZ,EAAA7T,KAAI,EAAkB,YAAc6T,EAAQ,EAAG,MAGnD,YAAYC,EAAsB1hB,GAC9B,EAAA4N,KAAA,GAAW8K,MAAMxC,YAAYwL,EAAc1hB,GAG/C,cAAc0hB,EAAsB1hB,GAC3B,SAAAkH,EAAA,CAAIlH,EAAO0hB,IAGhB,EAAA9T,KAAA,GAAmBgC,OAAOhC,KAAKsI,YAAatI,KAAM8T,EAAc1hB,I,wTCzCjE,MAAM,EAST,YAAYmW,EAAmBkE,GAP/B,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBAEI,EAAAzM,KAAI,EAAU,IACd,EAAAA,KAAI,EAAa,IACjB,EAAAA,KAAI,EAAejP,OAAOgjB,YAC1B,EAAA/T,KAAI,MACJ,EAAAA,KAAI,EAAiB,YAAejP,OAAOgjB,aAC3C,EAAA/T,KAAI,EAAcyM,UAAa,GAC/B,EAAAzM,KAAI,EAAQuI,GAGhB,QAAQpS,GACM,EAAA6J,KAAA,GAAYyN,UAAUxF,GAAKA,IAAM9R,GACjC,GACN,EAAA6J,KAAA,GAAYkD,KAAK/M,GAIzB,UAAUA,GACN,IAAI+D,EAAM,EAAA8F,KAAA,GAAYyN,UAAUxF,GAAKA,IAAM9R,GACvC+D,GAAO,GACP,EAAA8F,KAAA,GAAYwR,OAAOtX,EAAK,GAGhC,UACInJ,OAAOwS,iBAAiB,SAAUvD,KAAK0M,SAAS/Z,KAAKqN,OAGzD,aACIjP,OAAOuY,oBAAoB,SAAUtJ,KAAK0M,SAAS/Z,KAAKqN,OAGpD,SAASuJ,GACb,GAAI,EAAAvJ,KAAA,GACA,OAEJ,EAAAA,KAAI,MACJ,MAAMgU,EAAOjjB,OAAOgjB,WAAa,EAAA/T,KAAA,GAEjC,GAAItH,KAAK2U,IAAI2G,IAAS,EAAAhU,KAAA,GAAiB,CACnC,MAAMiU,EAAc,YAAeljB,OAAOgjB,YAC1C,GAAIE,IAAgB,EAAAjU,KAAA,GAAoB,CACpC,MAAMkU,EAA4B,CAC9BjR,QAASgR,EACTE,SAAU,EAAAnU,KAAA,GACVvK,MAAO1E,OAAOgjB,WACd7I,OAAQna,OAAOqjB,YACf9H,UAAWhV,KAAKmJ,OAEpB,EAAAT,KAAA,GAAUwI,KAAK,IAAOpJ,UAAW,KAAM8U,GACnC,EAAAlU,KAAA,GAAY1M,OAAS,IACrB,EAAA0M,KAAI,EAAa,IACjB,EAAAA,KAAA,GAAYrI,QAAQsQ,IAChB,EAAAjI,KAAA,GAAekD,KAAK+E,EAAEsH,OAAO2E,MAEjCrgB,QAAQiU,IAAI,EAAA9H,KAAA,IACZ,EAAAA,KAAI,EAAa,KAGrB,EAAAA,KAAI,EAAiBiU,IAG7B,EAAAjU,KAAI,O,wGChFL,MAAM,EAQT,YAAYqU,GADZ,mBAEIrU,KAAK6D,WAAY,KAAWyQ,SAASD,GACrCrU,KAAK8B,aCpBN,MAKI,WAAWmD,GAEd,OADwBA,GAEpB,IAAK,QACD,OAAO,IAAIoL,EACf,QACI,OAAO,IAAIc,KDSwBnf,IAAIqiB,EAAazS,aAC5D5B,KAAK4I,MAAQ,IAAI,EAAgB5I,KAAK6D,MAAMpC,WAC5CzB,KAAKuI,IAAM,IAAI,EAAY,IAAI,EAAuB,IAAI,IAC1DvI,KAAKuT,OAAS,IAAI,EAAwBvT,KAAK8B,cAC/C9B,KAAKvG,cAAgB,IAAI,EAAyBuG,KAAK8B,c,8GACvD,CAAA9B,KAAI,EAAmB,IAAI,EAAkBA,KAAKuI,IAAKvI,KAAK6D,MAAMvC,kB,iHAClE,CAAAtB,KAAA,GAAqBsO,UAGzB,aAAahc,GACT,MAAMZ,EAAe,YAAQsO,KAAK6D,MAAMnQ,OAAQ,IAAQ0G,MAClDyI,EAAU1O,SAAS0N,KAAKK,UACjB,SAAT5P,GAAoBuQ,EAAQR,SAAS3Q,GAKrB,UAATY,GAAoBuQ,EAAQR,SAAS3Q,IAC5CsO,KAAK8B,aAAaE,OAAO,KACrBa,EAAQV,OAAOzQ,IAChBsO,MAPHA,KAAK8B,aAAaE,OAAO,KACrBa,EAAQZ,IAAIvQ,IACbsO,MASX,eACI,MAAMtO,EAAe,YAAQsO,KAAK6D,MAAMnQ,OAAQ,IAAQ0G,MACxD,OAAOjG,SAAS0N,KAAKK,UAAUG,SAAS3Q,GAAQ,OAAS,QAG7D,aAAa6iB,GACT,MAAM7iB,EAAe,YAAQsO,KAAK6D,MAAMnQ,OAAQ,IAAQ4G,OAClDuI,EAAU1O,SAAS0N,KAAKK,UAC1BqS,IAAS1R,EAAQR,SAAS3Q,GAC1BmR,EAAQZ,IAAIvQ,IAEJ6iB,GAAQ1R,EAAQR,SAAS3Q,IACjCmR,EAAQV,OAAOzQ,GAIvB,cACI,MAAMA,EAAe,YAAQsO,KAAK6D,MAAMnQ,OAAQ,IAAQ4G,OACxD,OAAOnG,SAAS0N,KAAKK,UAAUG,SAAS3Q,GAG5C,YAAYA,EAAcU,GACtB,IAAIoiB,EAAO,YAAc9iB,EAAMsO,KAAK6D,MAAMnQ,QAC1CS,SAASif,gBAAgBtI,MAAMxC,YAAYkM,EAAMpiB,I,4EEvEzDjB,EAAA,WAAAA,EAAA,KAAAA,EAAA,6CAAAA,EAAA,2CAAAA,EAAA,6CAAAA,EAAA,2CAAAA,EAAA,GAAAA,EAAA,yCAAAA,EAAA,mDAAAA,EAAA,GAAAA,EAAA,yCAAAA,EAAA,+CAAAA,EAAA,wCAeAJ,OAAO0jB,QAAU,IAAI","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"cui-light\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cui-light\"] = factory();\n\telse\n\t\troot[\"cui-light\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n","import { CuiLightMode, CuiWindowSize } from \"./types\";\r\nimport { ArgumentError, RegisterElementError } from \"../models/errors\";\r\nimport { ICuiComponent, CuiElement } from \"../models/interfaces\";\r\nimport { CuiUtils } from \"../models/utils\";\r\nimport { COMPONENTS_COUNTER } from \"./statics\";\r\n\r\n/**\r\n * Checks if value is defined an is not null\r\n * Additionally with type check it can check value if it is not empty string or collection or object\r\n * \r\n * @param val - value\r\n * @param typecheck - default true - additional check whether value is not empty (string, collection, object)\r\n * @returns whether value passed all conditions\r\n */\r\nexport function is(val: any, typecheck: boolean = true): boolean {\r\n    if (typeof val !== 'undefined' && val !== null) {\r\n        if (!typecheck) {\r\n            return true;\r\n        } else {\r\n            return !isEmpty(val)\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\n/**\r\n * Checks if value is empty string, array or object\r\n *\r\n *\r\n * @param val - value\r\n * @returns whether value passed all conditions\r\n */\r\nexport function isEmpty(val: any): boolean {\r\n    if (typeof val === \"string\") {\r\n        return val.length === 0\r\n    }\r\n    if (typeof val === \"boolean\") {\r\n        return val;\r\n    }\r\n    else if (Array.isArray(val)) {\r\n        return val.length === 0\r\n    }\r\n    return false\r\n}\r\n\r\nexport function getName(prefix: string, name: string) {\r\n    if (!is(prefix) || !is(name)) {\r\n        throw new ArgumentError(\"Missing argument value\")\r\n    }\r\n    return `${prefix}-${name}`\r\n}\r\n\r\nexport function sleep(timeout: number): Promise<boolean> {\r\n    return new Promise(resolve => setTimeout(() => {\r\n        resolve(true)\r\n    }, timeout));\r\n}\r\n\r\n/**\r\n * Creates proper html element from given string\r\n * @param htmlString - string containing html\r\n */\r\nexport function createElementFromString(htmlString: string): Element {\r\n    if (!is(htmlString)) {\r\n        return null;\r\n    }\r\n    let template = document.createElement('template')\r\n    template.innerHTML = htmlString\r\n    return template.content.children.length > 0 ? template.content.children[0] : null;\r\n}\r\n\r\nexport function getMatchingAttribute(element: any, attributes: string[]): string {\r\n    let attr = null;\r\n    let len = attributes.length;\r\n    for (let i = 0; i < len; i++) {\r\n        let attribute = attributes[i];\r\n        if (element.hasAttribute(attribute)) {\r\n            attr = attribute\r\n            break;\r\n        }\r\n    }\r\n    return attr;\r\n}\r\n\r\nexport function getMatchingAttributes(element: any, attributes: string[]): string[] {\r\n    if (!element || !is(element.hasAttribute)) {\r\n        return null;\r\n    }\r\n    return attributes.filter(a => {\r\n        return element.hasAttribute(a);\r\n    });\r\n}\r\n\r\nexport function getRangeValue(value: number, min: number, max: number) {\r\n    if (value < min) {\r\n        return min;\r\n    } else if (value > max) {\r\n        return max;\r\n    }\r\n    return value;\r\n}\r\n\r\nexport function getRangeValueOrDefault(value: number, min: number, max: number, def: number) {\r\n    if (value === null || typeof value === 'undefined' || isNaN(value)) {\r\n        return def;\r\n    }\r\n    return getRangeValue(value, min, max)\r\n}\r\n\r\nexport function increaseValue(value: number, amount: number): number {\r\n    return amount < 0 || amount > 1 ? 0 : value + (value * amount);\r\n}\r\n\r\nexport function decreaseValue(value: number, amount: number): number {\r\n    return amount < 0 || amount > 1 ? 0 : value - (value * amount);\r\n}\r\n\r\nexport function clone(object: any): any {\r\n    if (!is(object)) {\r\n        return null;\r\n    }\r\n    return Object.assign({}, object);\r\n}\r\n\r\nexport function getSingleColorRatio(first: number, second: number, max: number): number {\r\n    return Math.abs(((first - second) / max) * 100)\r\n}\r\n\r\n/**\r\n * Creates string containg css selector for array of attributes\r\n * @param attributes - attributes values\r\n */\r\nexport function joinAttributesForQuery(attributes: string[]): string {\r\n    if (!is(attributes)) {\r\n        return \"\"\r\n    }\r\n    return `[${attributes.join('],[')}]`\r\n}\r\n\r\n/**\r\n * Checks light system light mode\r\n * @returns Light Mode - dark/light\r\n */\r\nexport function getSystemLightMode(): CuiLightMode {\r\n    return window.matchMedia &&\r\n        window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\r\n}\r\n\r\n/**\r\n * Check print mode in the browser window\r\n * @returns true if window is displayed in print mode\r\n */\r\nexport function getSystemPrintMode(): boolean {\r\n    return window.matchMedia &&\r\n        window.matchMedia('print').matches;\r\n}\r\n\r\n/**\r\n * Verifies whether attributes exist and have some values\r\n * @param attributes attributes list\r\n */\r\nexport function are(...attributes: any[]): boolean {\r\n    if (!is(attributes)) {\r\n        return false\r\n    }\r\n    let c = attributes.length;\r\n    for (let i = 0; i < c; i++) {\r\n        if (!is(attributes[i])) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nexport function calcWindowSize(width: number): CuiWindowSize {\r\n    if (width <= 640) {\r\n        return 'small';\r\n    } else if (width > 640 && width <= 960) {\r\n        return \"medium\"\r\n    } else if (width > 960 && width <= 1200) {\r\n        return \"large\"\r\n    }\r\n    return 'xlarge';\r\n}\r\n\r\n/**\r\n * Creates object from string.\r\n * Supported syntaxes are:\r\n * - JSON\r\n * - single value\r\n * - key:value,value;key=value\r\n * \r\n * @param attribute - attribute value\r\n */\r\nexport function parseAttributeString(attribute: string): any {\r\n    let ret: any = parseJsonString(attribute.trim())\r\n\r\n    if (!is(ret)) {\r\n        if (!attribute.includes(';') && !attribute.includes(':')) {\r\n            ret = attribute;\r\n        } else {\r\n            ret = {}\r\n            attribute.split(';').forEach(val => {\r\n                let sp = val.split(':')\r\n                if (sp.length === 2) {\r\n                    ret[sp[0].trim()] = sp[1].trim()\r\n                }\r\n            })\r\n        }\r\n    }\r\n    return ret\r\n}\r\n\r\n/**\r\n * Creates object from JSON string\r\n* String must start with { and end with }\r\n *\r\n * @param attribute - attribute value\r\n * @returns object if string passes test, null otherwise\r\n */\r\n\r\nexport function parseJsonString(attribute: string): any | null {\r\n    let out = null;\r\n    if (is(attribute) && attribute.startsWith('{') && attribute.endsWith('}')) {\r\n        try {\r\n            out = jsonify(attribute);\r\n        } catch (e) {\r\n            console.error(prepLogString(\"An exception occured\", 'Functions', 'parseJsonString'), e)\r\n        }\r\n        return out;\r\n    }\r\n    return null;\r\n}\r\n\r\n/**\r\n * Creates object from JSON string\r\n * @param attribute - JSON string\r\n */\r\nexport function jsonify(attribute: string): any {\r\n    return attribute && attribute.length > 0 ? JSON.parse(attribute) : {}\r\n}\r\n\r\nexport function getOffsetTop(element: HTMLElement) {\r\n    if (!is(element)) {\r\n        return -1;\r\n    }\r\n    let val = element.offsetTop - parseInt(getStyleValue(element, 'margin-top')) - parseInt(getStyleValue(element, 'padding-top')) - parseInt(getStyleValue(element, 'border-top-width'))\r\n    return val < 0 ? element.offsetTop : val;\r\n\r\n}\r\n\r\nexport function getOffsetLeft(element: HTMLElement) {\r\n    if (!is(element)) {\r\n        return -1;\r\n    }\r\n    let val = element.offsetLeft - parseInt(getStyleValue(element, 'margin-left')) - parseInt(getStyleValue(element, 'padding-left')) - parseInt(getStyleValue(element, 'border-left-width'))\r\n    return val < 0 ? element.offsetLeft : val;\r\n}\r\n\r\nexport function getIntOrDefault(value: any, def: number): number {\r\n    let integer = parseInt(value);\r\n    return isNaN(integer) ? def : integer;\r\n}\r\n\r\nexport function getStyleValue(target: any, property: string): any {\r\n    if (!is(target) || !is(property)) {\r\n        return null;\r\n    }\r\n    if (target.currentStyle) {\r\n        return target.currentStyle[property];\r\n    } else if (window.getComputedStyle) {\r\n        return window.getComputedStyle(target, null).getPropertyValue(property)\r\n    }\r\n    return null;\r\n}\r\n\r\nexport function prepLogString(message: string, component: string, functionName?: string) {\r\n    return `[${new Date().toLocaleString()}][${component ?? \"-\"}][${functionName ?? '-'}][${message}]`\r\n}\r\n\r\nexport function isInRange(value: number, min: number, max: number): boolean {\r\n    return is(value) && value >= min && value <= max;\r\n}\r\n\r\nexport function getActiveClass(prefix: string) {\r\n    return `${prefix ?? \"\"}-active`;\r\n}\r\n\r\nexport function parseAttribute(element: Element, attribute: string): any {\r\n    return are(element, attribute) ? parseAttributeString(element.getAttribute(attribute)) : null;\r\n}\r\n\r\n\r\n/**\r\n *  Checks whether string value contains synonym of true\r\n * @param value - string to check\r\n */\r\nexport function isStringTrue(value: string): boolean {\r\n    return is(value) ? ['y', 't', 'true', 'yes'].includes(value.toLowerCase()) : false\r\n}\r\n\r\nexport function boolStringOrDefault(prop: any, def: boolean): boolean {\r\n    return is(prop) ? isStringTrue(prop) : def;\r\n}\r\n\r\nexport function getStringOrDefault(value: any, def: string) {\r\n    return is(value) ? value.toLowerCase() : def;\r\n}\r\n\r\n/**\r\n * Checks whether device supports touch\r\n */\r\nexport function isTouchSupported(): boolean {\r\n    return ('ontouchstart' in window) ||\r\n        (navigator.maxTouchPoints > 0) ||\r\n        (navigator.msMaxTouchPoints > 0);\r\n}\r\n\r\n/**\r\n * Checks whether value is type of string\r\n * @param {any} value - value to be checked\r\n */\r\nexport function isString(value: any): boolean {\r\n    return typeof value === 'string';\r\n}\r\n\r\n\r\n/**\r\n * Replaces mask {prefix} with actual value in the string\r\n * @param {string} value - text containg a mask\r\n * @param {string} prefix - value to be put in place of mask\r\n */\r\nexport function replacePrefix(value: string, prefix: string): string {\r\n    return !is(value) ? value : value.replace(\"{prefix}\", prefix ?? \"\");\r\n}\r\n\r\n/**\r\n * Generates identifier for Cui element\r\n * \r\n * @param element - Cui element selector\r\n * @returns generated identifier\r\n */\r\nexport function generateCUID(element?: string) {\r\n    let starter = is(element) ? element : \"cui-element\"\r\n    return `${starter}-${COMPONENTS_COUNTER.next().value}}`;\r\n}\r\n\r\n/**\r\n * Generates random string\r\n */\r\nexport function generateRandomString(): string {\r\n    let rand = getRandomInt(1, 1000)\r\n    let rand2 = getRandomInt(1, 100)\r\n    return `${Math.floor(Math.random() * rand2)}-${Math.floor(rand)}`;\r\n}\r\n/**\r\n * Generates random integer\r\n * @param min - min number\r\n * @param max - max number\r\n * @returns random integer\r\n */\r\nexport function getRandomInt(min: number, max: number): number {\r\n    min = Math.ceil(min);\r\n    max = Math.floor(max);\r\n    return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\n/**\r\n * Registers Element as Cui element, initializes handlers, sets component style to document header and sets $cuid\r\n * @param {any} node - document node\r\n * @param {ICuiComponent[]} components -supported components array\r\n * @param {string[]} attributes - supported attributes array\r\n * @param {CuiUtils} utils - Cui Utils instance\r\n */\r\nexport function registerCuiElement(node: any, components: ICuiComponent[], attributes: string[], utils: CuiUtils) {\r\n    let element = node as CuiElement;\r\n    element.$handlers = {};\r\n    let matching: string[] = getMatchingAttributes(node, attributes)\r\n    if (is(matching)) {\r\n        matching.forEach(match => {\r\n            let component = components.find(c => { return c.attribute === match });\r\n            if (is(component)) {\r\n                try {\r\n                    utils.styleAppender.append(component.getStyle());\r\n                    let handler = component.get(node, utils);\r\n                    element.$handlers[component.attribute] = handler;\r\n                    element.$handlers[component.attribute].handle(parseAttribute(node, component.attribute));\r\n                } catch (e) {\r\n                    throw new RegisterElementError(e.message);\r\n                }\r\n            }\r\n        })\r\n        element.$cuid = generateCUID(node.tagName)\r\n    }\r\n}\r\n\r\nexport function* counter() {\r\n    let idx = 0;\r\n    while (true) {\r\n        let reset = yield idx++;\r\n        if (reset || idx > 200000) {\r\n            idx = 0\r\n        }\r\n    }\r\n\r\n}","import { CuiLogLevel } from \"./types\";\r\nimport { CuiColorPair } from \"../models/colors\";\r\nimport { counter } from \"./functions\";\r\n\r\nexport const CLASSES = {\r\n    dark: 'dark',\r\n    animProgress: 'animation-progress',\r\n    print: 'print',\r\n    active: 'active'\r\n}\r\n\r\nexport const ICONS: any = {\r\n    close: \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 20 20\\\" width=\\\"20\\\" height=\\\"20\\\"><path d=\\\"M 1.9999999,1.9999999 18,18\\\"></path><path d=\\\"M 18,1.9999999 1.9999999,18\\\"></path></svg>\",\r\n    accordion: \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 20 20\\\" width=\\\"20\\\" height=\\\"20\\\"><path d=\\\"M 5.0000475,7.4490018 10.000024,12.551028 15,7.4490018\\\"></path></svg>\",\r\n    special_menu: \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 20 20\\\" width=\\\"20\\\" height=\\\"20\\\"><path class=\\\"menu_handle_2\\\" d=\\\"M 1,10 H 19\\\"></path><path class=\\\"menu_handle_1\\\" d=\\\"M 1,4.8571429 H 19\\\"></path><path  class=\\\"menu_handle_3\\\" d=\\\"M 1,15.142857 H 19\\\"></path></svg>\",\r\n    special_fail: \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"special-fail\\\" viewBox=\\\"0 0 100 100\\\" width=\\\"100\\\" height=\\\"100\\\"><path class=\\\"circle\\\" d=\\\"M 50,7.000001 A 43,43 0 0 1 92.999999,50 43,43 0 0 1 50,92.999999 43,43 0 0 1 7.0000011,50 43,43 0 0 1 50,7.000001 Z\\\"></path><path class=\\\"arm_1\\\" d=\\\"M 28.536809,28.536809 71.342023,71.342023\\\"></path><path class=\\\"arm_2\\\" d=\\\"M 71.342023,28.536809 28.536809,71.342023\\\"></path></svg>\",\r\n    special_success: \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"special-success\\\" viewBox=\\\"0 0 100 100\\\" width=\\\"100\\\" height=\\\"100\\\"><path class=\\\"circle\\\" d=\\\"M 50,7 A 43,43 0 0 1 93,50 43,43 0 0 1 50,93 43,43 0 0 1 7,50 43,43 0 0 1 50,7 Z\\\"></path><path class=\\\"arm\\\" d=\\\"M 22.988405,48.234784 36.946233,72.410453 75.516456,33.84023\\\"></path></svg>\",\r\n};\r\n\r\nexport const COLORS = ['red', 'green', 'blue', 'alpha']\r\n\r\nexport const CSS_APP_BACKGROUND_COLORS: CuiColorPair = {\r\n    light: '--cui-color-light-app-background',\r\n    dark: '--cui-color-dark-app-background'\r\n}\r\n\r\nexport const CSS_COMPONENT_BACKGROUND_COLORS: CuiColorPair = {\r\n    light: '--cui-color-light-background',\r\n    dark: '--cui-color-dark-background '\r\n}\r\n\r\nexport const CSS_COMPONENT_BORDER_COLORS: CuiColorPair = {\r\n    light: '--cui-color-light-border',\r\n    dark: '--cui-color-dark-border'\r\n}\r\n\r\nexport const CSS_THEMES = {\r\n    light: {\r\n        base: '--cui-color-light-base',\r\n        muted: '--cui-color-light-muted',\r\n        active: '--cui-color-light-active'\r\n    },\r\n    dark: {\r\n        base: '--cui-color-dark-base',\r\n        muted: '--cui-color-dark-muted',\r\n        active: '--cui-color-dark-active'\r\n    },\r\n    accent: {\r\n        base: '--cui-color-primary',\r\n        muted: '--cui-color-primary-muted',\r\n        active: '--cui-color-primary-active'\r\n    },\r\n    secondary: {\r\n        base: '--cui-color-secondary',\r\n        muted: '--cui-color-secondary-muted',\r\n        active: '--cui-color-secondary-active'\r\n    },\r\n    success: {\r\n        base: '--cui-color-success',\r\n        muted: '--cui-color-success-muted',\r\n        active: '--cui-color-success-active'\r\n    },\r\n    warning: {\r\n        base: '--cui-color-warning',\r\n        muted: '--cui-color-warning-muted',\r\n        active: '--cui-color-warning-active'\r\n    },\r\n    error: {\r\n        base: '--cui-color-error',\r\n        muted: '--cui-color-error-muted',\r\n        active: '--cui-color-error-active'\r\n    }\r\n}\r\n\r\nexport const CSS_VARIABLES: any = {\r\n    fontSize: \"--{prefix}-font-size\",\r\n    lineHeight: \"--{prefix}-line-height\",\r\n    animationTime: \"--{prefix}-animation-time\",\r\n    animationTimeLong: \"--{prefix}-animation-time-long\",\r\n    animationTimeShort: \"--{prefix}-animation-time-short\",\r\n    colorLightAppBackground: \"--{prefix}-color-light-app-background\",\r\n    colorLightBackground: \"--{prefix}-color-light-background\",\r\n    colorLightBorder: \"--{prefix}-color-light-border\",\r\n    colorLightBase: \"--{prefix}-color-light-base\",\r\n    colorLightActive: \"--{prefix}-color-light-active\",\r\n    colorLightMuted: \"--{prefix}-color-light-muted\",\r\n    colorDarkAppBackground: \"--{prefix}-color-dark-app-background\",\r\n    colorDarkBackground: \"--{prefix}-color-dark-background\",\r\n    colorDarkBorder: \"--{prefix}-color-dark-border\",\r\n    colorDarkBase: \"--{prefix}-color-dark-base\",\r\n    colorDarkActive: \"--{prefix}-color-dark-active\",\r\n    colorDarkMuted: \"--{prefix}-color-dark-muted\",\r\n    colorAccent: \"--{prefix}-color-primary\",\r\n    colorAccentActive: \"--{prefix}-color-primary-active\",\r\n    colorAccentMuted: \"--{prefix}-color-primary-muted\",\r\n    colorAccentShade: \"--{prefix}-color-primary-shade\",\r\n    colorAccentShadeDark: \"--{prefix}-color-primary-shade-dark\",\r\n    colorSecondary: \"--{prefix}-color-secondary\",\r\n    colorSecondaryActive: \"--{prefix}-color-secondary-active\",\r\n    colorSecondaryMuted: \"--{prefix}-color-secondary-muted\",\r\n    colorSecondaryShade: \"--{prefix}-color-secondary-shade\",\r\n    colorSecondaryShadeDark: \"--{prefix}-color-secondary-shade-dark\",\r\n    colorWarning: \"--{prefix}-color-warning\",\r\n    colorWarningActive: \"--{prefix}-color-warning-active\",\r\n    colorWarningMuted: \"--{prefix}-color-warning-muted\",\r\n    colorWarningShade: \"--{prefix}-color-warning-shade\",\r\n    colorWarningShadeDark: \"--{prefix}-color-warning-shade-dark\",\r\n    colorSuccess: \"--{prefix}-color-success\",\r\n    colorSuccessActive: \"--{prefix}-color-success-active\",\r\n    colorSuccessMuted: \"--{prefix}-color-success-muted\",\r\n    colorSuccessShade: \"--{prefix}-color-success-shade\",\r\n    colorSuccessShadeDark: \"--{prefix}-color-success-shade-dark\",\r\n    colorError: \"--{prefix}-color-error\",\r\n    colorErrorActive: \"--{prefix}-color-error-active\",\r\n    colorErrorMuted: \"--{prefix}-color-error-muted\",\r\n    colorErrorShade: \"--{prefix}-color-error-shade\",\r\n    colorErrorShadeDark: \"--{prefix}-color-error-shade-dark\",\r\n    inputBackground: \"--{prefix}-input-background-color\",\r\n    colorShade: \"--{prefix}-color-shade\",\r\n    colorShadeDarker: \"--{prefix}-color-shade-darker\",\r\n    colorShadeLight: \"--{prefix}-color-shade-light\",\r\n    colorShadeLighter: \"--{prefix}-color-shade-light-lighter\",\r\n    outline: \"--{prefix}-outline\",\r\n    borderRadius: \"--{prefix}-border-radius\",\r\n    padding: \"--{prefix}-padding\",\r\n    margin: \"--{prefix}-margin\",\r\n    scrollbarWidth: \"--{prefix}-scrollbar-width\",\r\n    componentSpace: \"--{prefix}-component-space\"\r\n}\r\n\r\n\r\nexport class STATICS {\r\n    static logLevel: CuiLogLevel = 'none';\r\n    static prefix: string = 'cui';\r\n}\r\n\r\nexport const EVENTS = {\r\n    INSTANCE_INITIALIZED: 'instance-initialized',\r\n    INSTANCE_FINISHED: 'instance-finished',\r\n    ON_RESIZE: \"resize\",\r\n    ON_OPEN: \"open\",\r\n    ON_CLOSE: \"close\",\r\n    ON_TOGGLE: \"toggle\",\r\n    ON_SCROLL: \"scroll\",\r\n    ON_TARGET_CHANGE: 'targetchange',\r\n    ON_INTERSECTION: 'intersection',\r\n    ON_KEYDOWN: 'keydown',\r\n    ON_SCROLLBY: 'scrollby'\r\n}\r\n\r\nexport const OBSERVABLE_SCROLL = \"SCROLL\";\r\nexport const OBSERVABLE_INTERSECTION = \"INTERSECTION\";\r\nexport const COMPONENTS_COUNTER = counter();","import { CuiLogLevel } from \"./types\";\r\nimport { ICuiLogger } from \"../models/interfaces\";\r\n\r\nexport class CuiLogger implements ICuiLogger {\r\n    level: CuiLogLevel\r\n    component: string;\r\n    id: string;\r\n    constructor(name: string, level: CuiLogLevel) {\r\n        this.level = level\r\n        this.component = name\r\n        this.id = \"-\";\r\n    }\r\n\r\n    setLevel(level: CuiLogLevel) {\r\n        this.level = level\r\n    }\r\n\r\n    setId(id: string) {\r\n        this.id = id\r\n    }\r\n    debug(message: string, functionName?: string): void {\r\n        if (this.level === 'debug') {\r\n            console.log(this.prepString(message, functionName))\r\n        }\r\n    }\r\n    error(message: string, functionName?: string): void {\r\n        if (this.level === 'error' || this.level === 'debug' || this.level === 'warning')\r\n            console.error(this.prepString(message, functionName))\r\n    }\r\n\r\n    warning(message: string, functionName?: string): void {\r\n        if (this.level === 'warning' || this.level === 'debug')\r\n            console.warn(this.prepString(message, functionName))\r\n    }\r\n\r\n    exception(e: Error, functionName?: string): void {\r\n        console.error(this.prepString(`An exception occured: ${e.name}: ${e.message}`, functionName))\r\n        if (this.level === 'debug')\r\n            console.exception(e.stack)\r\n    }\r\n\r\n    performance(callback: () => void, functionName?: string): void {\r\n        if (this.level !== 'debug') {\r\n            return;\r\n        }\r\n        let start = Date.now();\r\n        callback();\r\n        console.log(this.prepString(`Performance measure: ${Date.now() - start}ms`, functionName))\r\n    }\r\n\r\n    private prepString(message: string, functionName?: string) {\r\n        return `[${new Date().toLocaleString()}][${this.component}][${functionName ?? '-'}][${this.id}][${message}]`\r\n    }\r\n}","import { CuiLogger } from \"../utils/logger\";\r\nimport { CuiLogLevel } from \"../utils/types\";\r\nimport { ICuiLogger } from \"../models/interfaces\";\r\nimport { STATICS } from \"../utils/statics\";\r\n\r\n/**\r\n * \r\n */\r\nexport class CuiLoggerFactory {\r\n    /**\r\n     * Gets new instance of component focused logger\r\n     * @param name - component name\r\n     */\r\n    public static get(name: string, logLevel?: CuiLogLevel): ICuiLogger {\r\n        return new CuiLogger(name, logLevel ?? STATICS.logLevel)\r\n    }\r\n}","export class ErrorBase extends Error {\r\n    constructor(name: string, message?: string,) {\r\n        super(message);\r\n        Object.setPrototypeOf(this, new.target.prototype);\r\n        this.name = name;\r\n    }\r\n}\r\n\r\nexport class ItemNotFoundError extends ErrorBase {\r\n    constructor(message?: string) {\r\n        super(\"ItemNotFoundError\", message);\r\n    }\r\n}\r\n\r\nexport class ArgumentError extends ErrorBase {\r\n    constructor(message?: string) {\r\n        super(\"ArgumentError\", message);\r\n    }\r\n}\r\n\r\nexport class CuiBusError extends ErrorBase {\r\n    constructor(message?: string) {\r\n        super(\"ArgumentError\", message);\r\n    }\r\n}\r\n\r\nexport class CuiInstanceInitError extends ErrorBase {\r\n    constructor(message?: string) {\r\n        super(\"CuiInstanceInitError\", message);\r\n    }\r\n}\r\n\r\nexport class CuiScrollSpyOutOfRangeError extends ErrorBase {\r\n    constructor(message?: string) {\r\n        super(\"CuiScrollSpyOutOfRangeError\", message);\r\n    }\r\n}\r\n\r\n\r\nexport class RegisterElementError extends ErrorBase {\r\n    constructor(message?: string) {\r\n        super(\"RegisterElementError\", message);\r\n    }\r\n}\r\n","import { CuiLogLevel, CuiInteractionsType } from \"../utils/types\";\r\nimport { CuiColorSet } from \"./colors\";\r\n\r\ninterface CuiSetupCommon {\r\n    prefix?: string;\r\n    logLevel?: CuiLogLevel;\r\n    cacheSize?: number;\r\n    autoLightMode?: boolean;\r\n    animationTime?: number;\r\n    animationTimeShort?: number;\r\n    animationTimeLong?: number;\r\n    scrollThreshold?: number;\r\n    resizeThreshold?: number;\r\n}\r\n\r\nexport class CuiSetup implements CuiSetupCommon {\r\n    prefix?: string;\r\n    logLevel?: CuiLogLevel;\r\n    cacheSize?: number;\r\n    autoLightMode?: boolean;\r\n    animationTime?: number;\r\n    animationTimeShort?: number;\r\n    animationTimeLong?: number;\r\n    scrollThreshold: number;\r\n    resizeThreshold: number;\r\n    plugins: any;\r\n\r\n    constructor() {\r\n        this.autoLightMode = false;\r\n        this.scrollThreshold = 20;\r\n        this.resizeThreshold = 20;\r\n        this.plugins = {};\r\n    }\r\n\r\n    fromInit(init: CuiSetupInit): CuiSetup {\r\n        this.prefix = init.prefix;\r\n        this.logLevel = init.logLevel;\r\n        this.cacheSize = init.cacheSize;\r\n        this.autoLightMode = init.autoLightMode;\r\n        this.animationTime = init.animationTime;\r\n        this.animationTimeShort = init.animationTimeShort;\r\n        this.animationTimeLong = init.animationTimeLong;\r\n        this.scrollThreshold = init.scrollThreshold;\r\n        this.resizeThreshold = init.resizeThreshold;\r\n\r\n        return this;\r\n    }\r\n}\r\n\r\n\r\nexport class CuiSetupInit implements CuiSetupCommon {\r\n    prefix?: string;\r\n    app?: string;\r\n    interaction?: CuiInteractionsType;\r\n    logLevel?: CuiLogLevel;\r\n    cacheSize?: number;\r\n    autoLightMode?: boolean;\r\n    animationTime?: number;\r\n    animationTimeShort?: number;\r\n    animationTimeLong?: number;\r\n    scrollThreshold?: number;\r\n    resizeThreshold?: number;\r\n    root: HTMLElement;\r\n\r\n    constructor() {\r\n        this.prefix = 'cui';\r\n        this.app = '$cui';\r\n        this.logLevel = 'warning';\r\n        this.interaction = 'async';\r\n        this.animationTime = 300;\r\n        this.animationTimeShort = 150;\r\n        this.animationTimeLong = 500;\r\n        this.cacheSize = 500;\r\n        this.autoLightMode = false;\r\n        this.scrollThreshold = 20;\r\n        this.resizeThreshold = 20;\r\n        this.root = document.body;\r\n    }\r\n}","import { IUIInteractionProvider } from \"../models/interfaces\";\r\nimport { ICuiComponentAction } from \"../utils/actions\";\r\nimport { CLASSES } from \"../utils/statics\";\r\n\r\nexport class CuiActionsHelper {\r\n    #interactions: IUIInteractionProvider;\r\n    constructor(interactions: IUIInteractionProvider) {\r\n        this.#interactions = interactions;\r\n    }\r\n\r\n    async performAction(target: Element, action: ICuiComponentAction, timeout: number): Promise<boolean> {\r\n        return new Promise((resolve) => {\r\n            this.#interactions.mutate(() => {\r\n                action.add(target);\r\n                target.classList.add(CLASSES.animProgress);\r\n                setTimeout(() => {\r\n                    this.#interactions.mutate(() => {\r\n                        action.remove(target);\r\n                        target.classList.remove(CLASSES.animProgress);\r\n                        resolve(true)\r\n                    }, null)\r\n                }, timeout)\r\n            }, null)\r\n        })\r\n    }\r\n}","import { is, are } from \"./functions\";\r\nimport { CuiUtils } from \"../models/utils\";\r\n\r\nexport interface ICuiComponentAction {\r\n    add(element: Element, utils?: CuiUtils): void;\r\n    remove(element: Element, utils?: CuiUtils): void;\r\n    toggle(element: Element, utils?: CuiUtils): void;\r\n}\r\n\r\nexport class CuiClassAction implements ICuiComponentAction {\r\n    #class: string;\r\n\r\n    constructor(className: string) {\r\n        this.#class = className;\r\n    }\r\n\r\n    add(element: Element, utils?: CuiUtils): void {\r\n        if (are(element, this.#class) && !element.classList.contains(this.#class)) {\r\n            element.classList.add(this.#class);\r\n        }\r\n    }\r\n\r\n    remove(element: Element, utils?: CuiUtils): void {\r\n        if (are(element, this.#class) && element.classList.contains(this.#class)) {\r\n            element.classList.remove(this.#class);\r\n        }\r\n    }\r\n\r\n    toggle(element: Element, utils?: CuiUtils): void {\r\n        if (are(element, this.#class)) {\r\n            if (!element.classList.contains(this.#class)) {\r\n                element.classList.remove(this.#class);\r\n            } else {\r\n                element.classList.add(this.#class);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport class CuiInboundAction implements ICuiComponentAction {\r\n    #name: string;\r\n\r\n    constructor(name: string) {\r\n        this.#name = name;\r\n    }\r\n    add(element: Element, utils?: CuiUtils): void {\r\n        switch (this.#name) {\r\n            case 'dark-mode':\r\n                utils.setLightMode('dark')\r\n                break;\r\n            case 'light-mode':\r\n                utils.setLightMode('light')\r\n                break;\r\n        }\r\n    }\r\n\r\n    remove(element: Element, utils?: CuiUtils): void {\r\n        switch (this.#name) {\r\n            case 'dark-mode':\r\n                utils.setLightMode('light')\r\n                break;\r\n            case 'light-mode':\r\n                utils.setLightMode('dark')\r\n                break;\r\n        }\r\n    }\r\n\r\n    toggle(element: Element, utils?: CuiUtils): void {\r\n        switch (this.#name) {\r\n            case 'dark-mode':\r\n                this.setDarkMode(utils)\r\n                break;\r\n            case 'light-mode':\r\n                this.setDarkMode(utils)\r\n                break;\r\n        }\r\n    }\r\n\r\n    private setDarkMode(utils: CuiUtils) {\r\n        if (utils.getLightMode() === 'dark') {\r\n            utils.setLightMode('light')\r\n        } else {\r\n            utils.setLightMode('dark')\r\n        }\r\n    }\r\n}\r\n\r\nexport class DummyAction implements ICuiComponentAction {\r\n    constructor() {\r\n    }\r\n\r\n    add(element: Element, utils?: CuiUtils): void {\r\n\r\n    }\r\n\r\n    remove(element: Element, utils?: CuiUtils): void {\r\n    }\r\n\r\n    toggle(element: Element, utils?: CuiUtils): void {\r\n    }\r\n}\r\n\r\nexport class CuiActionsFatory {\r\n    public static get(value: string): ICuiComponentAction {\r\n        if (!is(value)) {\r\n            return new DummyAction();\r\n        }\r\n        let indicator = value[0];\r\n        switch (indicator) {\r\n            case '.':\r\n                return new CuiClassAction(value.substring(1));\r\n            case '~':\r\n                return new CuiInboundAction(value.substring(1))\r\n            default:\r\n                return new CuiClassAction(value);\r\n        }\r\n    }\r\n}","import { is, are } from \"../../core/utils/functions\";\r\nimport { ICuiLogger, IUIInteractionProvider, CuiCachable } from \"../../core/models/interfaces\";\r\nimport { CuiLoggerFactory } from \"../../core/factories/logger\";\r\nimport { CLASSES } from \"../../core/utils/statics\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { CuiActionsHelper } from \"../../core/helpers/helpers\";\r\nimport { CuiClassAction } from \"../../core/utils/actions\";\r\n\r\nexport class ElementManager implements CuiCachable {\r\n    #elements: Element[];\r\n    #isLocked: boolean;\r\n    #logger: ICuiLogger;\r\n    #cDt: number;\r\n    #utils: CuiUtils;\r\n    #actionsHelper: CuiActionsHelper;\r\n    constructor(elements: Element[], utils: CuiUtils) {\r\n        this.#elements = elements;\r\n        this.#isLocked = false;\r\n        this.#logger = CuiLoggerFactory.get(\"ElementManager\");\r\n        this.#utils = utils;\r\n        this.#cDt = Date.now();\r\n        this.#actionsHelper = new CuiActionsHelper(utils.interactions);\r\n    }\r\n\r\n    async toggleClass(className: string): Promise<boolean> {\r\n        if (!is(className)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            if (!element.classList.contains(className)) {\r\n                element.classList.add(className);\r\n            } else {\r\n                element.classList.remove(className);\r\n            }\r\n        }, 'toggleClass');\r\n    }\r\n\r\n    async toggleClassAs(className: string): Promise<boolean> {\r\n        if (!is(className)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            let classes = element.classList;\r\n            this.#utils.interactions.fetch(() => {\r\n                if (!classes.contains(className)) {\r\n                    this.#utils.interactions.mutate(classes.add, classes, className);\r\n                } else {\r\n                    this.#utils.interactions.mutate(classes.remove, classes, className);\r\n                }\r\n            }, this)\r\n\r\n        }, 'toggleClassAs');\r\n    }\r\n\r\n    async setClass(className: string): Promise<boolean> {\r\n        if (!is(className)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            if (!element.classList.contains(className)) {\r\n                element.classList.add(className)\r\n            }\r\n        }, 'setClass');\r\n    }\r\n\r\n    async setClassAs(className: string): Promise<boolean> {\r\n        if (!is(className)) {\r\n            return false;\r\n        }\r\n\r\n        return this.call((element) => {\r\n            let classes = element.classList;\r\n            this.#utils.interactions.fetch(() => {\r\n                if (!classes.contains(className)) {\r\n                    this.#utils.interactions.mutate(classes.add, classes, className);\r\n                }\r\n            }, this)\r\n\r\n        }, 'setClassAs');\r\n    }\r\n\r\n    async removeClass(className: string): Promise<boolean> {\r\n        if (!is(className)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            if (element.classList.contains(className)) {\r\n                element.classList.remove(className)\r\n            }\r\n        }, 'removeClass');\r\n    }\r\n\r\n    async removeClassAs(className: string): Promise<boolean> {\r\n        if (!is(className)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            let classes = element.classList;\r\n            this.#utils.interactions.fetch(() => {\r\n                if (classes.contains(className)) {\r\n                    this.#utils.interactions.mutate(classes.remove, classes, className);\r\n                }\r\n            }, this)\r\n        }, 'removeClass');\r\n    }\r\n\r\n    getAttribute(attributeName: string): string[] {\r\n        if (!is(attributeName)) {\r\n            return null;\r\n        }\r\n        return this.#elements.reduce<string[]>((val: string[], current: Element) => {\r\n            if (current.hasAttribute(attributeName)) {\r\n                val.push(current.getAttribute(attributeName))\r\n            } else {\r\n                val.push(null);\r\n            }\r\n            return val;\r\n        }, []);\r\n    }\r\n\r\n    async setAttribute(attributeName: string, attributeValue?: string): Promise<boolean> {\r\n        if (!is(attributeName)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            element.setAttribute(attributeName, attributeValue ?? \"\")\r\n        }, 'setAttribute');\r\n    }\r\n\r\n    async setAttributeAs(attributeName: string, attributeValue?: string): Promise<boolean> {\r\n        if (!is(attributeName)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            this.#utils.interactions.mutate(element.setAttribute, element, attributeName, attributeValue ?? \"\")\r\n        }, 'setAttributeAs');\r\n    }\r\n\r\n    async removeAttribute(attributeName: string): Promise<boolean> {\r\n        if (!is(attributeName)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            element.removeAttribute(attributeName)\r\n        }, 'removeAttribute');\r\n    }\r\n\r\n    async removeAttributeAs(attributeName: string): Promise<boolean> {\r\n        if (!is(attributeName)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            this.#utils.interactions.mutate(element.removeAttribute, element, attributeName);\r\n        }, 'removeAttributeAs');\r\n    }\r\n\r\n    async toggleAttribute(attributeName: string, attributeValue?: string): Promise<boolean> {\r\n        if (!is(attributeName)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            if (element.hasAttribute(attributeName)) {\r\n                element.removeAttribute(attributeName)\r\n            } else {\r\n                element.setAttribute(attributeName, attributeValue ?? \"\")\r\n            }\r\n        }, 'toggleAttribute');\r\n    }\r\n\r\n    async toggleAttributeAs(attributeName: string, attributeValue?: string): Promise<boolean> {\r\n        if (!is(attributeName)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            this.#utils.interactions.fetch(() => {\r\n                if (element.hasAttribute(attributeName)) {\r\n                    this.#utils.interactions.mutate(element.removeAttribute, element, attributeName);\r\n                } else {\r\n                    this.#utils.interactions.mutate(element.setAttribute, element, attributeName, attributeValue ?? \"\")\r\n                }\r\n            }, this)\r\n\r\n        }, 'toggleAttributeAs');\r\n    }\r\n\r\n    async click(onClick: (ev: MouseEvent) => void): Promise<boolean> {\r\n        if (!is(onClick)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            element.addEventListener('click', onClick);\r\n        }, 'click');\r\n    }\r\n\r\n    async event(eventName: string, callback: any): Promise<boolean> {\r\n        if (!is(eventName) || !is(callback)) {\r\n            return false;\r\n        }\r\n        return this.call((element) => {\r\n            element.addEventListener(eventName, callback);\r\n        }, 'event');\r\n    }\r\n\r\n    async call(callback: (element: Element, index: Number) => void, functionName?: string): Promise<boolean> {\r\n        if (this.#isLocked) {\r\n            this.#logger.error(\"Element is locked\", functionName)\r\n        }\r\n        this.lock();\r\n        this.#elements.forEach((element, index) => {\r\n            callback(element, index)\r\n        })\r\n        this.unlock();\r\n        return true;\r\n    }\r\n\r\n    async animate(className: string, timeout?: number): Promise<boolean> {\r\n        if (!is(className)) {\r\n            return false;\r\n        }\r\n        const delay = timeout ?? this.#utils.setup.animationTime;\r\n        return this.call((element) => {\r\n            this.change(() => {\r\n                element.classList.add(className);\r\n                element.classList.add(CLASSES.animProgress);\r\n                setTimeout(() => {\r\n                    this.change(() => {\r\n                        element.classList.remove(className);\r\n                        element.classList.remove(CLASSES.animProgress);\r\n                    })\r\n                }, delay)\r\n            })\r\n        });\r\n    }\r\n\r\n    async open(openClass: string, animationClass: string, timeout?: number): Promise<boolean> {\r\n        if (!are(openClass, animationClass)) {\r\n            return false\r\n        }\r\n        const delay = timeout ?? this.#utils.setup.animationTime;\r\n        const action = new CuiClassAction(animationClass);\r\n        return this.call((element) => {\r\n            this.#actionsHelper.performAction(element, action, delay).then(() => {\r\n                element.classList.add(openClass);\r\n            })\r\n        });\r\n    }\r\n\r\n    async close(closeClass: string, animationClass: string, timeout?: number): Promise<boolean> {\r\n        if (!are(closeClass, animationClass)) {\r\n            return false\r\n        }\r\n        const delay = timeout ?? this.#utils.setup.animationTime;\r\n        const action = new CuiClassAction(animationClass);\r\n        return this.call((element) => {\r\n            this.#actionsHelper.performAction(element, action, delay).then(() => {\r\n                element.classList.remove(closeClass);\r\n            })\r\n        });\r\n    }\r\n\r\n    read(callback: any, ...args: any[]): void {\r\n        this.#utils.interactions.fetch(callback, this, ...args)\r\n    }\r\n\r\n    change(callback: any, ...args: any[]): void {\r\n        this.#utils.interactions.mutate(callback, this, ...args)\r\n    }\r\n\r\n    elements(): Element[] {\r\n        return this.#elements;\r\n    }\r\n\r\n    count() {\r\n        return this.#elements.length;\r\n    }\r\n\r\n    lock() {\r\n        this.#isLocked = true;\r\n    }\r\n\r\n    unlock() {\r\n        this.#isLocked = false;\r\n    }\r\n\r\n    isLocked(): boolean {\r\n        return this.#isLocked;\r\n    }\r\n\r\n    refresh(): boolean {\r\n        return (Date.now() - this.#cDt) < 360000;\r\n    }\r\n}","import { ICuiLogger, IUIInteractionProvider, ICuiMutiationPlugin, ICuiComponent, ICuiPluginManager, CuiElement } from \"../../core/models/interfaces\";\r\nimport { CuiLoggerFactory } from \"../../core/factories/logger\";\r\nimport { is, getMatchingAttribute, are, getMatchingAttributes, generateCUID, registerCuiElement, joinAttributesForQuery, parseAttribute } from \"../../core/utils/functions\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\n\r\nexport interface ICuiMutionObserver {\r\n    // setOptions(options: MutationObserverInit): ICuiMutionObserver;\r\n    setPlugins(plugins: ICuiPluginManager): ICuiMutionObserver;\r\n    setComponents(components: ICuiComponent[]): ICuiMutionObserver;\r\n    setAttributes(attributes: string[]): ICuiMutionObserver;\r\n    start(): ICuiMutionObserver;\r\n    stop(): ICuiMutionObserver;\r\n}\r\n\r\n\r\nexport class CuiMutationObserver implements ICuiMutionObserver {\r\n    _log: ICuiLogger;\r\n    #observer: MutationObserver;\r\n    #options: MutationObserverInit;\r\n    #element: HTMLElement;\r\n    plugins: ICuiPluginManager;\r\n    #components: ICuiComponent[];\r\n    #attributes: string[];\r\n    #utils: CuiUtils;\r\n    #queryString: string;\r\n    constructor(element: HTMLElement, utils: CuiUtils) {\r\n        this.#observer = null\r\n        this.#element = element\r\n        this._log = CuiLoggerFactory.get('CuiMutationObserver')\r\n        this.plugins = null;\r\n        this.#components = [];\r\n        this.#attributes = [];\r\n        this.#utils = utils;\r\n        this.#queryString = \"\";\r\n\r\n    }\r\n\r\n    setPlugins(plugins: ICuiPluginManager) {\r\n        this.plugins = plugins;\r\n        return this;\r\n    }\r\n\r\n    setComponents(components: ICuiComponent[]) {\r\n        this.#components = components;\r\n        return this;\r\n    }\r\n\r\n    setAttributes(attributes: string[]) {\r\n        this.#options = {\r\n            attributes: true,\r\n            subtree: true,\r\n            childList: true,\r\n            attributeFilter: attributes\r\n        }\r\n        this.#attributes = attributes;\r\n        this.#queryString = joinAttributesForQuery(attributes);\r\n        return this;\r\n    }\r\n\r\n    start() {\r\n        this._log.debug(\"Starting\")\r\n        this.#observer = new MutationObserver(this.mutationCallback.bind(this));\r\n        this.#observer.observe(this.#element, this.#options)\r\n        this._log.debug(\"Started\")\r\n        return this;\r\n    }\r\n\r\n    stop() {\r\n        this._log.debug(\"Stopping\")\r\n        if (this.#observer !== null)\r\n            this._log.debug(\"Observer available\")\r\n        this.#observer.disconnect()\r\n        this.#observer = null;\r\n        this._log.debug(\"Stopped\")\r\n        return this\r\n    }\r\n\r\n    private mutationCallback(mutations: MutationRecord[], observer: MutationObserver) {\r\n        mutations.forEach((mutation: MutationRecord) => {\r\n            switch (mutation.type) {\r\n                case 'attributes':\r\n                    const item = mutation.target as any;\r\n                    if (are(item.$handlers, item.$handlers[mutation.attributeName])) {\r\n                        item.$handlers[mutation.attributeName].refresh(parseAttribute(item, mutation.attributeName));\r\n                    }\r\n                    break;\r\n\r\n                case 'childList':\r\n                    this.handleChildListMutation(mutation);\r\n                    break;\r\n            }\r\n            if (is(this.plugins)) {\r\n                this.plugins.onMutation(mutation).then(() => {\r\n                    //\r\n                })\r\n            }\r\n        })\r\n    }\r\n\r\n    private handleChildListMutation(mutation: MutationRecord) {\r\n        const addedLen = mutation.addedNodes.length;\r\n        const removedLen = mutation.removedNodes.length;\r\n        if (addedLen > 0) {\r\n            this._log.debug(\"Registering added nodes: \" + addedLen)\r\n            this.handleAddedNodes(mutation.addedNodes);\r\n        } else if (removedLen > 0) {\r\n            this._log.debug(\"Removing nodes: \" + removedLen);\r\n            this.handleRemovedNodes(mutation.removedNodes);\r\n        }\r\n    }\r\n\r\n    private handleAddedNodes(nodes: NodeList) {\r\n        nodes.forEach((node: any) => {\r\n            try {\r\n                registerCuiElement(node, this.#components, this.#attributes, this.#utils);\r\n                let childrens = node.hasChildNodes() ? node.querySelectorAll(this.#queryString) : null;\r\n                if (is(childrens)) {\r\n                    childrens.forEach((child: any) => {\r\n                        registerCuiElement(child, this.#components, this.#attributes, this.#utils);\r\n                    })\r\n                }\r\n            } catch (e) {\r\n                this._log.exception(e);\r\n            }\r\n        })\r\n    }\r\n\r\n    private handleRemovedNodes(nodes: NodeList) {\r\n        nodes.forEach((node: any) => {\r\n            this.destroySingleElement(node);\r\n            let childrens = node.hasChildNodes() ? node.querySelectorAll(this.#queryString) : null;\r\n            if (is(childrens)) {\r\n                childrens.forEach((child: any) => {\r\n                    this.destroySingleElement(child);\r\n                })\r\n            }\r\n        })\r\n    }\r\n\r\n    private destroySingleElement(node: any) {\r\n        let element = node as CuiElement;\r\n        if (element.$handlers) {\r\n            for (let name in element.$handlers) {\r\n                if (element.$handlers.hasOwnProperty(name)) {\r\n                    try {\r\n                        element.$handlers[name].destroy();\r\n                    } catch (e) {\r\n                        this._log.exception(e, 'remove - ' + name)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","import { IUIInteractionProvider } from \"../../core/models/interfaces\";\r\nimport { is, sleep } from \"../../core/utils/functions\";\r\nimport { CLASSES } from \"../../core/utils/statics\";\r\n\r\nexport class CuiToastHandler {\r\n    #interactions: IUIInteractionProvider;\r\n    #selector: string;\r\n    #className: string;\r\n    #activeCls: string;\r\n    #animationTime: number;\r\n    #lock: boolean;\r\n    #animClsIn: string;\r\n    #animClsOut: string;\r\n    constructor(interaction: IUIInteractionProvider, prefix: string, animationTime: number) {\r\n        this.#interactions = interaction;\r\n        this.#selector = `.${prefix}-toast`;\r\n        this.#className = `${prefix}-toast`;\r\n        this.#activeCls = `${prefix}-active`;\r\n        this.#animationTime = animationTime;\r\n        this.#lock = false;\r\n        this.#animClsIn = `${prefix}-toast-animation-in`;\r\n        this.#animClsOut = `${prefix}-toast-animation-out`\r\n    }\r\n\r\n    async show(message: string): Promise<boolean> {\r\n        if (this.#lock) {\r\n            return false;\r\n        }\r\n        this.#lock = true;\r\n        let toastElement = document.querySelector(this.#selector);\r\n        if (!is(toastElement)) {\r\n            toastElement = document.createElement('div');\r\n            toastElement.classList.add(this.#className);\r\n            document.body.appendChild(toastElement);\r\n        }\r\n\r\n        this.#interactions.mutate(() => {\r\n            toastElement.innerHTML = message;\r\n            toastElement.classList.add(CLASSES.animProgress);\r\n            toastElement.classList.add(this.#animClsIn);\r\n        }, this);\r\n\r\n        await sleep(this.#animationTime);\r\n        this.#interactions.mutate(() => {\r\n            toastElement.classList.remove(CLASSES.animProgress);\r\n            toastElement.classList.remove(this.#animClsIn);\r\n            toastElement.classList.add(this.#activeCls);\r\n        }, this)\r\n        await sleep(3000);\r\n        this.#interactions.mutate(() => {\r\n            toastElement.classList.add(CLASSES.animProgress);\r\n            toastElement.classList.add(this.#animClsOut);\r\n        }, this)\r\n\r\n        setTimeout(() => {\r\n            this.#interactions.mutate(() => {\r\n                toastElement.classList.remove(CLASSES.animProgress);\r\n                toastElement.classList.remove(this.#animClsOut);\r\n                toastElement.classList.remove(this.#activeCls);\r\n            }, this)\r\n            this.#lock = false;\r\n        }, this.#animationTime);\r\n        return true;\r\n    }\r\n}","import { CLASSES } from \"../../core/utils/statics\";\r\nimport { ICuiLogger, IUIInteractionProvider } from \"../../core/models/interfaces\";\r\nimport { CuiLoggerFactory } from \"../../core/factories/logger\";\r\nimport { is } from \"../../core/utils/functions\";\r\n\r\nexport class CollectionManagerHelper {\r\n    #elements: Element[];\r\n    #log: ICuiLogger;\r\n    #isLocked: boolean;\r\n    #toggleClass: string;\r\n    #interactions: IUIInteractionProvider;\r\n    constructor(interactions: IUIInteractionProvider) {\r\n        this.#interactions = interactions;\r\n        this.#log = CuiLoggerFactory.get('CollectionManager');\r\n    }\r\n\r\n    setElements(elements: Element[]) {\r\n        this.#elements = elements;\r\n    }\r\n\r\n    setToggle(className: string) {\r\n        this.#toggleClass = className;\r\n    }\r\n\r\n    addAnimationClass(currentElement: Element, nextElement: Element, animIn: string, animOut: string,): void {\r\n        nextElement.classList.add(CLASSES.animProgress);\r\n        currentElement.classList.add(animOut);\r\n        nextElement.classList.add(animIn);\r\n    }\r\n\r\n    setFinalClasses(currentElement: Element, nextElement: Element, animIn: string, animOut: string): void {\r\n        nextElement.classList.remove(CLASSES.animProgress);\r\n        currentElement.classList.remove(animOut);\r\n        nextElement.classList.remove(animIn);\r\n        currentElement.classList.remove(this.#toggleClass);\r\n        nextElement.classList.add(this.#toggleClass);\r\n    }\r\n\r\n    verifyIndex(index: number, current: number, count: number): boolean {\r\n        return index >= 0 && index !== current && index < count\r\n    }\r\n\r\n    async setCurrent(newIndex: number, current: number): Promise<boolean> {\r\n        this.lock();\r\n        this.#log.debug(`Switching index from: ${current} to ${newIndex}`)\r\n        if (current > -1)\r\n            this.#elements[current].classList.remove(this.#toggleClass);\r\n        this.#elements[newIndex].classList.add(this.#toggleClass);\r\n        this.unlock();\r\n        return true;\r\n    }\r\n\r\n    async setCurrentWithAnimation(newIndex: number, animClassIn: string, animClassOut: string, duration: number, current: number): Promise<boolean> {\r\n        this.lock()\r\n        this.#log.debug(`Switching index from: ${current} to ${newIndex}`)\r\n\r\n        const currentElement = this.#elements[current];\r\n        const nextElement = this.#elements[newIndex];\r\n        this.#interactions.mutate(this.addAnimationClass, this, currentElement, nextElement, animClassIn, animClassOut);\r\n        setTimeout(() => {\r\n            this.#interactions.mutate(this.setFinalClasses, this, currentElement, nextElement, animClassIn, animClassOut)\r\n            this.unlock();\r\n        }, duration)\r\n        return true;\r\n    }\r\n\r\n    getCurrentIndex(): number {\r\n        if (!is(this.#toggleClass)) {\r\n            return -1;\r\n        }\r\n        let len = this.count();\r\n        for (let i = 0; i < len; i++) {\r\n            if (this.#elements[i].classList.contains(this.#toggleClass)) {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n\r\n    elements(): Element[] {\r\n        return this.#elements;\r\n    }\r\n\r\n    check(): boolean {\r\n        if (this.#isLocked) {\r\n            this.#log.warning(\"Object locked. Operation in progress\", \"Check\");\r\n            return false;\r\n        } else if (!is(this.#toggleClass)) {\r\n            this.#log.warning(\"Toggle is not set. Call setToggleClass\", \"Check\");\r\n            return false;\r\n        } else if (this.count() <= 0) {\r\n            this.#log.warning(\"Elements list is empty\", \"Check\");\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    count(): number {\r\n        return this.#elements ? this.#elements.length : -1;\r\n    }\r\n\r\n    lock() {\r\n        this.#isLocked = true;\r\n    }\r\n\r\n    unlock() {\r\n        this.#isLocked = false\r\n    }\r\n\r\n\r\n}","import { IUIInteractionProvider, ICuiLogger, CuiCachable } from \"../../core/models/interfaces\";\r\nimport { CuiLoggerFactory } from \"../../core/factories/logger\";\r\nimport { CollectionManagerHelper } from \"../helpers/collection\";\r\n\r\nexport class CollectionManager implements CuiCachable {\r\n    #log: ICuiLogger;\r\n\r\n    #cDt: number;\r\n    #helper: CollectionManagerHelper;\r\n\r\n    constructor(elements: Element[], interactions: IUIInteractionProvider) {\r\n        this.#log = CuiLoggerFactory.get('CollectionManager');\r\n        this.#helper = new CollectionManagerHelper(interactions);\r\n        this.#helper.setElements(elements);\r\n        this.#cDt = Date.now();\r\n    }\r\n\r\n    setToggle(className: string) {\r\n        this.#helper.setToggle(className)\r\n    }\r\n\r\n    setElements(elements: Element[]) {\r\n        this.#helper.setElements(elements);\r\n    }\r\n\r\n    click(callback: (element: Element, index: number) => void): void {\r\n        this.#helper.elements().forEach((element, index) => {\r\n            element.addEventListener('click', () => {\r\n                this.set(index).then(() => {\r\n                    if (callback) {\r\n                        callback(element, index)\r\n                    }\r\n                })\r\n            })\r\n        })\r\n    }\r\n\r\n    async next(): Promise<boolean> {\r\n        if (!this.#helper.check()) {\r\n            return false;\r\n        }\r\n        let newIdx = this.#helper.getCurrentIndex() + 1;\r\n        return this.set(newIdx >= this.length() ? 0 : newIdx);\r\n    }\r\n\r\n    async previous(): Promise<boolean> {\r\n        if (!this.#helper.check()) {\r\n            return false;\r\n        }\r\n        let newIdx = this.#helper.getCurrentIndex() - 1;\r\n        return this.set(newIdx < 0 ? this.length() - 1 : newIdx)\r\n    }\r\n\r\n    async set(index: number): Promise<boolean> {\r\n        let current = this.#helper.getCurrentIndex();\r\n        if (!this.#helper.check() || !this.#helper.verifyIndex(index, current, this.length())) {\r\n            return false;\r\n        }\r\n        return this.#helper.setCurrent(index, current)\r\n    }\r\n\r\n    async setWithAnimation(index: number, animClassIn: string, animClassOut: string, duration: number): Promise<boolean> {\r\n        let current = this.#helper.getCurrentIndex();\r\n        if (!this.#helper.check() || !this.#helper.verifyIndex(index, current, this.length())) {\r\n            return false;\r\n        }\r\n        return this.#helper.setCurrentWithAnimation(index, animClassIn, animClassOut, duration, current)\r\n    }\r\n\r\n    getCurrentIndex(): number {\r\n        return this.#helper.getCurrentIndex();\r\n    }\r\n\r\n    length() {\r\n        return this.#helper.count();\r\n    }\r\n\r\n    refresh(): boolean {\r\n        return this.length() > 0 && Date.now() - this.#cDt > 360000;\r\n    }\r\n}","import { ICuiPluginManager, ICuiPlugin, ICuiLogger, ICuiMutiationPlugin } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { CuiLoggerFactory } from \"../../core/factories/logger\";\r\nimport { is } from \"../../core/utils/functions\";\r\n\r\nexport class CuiPluginManager implements ICuiPluginManager {\r\n    #plugins: ICuiPlugin[];\r\n    #mutated: ICuiMutiationPlugin[];\r\n    #log: ICuiLogger;\r\n    constructor(plugins: ICuiPlugin[]) {\r\n        this.#plugins = plugins ?? [];\r\n        this.#log = CuiLoggerFactory.get(\"CuiPluginManager\")\r\n    }\r\n\r\n    init(utils: CuiUtils): void {\r\n        this.#log.debug(\"Plugins initialization started: \" + this.#plugins.length)\r\n        this.#mutated = this.#plugins.filter((plugin: any) => {\r\n            return is(plugin.mutation);\r\n        }) as any;\r\n        this.#plugins.forEach(plugin => {\r\n            plugin.init(utils);\r\n            utils.setup.plugins[plugin.description] = plugin.setup;\r\n        })\r\n        this.#log.debug(\"Plugins have been initialized\");\r\n    }\r\n\r\n    get(name: string): ICuiPlugin {\r\n        if (!is(name)) {\r\n            return undefined;\r\n        }\r\n        return this.#plugins.find(p => p.name === name);\r\n    }\r\n\r\n    async onMutation(mutation: MutationRecord): Promise<boolean> {\r\n        let tasks: Promise<boolean>[] = [];\r\n        this.#mutated.forEach((plugin: any) => {\r\n            tasks.push(plugin.mutation(mutation))\r\n        })\r\n        let result: boolean[] = await Promise.all(tasks);\r\n        return result.find(val => {\r\n            val === false\r\n        }) ? false : true;\r\n    }\r\n\r\n}","import { CuiSetupInit } from \"../core/models/setup\";\r\nimport { is, joinAttributesForQuery, are, registerCuiElement } from \"../core/utils/functions\";\r\nimport { ElementManager } from \"./managers/element\";\r\nimport { STATICS, EVENTS, CSS_VARIABLES } from \"../core/utils/statics\";\r\nimport { ICuiLogger, ICuiPlugin, ICuiComponent, ICuiPluginManager, CuiContext, CuiElement } from \"../core/models/interfaces\";\r\nimport { ICuiMutionObserver, CuiMutationObserver } from \"./observers/mutations\";\r\nimport { CuiLoggerFactory } from \"../core/factories/logger\";\r\nimport { CuiToastHandler } from \"./managers/toast\";\r\nimport { CollectionManager } from \"./managers/collection\";\r\nimport { CuiUtils } from \"../core/models/utils\";\r\nimport { CuiInstanceInitError } from \"../core/models/errors\";\r\nimport { CuiPluginManager } from \"./managers/plugins\";\r\n\r\n\r\nexport class CuiInstance {\r\n    #log: ICuiLogger;\r\n    #mutationObserver: ICuiMutionObserver;\r\n    #toastManager: CuiToastHandler;\r\n    #utils: CuiUtils;\r\n    plugins: ICuiPluginManager;\r\n    #components: ICuiComponent[];\r\n    #rootElement: HTMLElement;\r\n    constructor(setup: CuiSetupInit, plugins: ICuiPlugin[], components: ICuiComponent[]) {\r\n        STATICS.prefix = setup.prefix;\r\n        STATICS.logLevel = setup.logLevel;\r\n        this.plugins = new CuiPluginManager(plugins);\r\n        this.#components = components ?? [];\r\n        this.#utils = new CuiUtils(setup);\r\n        this.#log = CuiLoggerFactory.get('CuiInstance')\r\n        this.#rootElement = setup.root;\r\n    }\r\n\r\n    init(): CuiInstance {\r\n        this.#log.debug(\"Instance started\", \"init\")\r\n        // Init elements\r\n        if (!is(window.MutationObserver)) {\r\n            throw new CuiInstanceInitError(\"Mutation observer does not exists\");\r\n        }\r\n        this.#toastManager = new CuiToastHandler(this.#utils.interactions, this.#utils.setup.prefix, this.#utils.setup.animationTimeLong);\r\n        const mutatedAttributes: string[] = this.#components.map(x => { return x.attribute }); // MUTATED_ATTRIBUTES; \r\n        const initElements = is(mutatedAttributes) ? this.#rootElement.querySelectorAll(joinAttributesForQuery(mutatedAttributes)) : null\r\n        if (is(initElements)) {\r\n            this.#log.debug(`Initiating ${initElements.length} elements`)\r\n            try {\r\n                initElements.forEach((item: any) => {\r\n                    registerCuiElement(item, this.#components, mutatedAttributes, this.#utils);\r\n                })\r\n            } catch (e) {\r\n                this.#log.exception(e);\r\n            }\r\n        }\r\n        this.#log.debug(\"Init plugins\", \"init\")\r\n        // Init plugins\r\n        this.plugins.init(this.#utils);\r\n\r\n        if (are(this.#components, mutatedAttributes)) {\r\n            this.#log.debug(\"Init mutation observer\", \"init\")\r\n            this.#mutationObserver = new CuiMutationObserver(this.#rootElement, this.#utils)\r\n            this.#mutationObserver.setComponents(this.#components).setAttributes(mutatedAttributes)\r\n            this.#mutationObserver.setPlugins(this.plugins);\r\n            this.#mutationObserver.start();\r\n        }\r\n\r\n        this.#log.debug(\"Setting CSS globals\", 'init')\r\n        this.#utils.interactions.mutate(() => {\r\n            this.#utils.setProperty(CSS_VARIABLES.animationTimeLong, `${this.#utils.setup.animationTimeLong}ms`)\r\n            this.#utils.setProperty(CSS_VARIABLES.animationTime, `${this.#utils.setup.animationTime}ms`);\r\n            this.#utils.setProperty(CSS_VARIABLES.animationTimeShort, `${this.#utils.setup.animationTimeShort}ms`);\r\n        }, null)\r\n\r\n\r\n        this.#utils.bus.emit(EVENTS.INSTANCE_INITIALIZED, null)\r\n        return this;\r\n    }\r\n\r\n    finish(): void {\r\n        this.#mutationObserver.stop();\r\n        this.#utils.bus.emit(EVENTS.INSTANCE_FINISHED, null)\r\n    }\r\n\r\n    get(selector: string): ElementManager {\r\n        const existing = this.#utils.cache.get(selector);\r\n        if (is(existing)) {\r\n            return existing as ElementManager;\r\n        }\r\n        const elements = this.all(selector);\r\n        if (!elements) {\r\n            return undefined\r\n        }\r\n        const newElement = new ElementManager(elements, this.#utils);\r\n        this.#utils.cache.put(selector, newElement)\r\n        return newElement\r\n    }\r\n\r\n    collection(selector: string): CollectionManager {\r\n        const existing = this.#utils.cache.get(selector);\r\n        if (is(existing)) {\r\n            return existing as CollectionManager;\r\n        }\r\n        const elements = this.all(selector);\r\n        if (!is(elements)) {\r\n            return undefined;\r\n        }\r\n        let manager = new CollectionManager(elements, this.#utils.interactions);\r\n        this.#utils.cache.put(selector, manager)\r\n        return manager;\r\n    }\r\n\r\n\r\n    async toast(message: string): Promise<boolean> {\r\n        if (!is(message)) {\r\n            return false;\r\n        }\r\n        return this.#toastManager.show(message)\r\n    }\r\n\r\n    select(selector: string): Element {\r\n        return document.querySelector(selector)\r\n    }\r\n\r\n    all(selector: string): Element[] {\r\n        const nodes: NodeListOf<Element> = document.querySelectorAll(selector);\r\n        if (!is(nodes)) {\r\n            return undefined;\r\n        }\r\n        return [...nodes];\r\n    }\r\n\r\n    getUtils(): CuiUtils {\r\n        return this.#utils;\r\n    }\r\n\r\n    on(event: string, callback: any, context: CuiContext, element?: CuiElement): void {\r\n        if (!are(event, callback)) {\r\n            this.#log.error(\"Incorrect arguments\", \"on\")\r\n        }\r\n        this.#utils.bus.on(event, callback, context, element);\r\n    }\r\n}","import { ICuiEventListener } from \"../models/interfaces\";\r\n\r\nexport class CuiMediaQueryListener implements ICuiEventListener<MediaQueryListEvent> {\r\n\r\n    #mediaQuery: string;\r\n    #callback: (t: MediaQueryListEvent) => void;\r\n    #isInitialized: boolean;\r\n    #inProgress: boolean;\r\n    constructor(mediaQuery: string) {\r\n        this.#mediaQuery = mediaQuery;\r\n        this.#isInitialized = false;\r\n    }\r\n    setCallback(callback: (t: MediaQueryListEvent) => void): void {\r\n        this.#callback = callback;\r\n    }\r\n\r\n    isInProgress(): boolean {\r\n        return this.#inProgress;\r\n    }\r\n    attach(): void {\r\n        if (!window.matchMedia || this.#isInitialized || !this.#mediaQuery) {\r\n            return;\r\n        }\r\n        window.matchMedia(this.#mediaQuery)\r\n            .addEventListener('change', this.event.bind(this))\r\n        this.#isInitialized = true\r\n    }\r\n\r\n    detach(): void {\r\n        if (this.#isInitialized) {\r\n            window.matchMedia(this.#mediaQuery).removeEventListener('change', this.event.bind(this));\r\n            this.#isInitialized = false\r\n        }\r\n    }\r\n\r\n\r\n    private event(ev: MediaQueryListEvent): void {\r\n        if (this.#inProgress) {\r\n            return\r\n        }\r\n        this.#inProgress = true;\r\n        try {\r\n            this.#callback(ev);\r\n        } catch (e) {\r\n            console.error(e)\r\n        } finally {\r\n            this.#inProgress = false;\r\n        }\r\n    }\r\n}","import { ICuiPlugin } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { getSystemLightMode } from \"../../core/utils/functions\";\r\nimport { CuiMediaQueryListener } from \"../../core/listeners/media\";\r\n\r\nexport interface AutoLightPluginSetup {\r\n    autoLight: boolean;\r\n}\r\n\r\nexport class CuiAutoLightModePlugin implements ICuiPlugin {\r\n    description: string = 'Dark vs Light mode auto switcher';\r\n    name: string = 'auto-light';\r\n    setup: AutoLightPluginSetup;\r\n    #listener: CuiMediaQueryListener;\r\n    #utils: CuiUtils;\r\n    constructor(autoLightInit: AutoLightPluginSetup) {\r\n        this.description = \"CuiAutoLightModePlugin\";\r\n        this.setup = autoLightInit;\r\n    }\r\n\r\n    init(utils: CuiUtils): void {\r\n        this.#utils = utils\r\n        if (this.setup.autoLight && getSystemLightMode() === 'dark') {\r\n            this.#utils.setLightMode('dark')\r\n        }\r\n        this.#listener = new CuiMediaQueryListener('(prefers-color-scheme: dark)')\r\n        this.#listener.setCallback(this.onChange.bind(this))\r\n        this.#listener.attach();\r\n    }\r\n\r\n    destroy(): void {\r\n        this.#listener.detach();\r\n    }\r\n\r\n    onChange(ev: MediaQueryListEvent) {\r\n        let autoLightSetup = this.#utils.setup.plugins[this.description] as AutoLightPluginSetup;\r\n        let autoLight = autoLightSetup?.autoLight ?? false;\r\n        if (autoLight) {\r\n            if (ev.matches) {\r\n                this.#utils.setLightMode('dark')\r\n            } else {\r\n                this.#utils.setLightMode('light')\r\n            }\r\n        }\r\n    }\r\n\r\n}","import { ICuiLogger, IUIInteractionProvider, CuiElement, CuiContext } from \"../../core/models/interfaces\";\r\nimport { CuiLoggerFactory } from \"../../core/factories/logger\";\r\nimport { is } from \"../../core/utils/functions\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\n\r\nexport class CuiHandlerBase implements CuiContext {\r\n    _log: ICuiLogger;\r\n    utils: CuiUtils;\r\n    element: Element;\r\n    cuid: string\r\n    constructor(componentName: string, element: Element, utils: CuiUtils) {\r\n        this._log = CuiLoggerFactory.get(componentName);\r\n        this.utils = utils;\r\n        this.element = element;\r\n        this.cuid = (<any>element).$cuid;\r\n    }\r\n\r\n\r\n    mutate(callback: any, ...args: any[]): void {\r\n        this.utils.interactions.mutate(callback, this, ...args)\r\n    }\r\n\r\n    fetch(callback: any, ...args: any[]): void {\r\n        this.utils.interactions.fetch(callback, this, ...args)\r\n    }\r\n\r\n    getEventName(name: string) {\r\n        return [name, this.cuid].join('-');\r\n    }\r\n\r\n    emitEvent(event: string, ...data: any[]) {\r\n        this.utils.bus.emit(event, this.cuid, ...data)\r\n    }\r\n\r\n    onEvent(event: string, callback: any) {\r\n        this.utils.bus.on(event, callback, this)\r\n    }\r\n\r\n    getId(): string {\r\n        return this.cuid;\r\n    }\r\n}","import { ICuiComponent, ICuiMutationHandler, ICuiParsable } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { CuiHandlerBase } from \"../../app/handlers/base\";\r\nimport { ICONS } from \"../../core/utils/statics\";\r\nimport { is, createElementFromString, isString, getStringOrDefault } from \"../../core/utils/functions\";\r\n\r\nexport class CuiIconArgs implements ICuiParsable {\r\n    icon: string;\r\n\r\n    parse(val: any) {\r\n        if (!is(val)) {\r\n            this.icon = null;\r\n        }\r\n        if (isString(val)) {\r\n            this.icon = val\r\n            return;\r\n        }\r\n        this.icon = getStringOrDefault(val.icon, \"\");\r\n    }\r\n}\r\n\r\nexport class CuiIconComponent implements ICuiComponent {\r\n    attribute: string;\r\n    constructor(prefix?: string) {\r\n        this.attribute = `${prefix ?? 'cui'}-icon`;\r\n    }\r\n\r\n    getStyle(): string {\r\n        return null;\r\n    }\r\n\r\n    get(element: Element, utils: CuiUtils): ICuiMutationHandler {\r\n        return new CuiIconHandler(element, utils, this.attribute);\r\n    }\r\n}\r\n\r\n\r\n\r\nexport class CuiIconHandler extends CuiHandlerBase implements ICuiMutationHandler {\r\n    #currentIcon: string;\r\n    #attribute: string;\r\n    #args: CuiIconArgs;\r\n    constructor(element: Element, utils: CuiUtils, attribute: string) {\r\n        super(\"CuiIconHandler\", element, utils);\r\n        this.#currentIcon = null;\r\n        this.#attribute = attribute;\r\n        this.#args = new CuiIconArgs();\r\n    }\r\n\r\n\r\n    handle(args: any): void {\r\n        this._log.debug(\"Icon handle\", \"handle\")\r\n        this.#args.parse(args);\r\n        if (this.#currentIcon !== null) {\r\n            this._log.debug(\"Icon already initialized\")\r\n            return;\r\n        }\r\n        this.addIcon(this.#args.icon)\r\n        this.#currentIcon = this.#args.icon;\r\n    }\r\n\r\n    refresh(args: any): void {\r\n        this._log.debug(\"Icon refresh\", \"refresh\")\r\n        this.#args.parse(args);\r\n        if (this.#args.icon === this.#currentIcon) {\r\n            return;\r\n        }\r\n        this.addIcon(this.#args.icon);\r\n        this.#currentIcon = this.#args.icon;\r\n    }\r\n\r\n    destroy(): void {\r\n        this._log.debug(\"Icon delete\", \"destroy\")\r\n        const svg = this.element.querySelector('svg')\r\n        if (is(svg)) {\r\n            svg.remove();\r\n        }\r\n        this.#currentIcon = null;\r\n    }\r\n\r\n    private addIcon(icon: string) {\r\n        const iconStr = icon ? ICONS[icon] : null;\r\n        if (!iconStr) {\r\n            return;\r\n        }\r\n        const iconSvg = new IconBuilder(iconStr).build();\r\n        const svg = this.element.querySelector('svg')\r\n        if (is(svg)) {\r\n            svg.remove();\r\n        }\r\n\r\n        if (this.element.childNodes.length > 0) {\r\n            this.mutate(this.insertBefore, iconSvg)\r\n        } else {\r\n            this.mutate(this.appendChild, iconSvg)\r\n        }\r\n    }\r\n\r\n    private insertBefore(iconElement: Element) {\r\n        this.element.insertBefore(iconElement, this.element.firstChild);\r\n    }\r\n\r\n    private appendChild(iconElement: Element) {\r\n        this.element.appendChild(iconElement);\r\n    }\r\n}\r\n\r\nexport class IconBuilder {\r\n    #element: string;\r\n    #scale: number;\r\n    #style: string;\r\n\r\n    constructor(svgString: string) {\r\n        this.#element = svgString;\r\n        this.#scale = 1;\r\n    }\r\n\r\n    setStyle(style: string): IconBuilder {\r\n        this.#style = style;\r\n        return this\r\n    }\r\n\r\n    setScale(scale: number): IconBuilder {\r\n        this.#scale = scale\r\n        return this\r\n    }\r\n\r\n    build(): Element {\r\n        let created = createElementFromString(this.#element)\r\n        if (is(created) && this.#scale) {\r\n            let appender = new IconScaleAppender();\r\n            appender.append(created, this.#scale)\r\n        }\r\n        return created\r\n    }\r\n}\r\n\r\nexport class IconScaleAppender {\r\n    append(element: Element, value: number): void {\r\n        let width = element.hasAttribute(\"width\") ? parseInt(element.getAttribute(\"width\")) : 20;\r\n        let height = element.hasAttribute(\"height\") ? parseInt(element.getAttribute(\"height\")) : 20;\r\n        element.setAttribute(\"width\", (width * value).toString())\r\n        element.setAttribute(\"height\", (height * value).toString())\r\n    }\r\n}","import { ICuiComponent, ICuiMutationHandler, CuiObservables, CuiContext } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { CuiHandlerBase } from \"../../app/handlers/base\";\r\nimport { is, getRangeValue } from \"../../core/utils/functions\";\r\nimport { IconBuilder } from \"../icon/icon\";\r\nimport { ICONS } from \"../../core/utils/statics\";\r\n\r\nexport class CuiCircleComponent implements ICuiComponent {\r\n    attribute: string;\r\n    #iconStr: string;\r\n    constructor() {\r\n        this.attribute = 'circle-progress';\r\n        ICONS['special_circle_progress'] = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\"  class=\\\"circle-progress\\\" viewBox=\\\"0 0 100 100\\\" width=\\\"100\\\" height=\\\"100\\\"><path class=\\\"circle-progress-path\\\" d=\\\"M 50,5.3660047 A 44.867708,44.633994 0 0 1 94.867709,49.999997 44.867708,44.633994 0 0 1 50,94.633995 44.867708,44.633994 0 0 1 5.1322908,50.000001 44.867708,44.633994 0 0 1 50,5.3660047\\\"></path></svg>\";\r\n    }\r\n\r\n    getStyle(): string {\r\n        return null;\r\n    }\r\n\r\n    get(element: Element, utils: CuiUtils): ICuiMutationHandler {\r\n        return new CuiCircleHandler(element, utils, this.attribute);\r\n    }\r\n}\r\n\r\nexport class CuiCircleHandler extends CuiHandlerBase implements ICuiMutationHandler {\r\n    #isInitialized: boolean;\r\n    #factor: number;\r\n    #full: number;\r\n    #path: any;\r\n    #prevValue: number;\r\n    #attribute: string;\r\n    constructor(element: Element, utils: CuiUtils, attribute: string) {\r\n        super(\"CuiCircleHandler\", element, utils);\r\n        this.#factor = this.#full = 0;\r\n        this.#path = null\r\n        this.#prevValue = -1;\r\n        this.#attribute = attribute;\r\n    }\r\n\r\n    handle(args: any): void {\r\n        if (is(this.#isInitialized)) {\r\n            return;\r\n        }\r\n        const iconSvg = new IconBuilder(ICONS['special_circle_progress']).build();\r\n        const svg = this.element.querySelector('svg')\r\n        if (is(svg)) {\r\n            svg.remove();\r\n        }\r\n        this.element.appendChild(iconSvg);\r\n        this.#path = this.element.querySelector('.circle-progress-path');\r\n        this.#full = this.#path.getTotalLength();\r\n        this.#factor = this.#full / 100;\r\n        this.#isInitialized = true;\r\n        this.fetch(this.readStyle)\r\n    }\r\n\r\n    refresh(args: any): void {\r\n        this.fetch(this.readStyle)\r\n    }\r\n\r\n    destroy(): void {\r\n        this.#isInitialized = false\r\n    }\r\n\r\n    private updateStyle(value: number) {\r\n        this.#path.style.strokeDashoffset = value;\r\n    }\r\n\r\n    private readStyle(): void {\r\n        const value = this.element.hasAttribute(this.#attribute) ? parseInt(this.element.getAttribute(this.#attribute)) : 0;\r\n        if (value === this.#prevValue) {\r\n            return;\r\n        }\r\n        this.#prevValue = value;\r\n        const progress = getRangeValue(value, 0, 100);\r\n\r\n        this.mutate(this.updateStyle, this.#full - this.#factor * progress);\r\n    }\r\n\r\n}","import { ICuiComponent, ICuiMutationHandler, CuiObservables } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { IconBuilder } from \"../icon/icon\";\r\nimport { CuiHandlerBase } from \"../../app/handlers/base\";\r\nimport { ICONS } from \"../../core/utils/statics\";\r\nimport { is } from \"../../core/utils/functions\";\r\n\r\nexport class CuiSpinnerComponent implements ICuiComponent {\r\n    attribute: string;\r\n    constructor() {\r\n        this.attribute = 'data-spinner';\r\n        ICONS['special_circle_double'] = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"circle-double\\\" viewBox=\\\"0 0 100 100\\\" width=\\\"100\\\" height=\\\"100\\\"><path class=\\\"circle-double-outer\\\" d=\\\"M 50.000002,6.1070619 A 44.867709,44.126654 0 0 1 94.867708,50.233712 44.867709,44.126654 0 0 1 50.000002,94.36037 44.867709,44.126654 0 0 1 5.132292,50.233717 44.867709,44.126654 0 0 1 50.000002,6.1070619\\\"></path><path class=\\\"circle-double-inner\\\" d=\\\"M 50.000001,15.59972 A 35.383463,34.633995 0 0 1 85.383464,50.233711 35.383463,34.633995 0 0 1 50.000001,84.86771 35.383463,34.633995 0 0 1 14.616536,50.233716 35.383463,34.633995 0 0 1 50.000001,15.59972\\\"></path></svg>\"\r\n    }\r\n\r\n    getStyle(): string {\r\n        return null;\r\n    }\r\n\r\n    get(element: Element, utils: CuiUtils): ICuiMutationHandler {\r\n        return new CuiSpinnerHandler(element, utils, this.attribute);\r\n    }\r\n}\r\n\r\nexport class CuiSpinnerHandler extends CuiHandlerBase implements ICuiMutationHandler {\r\n    #attribute: string;\r\n    #isInitialized: boolean;\r\n    constructor(element: Element, utils: CuiUtils, attribute: string) {\r\n        super(\"CuiSpinnerHandler\", element, utils);\r\n        this.element = element;\r\n        this.#attribute = attribute\r\n        this.#isInitialized = false;\r\n    }\r\n\r\n    handle(args: any): void {\r\n        if (this.#isInitialized) {\r\n            return\r\n        }\r\n        const spinnerName = this.element.getAttribute(this.#attribute);\r\n        const svgIcon = is(spinnerName) ? ICONS[`spinner_${spinnerName}`] : null;\r\n        if (!is(svgIcon)) {\r\n            return;\r\n        }\r\n        const iconElement = new IconBuilder(svgIcon).build();\r\n        this.element.innerHTML = \"\";\r\n        this.#isInitialized = true\r\n        this.mutate(this.addSpinner, iconElement, spinnerName);\r\n    }\r\n\r\n    refresh(args: any): void {\r\n        if (this.#isInitialized) {\r\n            return\r\n        }\r\n    }\r\n\r\n    destroy(): void {\r\n        this.#isInitialized = false;\r\n        this.element.innerHTML = \"\";\r\n    }\r\n\r\n    private addSpinner(iconElement: Element, name: string) {\r\n        this.element.appendChild(iconElement);\r\n        this.element.classList.add(`animation-spinner-${name}`);\r\n    }\r\n\r\n}","import { ICuiComponent, ICuiMutationHandler } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { CuiHandlerBase } from \"../../app/handlers/base\";\r\n\r\nexport class CuiDummyComponent implements ICuiComponent {\r\n    attribute: string;\r\n    constructor() {\r\n        this.attribute = 'cui-dummy';\r\n    }\r\n\r\n    getStyle(): string {\r\n        return null;\r\n    }\r\n\r\n    get(element: Element, utils: CuiUtils): ICuiMutationHandler {\r\n        return new CuiDummyHandler(element, utils, this.attribute);\r\n    }\r\n}\r\n\r\nexport class CuiDummyHandler extends CuiHandlerBase implements ICuiMutationHandler {\r\n\r\n    #attribute: string;\r\n    constructor(element: Element, utils: CuiUtils, attribute: string) {\r\n        super(\"CuiDummyHandler\", element, utils);\r\n\r\n        this.#attribute = attribute\r\n    }\r\n\r\n    handle(args: any): void {\r\n\r\n    }\r\n\r\n    refresh(args: any): void {\r\n\r\n    }\r\n\r\n    destroy(): void {\r\n\r\n    }\r\n}","import { ICuiComponent, ICuiMutationHandler, CuiObservables } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { IconBuilder } from \"../icon/icon\";\r\nimport { CuiHandlerBase } from \"../../app/handlers/base\";\r\nimport { ICONS, EVENTS } from \"../../core/utils/statics\";\r\nimport { is, parseAttributeString, getOffsetTop } from \"../../core/utils/functions\";\r\n\r\nexport class CuiScrollComponent implements ICuiComponent {\r\n    attribute: string;\r\n    constructor(prefix?: string) {\r\n        this.attribute = is(prefix) ? prefix + 'scroll' : 'cui-scroll';\r\n    }\r\n\r\n    getStyle(): string {\r\n        return null;\r\n    }\r\n\r\n    get(element: HTMLElement, utils: CuiUtils): ICuiMutationHandler {\r\n        return new CuiScrollHandler(element, utils, this.attribute);\r\n    }\r\n}\r\n\r\nexport interface CuiScrollAttribute {\r\n    target?: string;\r\n    parent?: string;\r\n    behavior?: 'auto' | 'smooth';\r\n}\r\n\r\nexport class CuiScrollHandler extends CuiHandlerBase implements ICuiMutationHandler {\r\n    #attribute: string;\r\n    #args: CuiScrollAttribute;\r\n    #parent: HTMLElement;\r\n    #target: HTMLElement;\r\n    constructor(element: HTMLElement, utils: CuiUtils, attribute: string) {\r\n        super(\"CuiScrollHandler\", element, utils);\r\n        this.element = element;\r\n        this.#attribute = attribute\r\n        this.#args = null;\r\n        this.#parent = null;\r\n        this.#target = null;\r\n    }\r\n\r\n    handle(args: any): void {\r\n        this.parseArguments(args);\r\n        this.element.addEventListener('click', this.onClick.bind(this));\r\n    }\r\n\r\n    refresh(args: any): void {\r\n        this.parseArguments(args);\r\n    }\r\n\r\n    destroy(): void {\r\n        this.element.removeEventListener('click', this.onClick.bind(this));\r\n    }\r\n\r\n    onClick(ev: MouseEvent) {\r\n        if (!is(this.#target)) {\r\n            return;\r\n        }\r\n        let to = getOffsetTop(this.#target) - this.#parent.offsetTop;\r\n        let from = this.#parent.scrollTop;\r\n        let by = to - from;\r\n        this.#parent.scrollBy({\r\n            top: by,\r\n            behavior: this.#args.behavior ?? 'auto'\r\n        });\r\n        this.emitEvent(EVENTS.ON_SCROLL, {\r\n            to: to,\r\n            by: by,\r\n            target: this.#target,\r\n            parent: this.#parent,\r\n            timestamp: Date.now(),\r\n        })\r\n        ev.preventDefault();\r\n    }\r\n\r\n    private parseArguments(args: any): void {\r\n        this.#args = args;\r\n        this.#target = document.querySelector(this.#args.target) as HTMLElement;\r\n        if (is(this.#target)) {\r\n            this.#parent = is(this.#args.parent) ? document.querySelector(this.#args.parent) : this.#target.parentElement;\r\n        }\r\n    }\r\n}\r\n\r\n","import { ICuiEventListener } from \"../models/interfaces\";\r\nimport { getRangeValueOrDefault } from \"../utils/functions\";\r\n\r\nexport interface CuiScrollEvent {\r\n    base: Event;\r\n    top: number;\r\n    left: number;\r\n}\r\n\r\nexport class CuiScrollListener implements ICuiEventListener<CuiScrollEvent> {\r\n    #target: Element;\r\n    #inProgress: boolean;\r\n    #threshold: number;\r\n    #prevX: number;\r\n    #prevY: number;\r\n    #callback: (ev: CuiScrollEvent) => void;\r\n    constructor(target: Element, threshold?: number) {\r\n        this.#target = target;\r\n        this.#inProgress = false;\r\n        this.#threshold = getRangeValueOrDefault(threshold, 0, 100, 0);\r\n        this.#prevX = this.#prevY = 0;\r\n    }\r\n\r\n    setCallback(callback: (ev: CuiScrollEvent) => void) {\r\n        this.#callback = callback;\r\n    }\r\n\r\n    attach() {\r\n        this.#target.addEventListener('scroll', this.listener.bind(this))\r\n    }\r\n\r\n    detach() {\r\n        this.#target.removeEventListener('scroll', this.listener.bind(this))\r\n    }\r\n\r\n    isInProgress(): boolean {\r\n        return this.#inProgress;\r\n    }\r\n\r\n    private listener(ev: Event) {\r\n        this.#prevX += this.#target.scrollLeft;\r\n        this.#prevY += this.#target.scrollTop;\r\n        if (this.#inProgress || !this.passedThreshold()) {\r\n            return;\r\n        }\r\n        this.#inProgress = true;\r\n\r\n        requestAnimationFrame(() => {\r\n            this.#callback({\r\n                base: ev,\r\n                top: this.#target.scrollTop,\r\n                left: this.#target.scrollLeft\r\n            })\r\n            this.#inProgress = false\r\n            this.#prevX = 0;\r\n            this.#prevY = 0;\r\n        })\r\n    }\r\n\r\n    private passedThreshold() {\r\n        return this.#threshold <= 0 || (this.#prevX >= this.#threshold || this.#prevY >= this.#threshold);\r\n    }\r\n}","import { ICuiComponent, ICuiMutationHandler, CuiObservables } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { CuiHandlerBase } from \"../../app/handlers/base\";\r\nimport { CuiScrollListener, CuiScrollEvent } from \"../../core/listeners/scroll\";\r\nimport { ICuiComponentAction, CuiActionsFatory } from \"../../core/utils/actions\";\r\nimport { parseAttributeString, getRangeValue, is, getOffsetTop, getRangeValueOrDefault, isInRange, getOffsetLeft } from \"../../core/utils/functions\";\r\nimport { EVENTS } from \"../../core/utils/statics\";\r\nimport { CuiScrollSpyOutOfRangeError } from \"../../core/models/errors\";\r\n\r\nexport interface CuiScrollSpyAttribute {\r\n    selector?: string;\r\n    action?: string;\r\n    link?: string;\r\n    linkAction: string;\r\n    offset: number;\r\n}\r\n\r\n\r\nexport class CuiScrollSpyArgs {\r\n    selector: string;\r\n    action: ICuiComponentAction;\r\n    link?: string;\r\n    linkAction?: ICuiComponentAction;\r\n    offset?: number;\r\n\r\n    constructor() {\r\n        this.offset = 0;\r\n    }\r\n    parse(args: any) {\r\n        if (!args.selector) {\r\n            throw new Error(\"Incorrect arguments\");\r\n        }\r\n        this.selector = args.selector;\r\n        this.action = CuiActionsFatory.get(args.action);\r\n        this.link = args.link;\r\n        this.linkAction = CuiActionsFatory.get(args.linkAction);\r\n        this.offset = getRangeValueOrDefault(parseInt(args.offset), -1, 1, 0);\r\n    }\r\n}\r\nexport class CuiScrollspyComponent implements ICuiComponent {\r\n    attribute: string;\r\n    constructor(prefix?: string) {\r\n        this.attribute = `${prefix ?? 'cui'}-scrollspy`;\r\n    }\r\n\r\n    getStyle(): string {\r\n        return null;\r\n    }\r\n\r\n    get(element: Element, utils: CuiUtils): ICuiMutationHandler {\r\n        return new CuiScrollspyHandler(element, utils, this.attribute);\r\n    }\r\n}\r\n\r\nexport class CuiScrollspyHandler extends CuiHandlerBase implements ICuiMutationHandler {\r\n    #attribute: string;\r\n    #listener: CuiScrollListener;\r\n    #args: CuiScrollSpyArgs;\r\n    #links: Element[];\r\n    #targets: Element[];\r\n    #currentIdx: number;\r\n    #targetsLength: number;\r\n    #linksLength: number;\r\n    #prevScrollTop: number;\r\n    #prevScrollLeft: number;\r\n    constructor(element: Element, utils: CuiUtils, attribute: string) {\r\n        super(\"CuiScrollspyHandler\", element, utils);\r\n        this.element = element as HTMLElement;\r\n        this.#attribute = attribute;\r\n        this.#listener = new CuiScrollListener(this.element, this.utils.setup.scrollThreshold);\r\n        this.#args = new CuiScrollSpyArgs();\r\n        this.#links = [];\r\n        this.#targets = [];\r\n        this.#currentIdx = this.#targetsLength = this.#linksLength - 1;\r\n    }\r\n\r\n    handle(args: any): void {\r\n        this._log.debug(\"Handle\", \"handle\");\r\n        this.#prevScrollTop = this.element.scrollTop;\r\n        this.#prevScrollLeft = this.element.scrollLeft;\r\n        this.parseAttribute(args);\r\n        this.calculateCurrent(this.#prevScrollTop);\r\n        this.#listener.setCallback(this.onScroll.bind(this));\r\n        this.#listener.attach();\r\n    }\r\n\r\n    refresh(args: any): void {\r\n        this._log.debug(\"Refresh\")\r\n        this.parseAttribute(args);\r\n        this.#prevScrollTop = this.element.scrollTop;\r\n        this.#prevScrollLeft = this.element.scrollLeft;\r\n        this.calculateCurrent(this.#prevScrollTop);\r\n    }\r\n\r\n    destroy() {\r\n        this.#listener.detach();\r\n    }\r\n\r\n    private onScroll(ev: CuiScrollEvent): void {\r\n        let idx = -1;\r\n        if (Math.abs(ev.left - this.#prevScrollLeft) > Math.abs(ev.top - this.#prevScrollTop)) {\r\n            idx = this.calculateCurrentLeft(ev.left);\r\n        } else {\r\n            idx = this.calculateCurrent(ev.top);\r\n        }\r\n        if (idx !== this.#currentIdx) {\r\n            let newTarget = this.setCurrent(idx)\r\n            this.emitEvent(EVENTS.ON_TARGET_CHANGE, {\r\n                top: ev.top,\r\n                left: ev.left,\r\n                target: newTarget,\r\n                timestamp: Date.now()\r\n            })\r\n        }\r\n\r\n        this.#prevScrollTop = this.element.scrollTop;\r\n        this.#prevScrollLeft = this.element.scrollLeft;\r\n    }\r\n\r\n    private parseAttribute(args: any) {\r\n        this.#args.parse(args);\r\n        this.#targets = [...this.element.querySelectorAll(this.#args.selector)];\r\n        this.#links = this.#args.link ? [...document.querySelectorAll(this.#args.link)] : [];\r\n        this.#targetsLength = this.#targets.length;\r\n        this.#linksLength = this.#links.length;\r\n    }\r\n\r\n    private calculateCurrent(scroll: number): number {\r\n        return this.#targets.findIndex((target: HTMLElement) => {\r\n            let offset = getOffsetTop(target) - (<any>this.element).offsetTop;\r\n            let ratio = offset * this.#args.offset\r\n            return offset + ratio <= scroll && scroll < offset + target.clientHeight + ratio;\r\n        })\r\n    }\r\n\r\n    private calculateCurrentLeft(scroll: number): number {\r\n        return this.#targets.findIndex((target: HTMLElement) => {\r\n            let offset = getOffsetLeft(target) - (<any>this.element).offsetLeft;\r\n            let ratio = offset * this.#args.offset\r\n            return offset + ratio <= scroll && scroll < offset + target.clientWidth + ratio;\r\n        })\r\n    }\r\n    /**\r\n     * Performs action on current, new target and on links if there are any.\r\n     * Returns new target element or null if index is out of range\r\n     * \r\n     * @param idx - new target index\r\n     * @returns New target item\r\n     */\r\n    private setCurrent(idx: number): Element {\r\n        if (!isInRange(idx, 0, this.#targetsLength)) {\r\n            throw new CuiScrollSpyOutOfRangeError(\"New index is out of targets length\")\r\n        }\r\n        let ret = this.#targets[idx]\r\n        this.#args.action.add(ret)\r\n        this.#args.action.remove(this.#targets[this.#currentIdx]);\r\n        if (this.#linksLength > 0) {\r\n            if (isInRange(idx, 0, this.#linksLength)) {\r\n                this.#args.linkAction.add(this.#links[idx]);\r\n            }\r\n            if (isInRange(this.#currentIdx, 0, this.#linksLength)) {\r\n                this.#args.linkAction.remove(this.#links[this.#currentIdx]);\r\n            }\r\n        }\r\n        this.#currentIdx = idx;\r\n        return ret;\r\n    }\r\n}","import { ICuiPlugin } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { getSystemPrintMode } from \"../../core/utils/functions\";\r\nimport { CuiMediaQueryListener } from \"../../core/listeners/media\";\r\n\r\nexport interface AutoPrintPluginSetup {\r\n    autoPrint: boolean;\r\n}\r\n\r\nexport class CuiAutoPrintModePlugin implements ICuiPlugin {\r\n    description: string = 'Auto print mode';\r\n    name: string = 'auto-print';\r\n    setup: AutoPrintPluginSetup;\r\n    #listener: CuiMediaQueryListener;\r\n    #utils: CuiUtils;\r\n    constructor(autoPrintInit: AutoPrintPluginSetup) {\r\n        this.description = \"CuiAutoPrintModePlugin\";\r\n        this.setup = autoPrintInit;\r\n    }\r\n\r\n    init(utils: CuiUtils): void {\r\n        this.#utils = utils\r\n        if (this.setup.autoPrint && getSystemPrintMode()) {\r\n            this.#utils.setPrintMode(true)\r\n        }\r\n        this.#listener = new CuiMediaQueryListener('print')\r\n        this.#listener.setCallback(this.onChange.bind(this))\r\n        this.#listener.attach();\r\n    }\r\n\r\n    destroy(): void {\r\n        this.#listener.detach();\r\n    }\r\n\r\n    onChange(ev: MediaQueryListEvent) {\r\n        this.setup = this.#utils.setup.plugins[this.description] as AutoPrintPluginSetup;\r\n        let autoPrint = this.setup?.autoPrint ?? false;\r\n        if (autoPrint) {\r\n            console.log(ev.matches)\r\n            if (ev.matches) {\r\n                this.#utils.setPrintMode(true)\r\n            } else {\r\n                this.#utils.setPrintMode(false)\r\n            }\r\n        }\r\n    }\r\n\r\n}","import { is } from \"../../core/utils/functions\";\r\nimport { ICuiObserver, CuiElement } from \"../../core/models/interfaces\";\r\nimport { OBSERVABLE_INTERSECTION } from \"../../core/utils/statics\";\r\n\r\nexport interface ICuiIntersectionObserver {\r\n    observe(target: Element): void;\r\n    unobserve(target: Element): void;\r\n    disconnect(): void;\r\n}\r\n\r\nexport class CuiIntersectionEntry {\r\n    isInView: boolean;\r\n    ratio: number;\r\n}\r\n\r\nexport interface ICuiIntersectionHandler {\r\n    onIntersection(entry: CuiIntersectionEntry): Promise<boolean>;\r\n}\r\n\r\n// export interface ICuiObserverHandler {\r\n//     callback(entries: IntersectionObserverEntry[], observer: IntersectionObserver): void;\r\n// }\r\n\r\n// export class CuiObserverHandler implements ICuiObserverHandler {\r\n//     callback(entries: IntersectionObserverEntry[], observer: IntersectionObserver): void {\r\n//         entries.forEach((entry: any) => {\r\n//             Object.values(entry.target.$handlers).forEach((handler: any) => {\r\n//                 if (is(handler['onIntersection'])) {\r\n//                     handler.onIntersection({\r\n//                         isInView: entry.isIntersecting,\r\n//                         ratio: entry.intersectionRatio\r\n//                     });\r\n//                 }\r\n//             })\r\n//         })\r\n//     }\r\n// }\r\n\r\nexport class CuiIntersectionObserver implements ICuiObserver {\r\n    private observer: IntersectionObserver\r\n    // #handler: ICuiObserverHandler;\r\n    #root: Element;\r\n    #threshold: number[];\r\n    #callback: IntersectionObserverCallback;\r\n    constructor(root: Element, threshold?: number[]) {\r\n        this.#root = root;\r\n        this.#threshold = threshold ?? [0, 0.1, 0.25, 0.5, 0.75];\r\n        //this.#handler = observerHandler;\r\n    }\r\n\r\n    setCallback(callback: IntersectionObserverCallback) {\r\n        this.#callback = callback;\r\n    }\r\n\r\n    connect(): void {\r\n        this.observer = new IntersectionObserver(this.#callback, {\r\n            root: this.#root,\r\n            rootMargin: '0px',\r\n            threshold: this.#threshold\r\n        })\r\n    }\r\n\r\n    observe(target: Element): void {\r\n        this.observer.observe(target)\r\n    }\r\n\r\n    unobserve(target: Element): void {\r\n        this.observer.unobserve(target)\r\n    }\r\n\r\n    disconnect() {\r\n        this.observer.disconnect()\r\n    }\r\n\r\n}","import { ICuiComponent, ICuiMutationHandler } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { CuiHandlerBase } from \"../../app/handlers/base\";\r\nimport { CuiIntersectionObserver } from \"../../app/observers/intersection\";\r\nimport { CuiActionsFatory, ICuiComponentAction } from \"../../core/utils/actions\";\r\nimport { is, parseAttributeString, getRangeValueOrDefault, clone } from \"../../core/utils/functions\";\r\nimport { EVENTS } from \"../../core/utils/statics\";\r\n\r\nexport class CuiIntersectionAttributes {\r\n    target: string;\r\n    action: ICuiComponentAction;\r\n    offset: number\r\n    constructor() {\r\n        this.target = \"div\";\r\n        this.action = CuiActionsFatory.get('dummy');\r\n        this.offset = 0;\r\n    }\r\n\r\n    parse(args: any) {\r\n        this.target = is(args.target) ? args.target : 'div';\r\n        this.action = is(args.action) ? CuiActionsFatory.get(args.action) : CuiActionsFatory.get('dummy');\r\n        this.offset = getRangeValueOrDefault(parseInt(args.offset), 0, 1, 0);\r\n    }\r\n}\r\n\r\nexport class CuiIntersectionComponent implements ICuiComponent {\r\n    attribute: string;\r\n    constructor(prefix?: string) {\r\n        this.attribute = `${prefix ?? 'cui'}-intersection`;\r\n    }\r\n\r\n    getStyle(): string {\r\n        return null;\r\n    }\r\n\r\n    get(element: Element, utils: CuiUtils): ICuiMutationHandler {\r\n        return new CuiIntersectionHandler(element, utils, this.attribute);\r\n    }\r\n}\r\n\r\nexport class CuiIntersectionHandler extends CuiHandlerBase implements ICuiMutationHandler {\r\n    #attribute: string;\r\n    #observer: CuiIntersectionObserver;\r\n    #args: CuiIntersectionAttributes;\r\n    #targets: Element[];\r\n    constructor(element: Element, utils: CuiUtils, attribute: string) {\r\n        super(\"CuiIntersectionHandler\", element, utils);\r\n        this.#attribute = attribute\r\n        this.#observer = new CuiIntersectionObserver(this.element);\r\n        this.#args = new CuiIntersectionAttributes();\r\n        this.#targets = []\r\n    }\r\n\r\n    handle(args: any): void {\r\n        this.parseArguments(null, args);\r\n        this.#observer.setCallback(this.onIntersection.bind(this))\r\n        this.#observer.connect();\r\n        this.#targets.forEach(target => {\r\n            this.#observer.observe(target);\r\n        })\r\n    }\r\n\r\n    refresh(args: any): void {\r\n        let prev = clone(this.#args)\r\n        this.parseArguments(prev, args);\r\n    }\r\n\r\n    destroy(): void {\r\n        this.#observer.disconnect();\r\n    }\r\n\r\n    parseArguments(prev: CuiIntersectionAttributes, args: any) {\r\n        this.#args.parse(args);\r\n        if (prev === null || prev.target !== this.#args.target) {\r\n            this.#targets = [...document.querySelectorAll(this.#args.target)];\r\n        }\r\n    }\r\n\r\n    onIntersection(entries: IntersectionObserverEntry[], observer: IntersectionObserver): void {\r\n        if (!is(this.#targets)) {\r\n            return;\r\n        }\r\n        let action = null;\r\n        entries.forEach(entry => {\r\n            action = this.getAction(entry.target);\r\n            if (entry.isIntersecting && entry.intersectionRatio > this.#args.offset) {\r\n                action.add(entry.target)\r\n            } else {\r\n                action.remove(entry.target)\r\n            }\r\n            this.emitIntersection(entry)\r\n        })\r\n    }\r\n\r\n    getAction(element: Element) {\r\n        return element.hasAttribute('action') ? CuiActionsFatory.get(element.getAttribute('action')) : this.#args.action;\r\n    }\r\n\r\n    emitIntersection(entry: IntersectionObserverEntry) {\r\n        this.emitEvent(EVENTS.ON_INTERSECTION, {\r\n            entry: entry,\r\n            offset: this.#args.offset,\r\n            timestamp: Date.now()\r\n        })\r\n    }\r\n}","import { ICuiComponent, ICuiMutationHandler } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { CuiHandlerBase } from \"../../app/handlers/base\";\r\nimport { getStringOrDefault, getIntOrDefault, parseAttribute, is, getActiveClass, isString } from \"../../core/utils/functions\";\r\nimport { ICuiComponentAction, CuiActionsFatory } from \"../../core/utils/actions\";\r\nimport { CuiActionsHelper } from \"../../core/helpers/helpers\";\r\nimport { EVENTS } from \"../../core/utils/statics\";\r\n\r\nexport class CuiOpenArgs {\r\n    target: string;\r\n    action: ICuiComponentAction;\r\n    timeout: number;\r\n    constructor() {\r\n        this.target = \"\";\r\n        this.action = null;\r\n        this.timeout = 0;\r\n    }\r\n\r\n    parse(args: any) {\r\n        if (is(args) && isString(args)) {\r\n            this.target = args;\r\n            this.action = null;\r\n            this.timeout = -1\r\n            return;\r\n        }\r\n        this.target = getStringOrDefault(args.target, null);\r\n        this.action = CuiActionsFatory.get(args.action)\r\n        this.timeout = getIntOrDefault(args.timeout, -1);\r\n    }\r\n\r\n    isValid(): boolean {\r\n        return is(this.target);\r\n    }\r\n}\r\n\r\nexport class CuiOpenComponent implements ICuiComponent {\r\n    attribute: string;\r\n    #prefix: string;\r\n    constructor(prefix?: string) {\r\n        this.#prefix = prefix ?? 'cui';\r\n        this.attribute = `${this.#prefix}-open`;\r\n    }\r\n\r\n    getStyle(): string {\r\n        return null;\r\n    }\r\n\r\n    get(element: Element, utils: CuiUtils): ICuiMutationHandler {\r\n        return new CuiOpenHandler(element, utils, this.attribute, this.#prefix);\r\n    }\r\n}\r\n\r\nexport class CuiOpenHandler extends CuiHandlerBase implements ICuiMutationHandler {\r\n    #args: CuiOpenArgs;\r\n    #isInitialized: boolean;\r\n    #prefix: string;\r\n    #actionsHelper: CuiActionsHelper;\r\n    #inProgress: boolean;\r\n    constructor(element: Element, utils: CuiUtils, attribute: string, prefix: string) {\r\n        super(\"CuiOpenHandler\", element, utils);\r\n        this.#actionsHelper = new CuiActionsHelper(utils.interactions);\r\n        this.#args = new CuiOpenArgs();\r\n        this.#isInitialized = false;\r\n        this.#prefix = prefix;\r\n        this.#inProgress = false;\r\n\r\n    }\r\n\r\n    handle(args: any): void {\r\n        this._log.debug(\"Init\", \"handle\")\r\n        this.#args.parse(args);\r\n        if (this.#args.isValid()) {\r\n            this.element.addEventListener('click', this.onClick.bind(this))\r\n            this.#isInitialized = true;\r\n            this._log.debug(\"Initialized\", \"handle\")\r\n        }\r\n\r\n    }\r\n\r\n    refresh(args: any): void {\r\n        this._log.debug(\"Refresh\", \"refresh\")\r\n        this.#args.parse(args);\r\n        if (this.#args.isValid() && !this.#isInitialized) {\r\n            this.element.addEventListener('click', this.onClick.bind(this))\r\n            this.#isInitialized = true;\r\n            this._log.debug(\"Initialized\", \"refresh\")\r\n        }\r\n    }\r\n\r\n    destroy(): void {\r\n        this._log.debug(\"Destroy\", \"destroy\")\r\n        if (this.#isInitialized) {\r\n            this.element.removeEventListener('click', this.onClick.bind(this))\r\n            this._log.debug(\"Destoryed\", \"destroy\")\r\n        }\r\n\r\n    }\r\n\r\n    onClick(ev: MouseEvent) {\r\n        if (this.#inProgress) {\r\n            return;\r\n        }\r\n        const target = document.querySelector(this.#args.target);\r\n        if (!is(target)) {\r\n            this._log.warning(`Target ${this.#args.target} not found`, 'onClick')\r\n            return;\r\n        }\r\n        this.#inProgress = true;\r\n        if (this.#args.action && this.#args.timeout !== -1) {\r\n            let delay = this.#args.timeout > 0 ? this.#args.timeout : this.utils.setup.animationTime;\r\n            this.#actionsHelper.performAction(target, this.#args.action, delay).then(() => {\r\n                target.classList.add(getActiveClass(this.#prefix));\r\n                this.emitOpen(ev);\r\n                this.#inProgress = false;\r\n            });\r\n        } else {\r\n            target.classList.add(getActiveClass(this.#prefix));\r\n            this.emitOpen(ev);\r\n            this.#inProgress = false;\r\n        }\r\n        ev.preventDefault();\r\n    }\r\n\r\n    emitOpen(ev: MouseEvent) {\r\n        this.emitEvent(EVENTS.ON_OPEN, {\r\n            event: ev,\r\n            timestamp: Date.now()\r\n        })\r\n    }\r\n}","import { ICuiComponent, ICuiMutationHandler } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { CuiHandlerBase } from \"../../app/handlers/base\";\r\nimport { getStringOrDefault, getIntOrDefault, parseAttribute, is, getActiveClass, isString } from \"../../core/utils/functions\";\r\nimport { ICuiComponentAction, CuiActionsFatory } from \"../../core/utils/actions\";\r\nimport { CLASSES, EVENTS } from \"../../core/utils/statics\";\r\nimport { CuiActionsHelper } from \"../../core/helpers/helpers\";\r\n\r\nexport class CuiCloseArgs {\r\n    target: string;\r\n    action: ICuiComponentAction;\r\n    timeout: number;\r\n    constructor() {\r\n        this.target = \"\";\r\n        this.action = null;\r\n        this.timeout = 0;\r\n    }\r\n\r\n    parse(args: any) {\r\n        if (is(args) && isString(args)) {\r\n            this.target = args\r\n            this.action = null\r\n            this.timeout = -1\r\n            return;\r\n        }\r\n        this.target = getStringOrDefault(args.target, null);\r\n        this.action = CuiActionsFatory.get(args.action)\r\n        this.timeout = getIntOrDefault(args.timeout, -1);\r\n    }\r\n}\r\n\r\nexport class CuiCloseComponent implements ICuiComponent {\r\n    attribute: string;\r\n    #prefix: string;\r\n    constructor(prefix?: string) {\r\n        this.#prefix = prefix ?? 'cui';\r\n        this.attribute = `${this.#prefix}-close`;\r\n    }\r\n\r\n    getStyle(): string {\r\n        return null;\r\n    }\r\n\r\n    get(element: Element, utils: CuiUtils): ICuiMutationHandler {\r\n        return new CuiCloseHandler(element, utils, this.attribute, this.#prefix);\r\n    }\r\n}\r\n\r\nexport class CuiCloseHandler extends CuiHandlerBase implements ICuiMutationHandler {\r\n    #args: CuiCloseArgs;\r\n    #isInitialized: boolean;\r\n    #prefix: string;\r\n    #inProgress: boolean;\r\n    #actionHelper: CuiActionsHelper;\r\n    constructor(element: Element, utils: CuiUtils, attribute: string, prefix: string) {\r\n        super(\"CuiCloseHandler\", element, utils);\r\n        this.#actionHelper = new CuiActionsHelper(utils.interactions);\r\n        this.#args = new CuiCloseArgs();\r\n        this.#isInitialized = false;\r\n        this.#prefix = prefix;\r\n    }\r\n\r\n    handle(args: any): void {\r\n        this._log.debug(\"Init\", \"handle\")\r\n        this.#args.parse(args);\r\n        this.element.addEventListener('click', this.onClick.bind(this))\r\n        this.#isInitialized = true;\r\n        this._log.debug(\"Initialized\", \"handle\")\r\n    }\r\n\r\n    refresh(args: any): void {\r\n        this._log.debug(\"Refresh\", \"refresh\")\r\n        this.#args.parse(args);\r\n        if (!this.#isInitialized) {\r\n            this.element.addEventListener('click', this.onClick.bind(this))\r\n            this.#isInitialized = true;\r\n            this._log.debug(\"Initialized\", \"refresh\")\r\n        }\r\n    }\r\n\r\n    destroy(): void {\r\n        this._log.debug(\"Destroy\", \"destroy\")\r\n        if (this.#isInitialized) {\r\n            this.element.removeEventListener('click', this.onClick.bind(this))\r\n            this._log.debug(\"Destoryed\", \"destroy\")\r\n        }\r\n    }\r\n\r\n    onClick(ev: MouseEvent) {\r\n        if (this.#inProgress) {\r\n            return;\r\n        }\r\n        const target = this.getTarget();\r\n        if (!is(target)) {\r\n            this._log.warning(`Target ${this.#args.target} not found`, 'onClick')\r\n            return;\r\n        }\r\n        this.#inProgress = true;\r\n        if (this.#args.action && this.#args.timeout !== -1) {\r\n            let delay = this.#args.timeout > 0 ? this.#args.timeout : this.utils.setup.animationTime;\r\n            this.#actionHelper.performAction(target, this.#args.action, delay).then(() => {\r\n                target.classList.remove(getActiveClass(this.#prefix));\r\n                this.emitClose(ev);\r\n                this.#inProgress = false\r\n            })\r\n        } else {\r\n            target.classList.remove(getActiveClass(this.#prefix));\r\n            this.emitClose(ev);\r\n            this.#inProgress = false\r\n        }\r\n        ev.preventDefault();\r\n    }\r\n\r\n    private getTarget(): Element {\r\n        return is(this.#args.target) ? document.querySelector(this.#args.target) : this.element.parentElement;\r\n    }\r\n\r\n    private emitClose(ev: MouseEvent) {\r\n        this.emitEvent(EVENTS.ON_CLOSE, {\r\n            timestamp: Date.now(),\r\n            event: ev\r\n        })\r\n    }\r\n}","import { ICuiComponent, ICuiMutationHandler } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { CuiHandlerBase } from \"../../app/handlers/base\";\r\nimport { ICuiComponentAction, CuiActionsFatory } from \"../../core/utils/actions\";\r\nimport { is, isString, getStringOrDefault, getName, parseAttribute } from \"../../core/utils/functions\";\r\nimport { EVENTS } from \"../../core/utils/statics\";\r\n\r\nexport class CuiToggleArgs {\r\n    target: string;\r\n    action: ICuiComponentAction;\r\n    constructor() {\r\n        this.action = null;\r\n        this.target = null;\r\n    }\r\n\r\n    parse(args: any) {\r\n        if (is(args) && isString(args)) {\r\n            this.action = CuiActionsFatory.get(args)\r\n        } else {\r\n            this.target = getStringOrDefault(args.target, null);\r\n            this.action = CuiActionsFatory.get(args.action)\r\n        }\r\n    }\r\n}\r\nexport class CuiToggleComponent implements ICuiComponent {\r\n    attribute: string;\r\n    constructor(prefix?: string) {\r\n        this.attribute = `${prefix ?? \"cui\"}-toggle`;\r\n    }\r\n\r\n    getStyle(): string {\r\n        return null;\r\n    }\r\n\r\n    get(element: Element, utils: CuiUtils): ICuiMutationHandler {\r\n        return new CuiToggleHandler(element, utils, this.attribute);\r\n    }\r\n}\r\n\r\nexport class CuiToggleHandler extends CuiHandlerBase implements ICuiMutationHandler {\r\n    #attribute: string;\r\n    #args: CuiToggleArgs;\r\n    #target: Element;\r\n    #utils: CuiUtils;\r\n    constructor(element: Element, utils: CuiUtils, attribute: string) {\r\n        super(\"CuiToggleHandler\", element, utils);\r\n        this.#attribute = attribute\r\n        this.#args = new CuiToggleArgs();\r\n        this.#target = this.element;\r\n        this.#utils = utils;\r\n    }\r\n\r\n    handle(args: any): void {\r\n        this.#args.parse(args);\r\n        this.#target = this.getTarget();\r\n        this.element.addEventListener('click', this.onClick.bind(this));\r\n    }\r\n\r\n    refresh(args: any): void {\r\n        this.#args.parse(args);\r\n        this.#target = this.getTarget();\r\n    }\r\n\r\n    destroy(): void {\r\n        this.element.removeEventListener('click', this.onClick.bind(this));\r\n    }\r\n\r\n    onClick(ev: MouseEvent) {\r\n        this.#args.action.toggle(this.#target, this.#utils)\r\n        this.emitEvent(EVENTS.ON_TOGGLE, {\r\n            action: this.#args.action,\r\n            target: this.#target,\r\n            timestamp: Date.now()\r\n        })\r\n        ev.preventDefault();\r\n    }\r\n\r\n    getTarget(): Element {\r\n        return is(this.#args.target) ? document.querySelector(this.#args.target) : this.element;\r\n    }\r\n}","import { ICuiComponent, ICuiMutationHandler, CuiContext, ICuiEventBus } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { CuiHandlerBase } from \"../../app/handlers/base\";\r\nimport { ICuiResizable, CuiResizeData } from \"../../app/observers/resize\";\r\nimport { generateCUID } from \"../../core/utils/functions\";\r\nimport { EVENTS } from \"../../core/utils/statics\";\r\n\r\nexport class CuiResizeComponent implements ICuiComponent {\r\n    attribute: string;\r\n    constructor() {\r\n        this.attribute = 'cui-resize';\r\n    }\r\n\r\n    getStyle(): string {\r\n        return null;\r\n    }\r\n\r\n    get(element: Element, utils: CuiUtils): ICuiMutationHandler {\r\n        return new CuiResizeHandler(element, utils, this.attribute);\r\n    }\r\n}\r\n\r\nexport class CuiResizeHandler extends CuiHandlerBase implements ICuiMutationHandler, CuiContext {\r\n\r\n    #attribute: string;\r\n    #bus: ICuiEventBus;\r\n    constructor(element: Element, utils: CuiUtils, attribute: string) {\r\n        super(\"CuiResizeHandler\", element, utils);\r\n        this.#attribute = attribute\r\n        this.#bus = utils.bus;\r\n    }\r\n\r\n\r\n    handle(args: any): void {\r\n        //   this._log.debug(this.#element.getAttribute(this.#attribute));\r\n        this.#bus.on(EVENTS.ON_RESIZE, this.resize, this);\r\n    }\r\n\r\n    refresh(args: any): void {\r\n        // console.log(this.#element.getAttribute(this.#attribute));\r\n    }\r\n\r\n    destroy(): void {\r\n        this.#bus.detach(EVENTS.ON_RESIZE, this);\r\n    }\r\n\r\n    resize(data: CuiResizeData) {\r\n        console.log(data);\r\n    }\r\n\r\n    getId(): string {\r\n        return generateCUID(this.#attribute);\r\n    }\r\n}","import { ICuiEventListener } from \"../models/interfaces\";\r\nimport { is } from \"../utils/functions\";\r\n\r\nexport class CuiKeyPressListener implements ICuiEventListener<KeyboardEvent> {\r\n    #callback: (t: KeyboardEvent) => void;\r\n    #keys: string[];\r\n    #inProgress: boolean;\r\n    #singleEmit: boolean;\r\n    constructor(singleEmit: boolean, keys?: string[]) {\r\n        this.#keys = keys;\r\n        this.#inProgress = false;\r\n        this.#singleEmit = true;\r\n    }\r\n\r\n    setCallback(callback: (t: KeyboardEvent) => void): void {\r\n        this.#callback = callback;\r\n    }\r\n\r\n    isInProgress(): boolean {\r\n        return this.#inProgress;\r\n    }\r\n\r\n    attach(): void {\r\n        document.addEventListener('keydown', this.onKeyDown.bind(this))\r\n        if (this.#singleEmit) {\r\n            document.addEventListener('keyup', this.onKeyUp.bind(this))\r\n        }\r\n    }\r\n\r\n    detach(): void {\r\n        document.removeEventListener('keydown', this.onKeyDown.bind(this))\r\n        if (this.#singleEmit) {\r\n            document.addEventListener('keyup', this.onKeyUp.bind(this))\r\n        }\r\n    }\r\n\r\n    onKeyDown(ev: KeyboardEvent) {\r\n        if (this.#inProgress) {\r\n            return;\r\n        }\r\n        this.#inProgress = true;\r\n        try {\r\n            if (!is(this.#keys) || this.#keys.includes(ev.code)) {\r\n                this.#callback(ev);\r\n            }\r\n\r\n        } catch (e) {\r\n            console.error(e)\r\n        } finally {\r\n            if (!this.#singleEmit)\r\n                this.#inProgress = false;\r\n        }\r\n    }\r\n\r\n    onKeyUp(ev: KeyboardEvent) {\r\n        this.#inProgress = false;\r\n    }\r\n}","import { ICuiEventBus } from \"../../core/models/interfaces\";\r\nimport { CuiKeyPressListener } from \"../../core/listeners/keys\";\r\nimport { EVENTS } from \"../../core/utils/statics\";\r\nexport interface KeyDownEvent {\r\n    timestamp: number;\r\n    event: KeyboardEvent;\r\n}\r\nexport interface ICuiKeysObserver {\r\n    connect(): void;\r\n    disconnect(): void;\r\n}\r\nexport class CuiKeysObserver {\r\n    #listener: CuiKeyPressListener;\r\n    #bus: ICuiEventBus\r\n    constructor(bus: ICuiEventBus) {\r\n        this.#bus = bus;\r\n        this.#listener = new CuiKeyPressListener(true);\r\n        this.#listener.setCallback(this.onKeyDown.bind(this))\r\n    }\r\n    connect(): void {\r\n        this.#listener.attach();\r\n    }\r\n    disconnect(): void {\r\n        this.#listener.detach();\r\n    }\r\n\r\n    onKeyDown(ev: KeyboardEvent) {\r\n        this.#bus.emit(EVENTS.ON_KEYDOWN, null, {\r\n            timestamp: Date.now(),\r\n            event: ev\r\n        })\r\n    }\r\n\r\n}","import { ICuiPlugin } from \"../../core/models/interfaces\";\r\nimport { CuiUtils } from \"../../core/models/utils\";\r\nimport { ICuiKeysObserver, CuiKeysObserver } from \"./observer\";\r\n\r\n\r\nexport interface CuiKeysObserverPluginSetup {\r\n    autoPrint: boolean;\r\n}\r\n\r\nexport class CuiKeysObserverPlugin implements ICuiPlugin {\r\n    description: string;\r\n    name: string = 'keys-observer';\r\n    setup: CuiKeysObserverPluginSetup;\r\n    #keysObserver: ICuiKeysObserver;\r\n    constructor(keySetup: CuiKeysObserverPluginSetup) {\r\n        this.description = \"CuiKeysObserverPlugin\";\r\n        this.setup = keySetup;\r\n    }\r\n\r\n    init(utils: CuiUtils): void {\r\n        this.#keysObserver = new CuiKeysObserver(utils.bus);\r\n        this.#keysObserver.connect();\r\n    }\r\n\r\n    destroy(): void {\r\n        this.#keysObserver.disconnect();\r\n    }\r\n}","import { CuiSetupInit } from \"../core/models/setup\";\r\nimport { is } from \"../core/utils/functions\";\r\nimport { CuiInstance } from \"./instance\";\r\nimport { ICONS } from \"../core/utils/statics\";\r\nimport { ICuiPlugin, CuiInitData, CuiInitResult, ICuiComponent } from \"../core/models/interfaces\";\r\nimport { CuiAutoLightModePlugin } from \"../plugins/light/light\";\r\nimport { CuiIconComponent } from \"../components/icon/icon\";\r\nimport { CuiCircleComponent } from \"../components/circle/circle\";\r\nimport { CuiSpinnerComponent } from \"../components/spinner/spinner\";\r\nimport { CuiDummyComponent } from \"../components/dummy/dummy\";\r\nimport { CuiScrollComponent } from \"../components/scroll/scroll\";\r\nimport { CuiScrollspyComponent } from \"../components/scrollspy/scrollspy\";\r\nimport { CuiAutoPrintModePlugin } from \"../plugins/print/print\";\r\nimport { CuiIntersectionComponent } from \"../components/intersection/intersection\";\r\nimport { CuiOpenComponent } from \"../components/open/open\";\r\nimport { CuiCloseComponent } from \"../components/close/close\";\r\nimport { CuiToggleComponent } from \"../components/toggle/toggle\";\r\nimport { CuiResizeComponent } from \"../components/resize/resize\";\r\nimport { CuiKeysObserverPlugin } from \"../plugins/keys/keys\";\r\n\r\nexport class CuiInitializer {\r\n    #window: any;\r\n    constructor() {\r\n        this.#window = window;\r\n    }\r\n\r\n    async init(setup: CuiInitData): Promise<CuiInitResult> {\r\n        let settings: CuiSetupInit = { ... new CuiSetupInit(), ...setup.setup }\r\n        const appPrefix: string = settings.app;\r\n        const result: CuiInitResult = {\r\n            result: false\r\n        }\r\n        if (is(this.#window[appPrefix])) {\r\n            result.message = \"Instance is already initialized\";\r\n            return result;\r\n        }\r\n        if (is(setup.icons)) {\r\n            for (let icon in setup.icons) {\r\n                ICONS[icon] = setup.icons[icon];\r\n            }\r\n        }\r\n        try {\r\n            this.#window[appPrefix] = new CuiInstance(settings, setup.plugins, setup.components)\r\n            this.#window[appPrefix].init();\r\n        } catch (e) {\r\n            console.error(e);\r\n            result.message = \"An error occured during initialization\";\r\n            return result;\r\n        }\r\n        result.result = true;\r\n        return result;\r\n    }\r\n}\r\n\r\nexport class CuiInit {\r\n    #isInitialized: boolean;\r\n    constructor() {\r\n        this.#isInitialized = false;\r\n    }\r\n\r\n    async init(data: CuiInitData): Promise<boolean> {\r\n        if (this.#isInitialized) {\r\n            console.log(\"Module is already initialized\")\r\n            return false;\r\n        }\r\n        const initializer = new CuiInitializer();\r\n        const pluginList: ICuiPlugin[] = [\r\n            new CuiAutoLightModePlugin({ autoLight: true }),\r\n            new CuiAutoPrintModePlugin({ autoPrint: true }),\r\n            new CuiKeysObserverPlugin(null)\r\n        ];\r\n\r\n        const componentList: ICuiComponent[] = [\r\n            new CuiIconComponent(),\r\n            new CuiCircleComponent(),\r\n            new CuiSpinnerComponent(),\r\n            new CuiDummyComponent(),\r\n            new CuiScrollComponent(),\r\n            new CuiScrollspyComponent(),\r\n            new CuiIntersectionComponent(),\r\n            new CuiOpenComponent(),\r\n            new CuiCloseComponent(),\r\n            new CuiToggleComponent(),\r\n            new CuiResizeComponent(),\r\n        ];\r\n\r\n        let result = await initializer.init({\r\n            setup: data.setup,\r\n            icons: data.icons,\r\n            plugins: is(data.plugins) ? [...pluginList, ...data.plugins] : pluginList,\r\n            components: is(data.components) ? [...componentList, ...data.components] : componentList\r\n        })\r\n        if (result.result) {\r\n            this.#isInitialized = true;\r\n            return true;\r\n        } else {\r\n            console.error(`A cUI instance failed to initialize: [${result.message ?? \"#\"}]`);\r\n        }\r\n        console.log(\"Cui Light failed to init\")\r\n        return false;\r\n\r\n    }\r\n}","import { IUIInteractionProvider } from \"../models/interfaces\";\r\n\r\nexport class FastDom implements IUIInteractionProvider {\r\n    private writes: any[];\r\n    private reads: any[];\r\n    private raf: any;\r\n    private isScheduled: boolean = false;\r\n    #limit: number;\r\n\r\n    constructor() {\r\n        this.raf = window.requestAnimationFrame.bind(window)\r\n        this.writes = []\r\n        this.reads = []\r\n        this.#limit = 5;\r\n    }\r\n    mutate(callback: any, ctx: any, ...args: any[]): void {\r\n        this.reads.push(this.createTask(callback, ctx, ...args))\r\n        this.schedule()\r\n    }\r\n\r\n    fetch(callback: any, ctx: any, ...args: any[]): void {\r\n        this.writes.push(this.createTask(callback, ctx, ...args))\r\n        this.schedule()\r\n    }\r\n\r\n    private createTask(callback: any, ctx: any, ...args: any[]): any {\r\n        return ctx || args ? callback.bind(ctx, ...args) : callback;\r\n    }\r\n\r\n    private run(tasks: any[]) {\r\n        let task = null\r\n        while (task = tasks.shift()) {\r\n            task()\r\n        }\r\n    }\r\n\r\n    private schedule(recursion?: number) {\r\n        if (!this.isScheduled) {\r\n            this.isScheduled = true;\r\n            if (recursion >= this.#limit) {\r\n                throw new Error(\"Fast Dom limit reached\")\r\n            } else {\r\n                this.raf(this.flush.bind(this, recursion));\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    private flush(recursion?: number) {\r\n        let rec: number = recursion ?? 0;\r\n        let error = null;\r\n        let writes = this.writes;\r\n        let reads = this.reads;\r\n\r\n        try {\r\n            this.run(reads);\r\n            this.run(writes);\r\n        } catch (e) {\r\n            error = e\r\n            console.error(e)\r\n        }\r\n        this.isScheduled = false;\r\n\r\n        if (error) {\r\n            this.schedule(rec + 1)\r\n        }\r\n        if (this.writes.length || this.reads.length) {\r\n            this.schedule(recursion + 1);\r\n        }\r\n    }\r\n}\r\n\r\nexport class SyncInteractions implements IUIInteractionProvider {\r\n    tasks: any[];\r\n    raf: any;\r\n    isRunning: boolean = false;\r\n    constructor() {\r\n        this.tasks = [];\r\n        this.raf = window.requestAnimationFrame.bind(window)\r\n    }\r\n\r\n    mutate(callback: any, ctx: any, ...args: any[]): void {\r\n        this.tasks.push(this.createTask(callback, ctx, ...args))\r\n        this.schedule()\r\n    }\r\n\r\n    fetch(callback: any, ctx: any, ...args: any[]): void {\r\n        this.tasks.push(this.createTask(callback, ctx, ...args))\r\n        this.schedule()\r\n    }\r\n\r\n    private schedule() {\r\n        if (!this.isRunning) {\r\n            this.isRunning = true;\r\n            this.raf(this.flush.bind(this))\r\n        }\r\n    }\r\n\r\n    private flush() {\r\n        let task = null\r\n        while (task = this.tasks.shift()) {\r\n            try {\r\n                task()\r\n            }\r\n            catch (e) {\r\n            }\r\n        }\r\n        this.isRunning = false\r\n    }\r\n\r\n    private createTask(callback: any, ctx: any, ...args: any[]): any {\r\n        return ctx || args ? callback.bind(ctx, ...args) : callback;\r\n    }\r\n\r\n}","import { ICuiDictionary, ICuiDictionaryItem } from \"../models/interfaces\";\r\nimport { ItemNotFoundError, ArgumentError } from \"../models/errors\";\r\nimport { is } from \"./functions\";\r\n\r\nexport class CuiDictionary<T> implements ICuiDictionary<T> {\r\n\r\n    #keys: string[];\r\n    #values: T[];\r\n\r\n    constructor(init?: ICuiDictionaryItem<T>[]) {\r\n        this.#keys = []\r\n        this.#values = []\r\n\r\n        if (init) {\r\n            init.forEach(x => {\r\n                if (!is(x.key)) {\r\n                    this.#keys = []\r\n                    this.#values = []\r\n                    throw new ArgumentError(\"Key is empty\");\r\n                }\r\n                this.add(x.key, x.value)\r\n            })\r\n        }\r\n    }\r\n\r\n    add(key: string, value: T): void {\r\n        this.throwOnEmptyKey(key)\r\n        if (this.containsKey(key))\r\n            throw new Error(\"Key already exists\");\r\n        this.#keys.push(key)\r\n        this.#values.push(value)\r\n    }\r\n\r\n    remove(key: string): void {\r\n        if (!is(key)) {\r\n            return\r\n        }\r\n        let index = this.#keys.indexOf(key);\r\n        if (index >= 0) {\r\n            this.#keys.splice(index, 1)\r\n            this.#values.splice(index, 1)\r\n        }\r\n    }\r\n    get(key: string): T {\r\n        this.throwOnEmptyKey(key)\r\n        let index = this.indexOf(key)\r\n        if (index < 0) {\r\n            return undefined;\r\n        }\r\n        return this.#values[index];\r\n    }\r\n    containsKey(key: string): boolean {\r\n        return is(key) && this.indexOf(key) >= 0\r\n    }\r\n    keys(): string[] {\r\n        return this.#keys\r\n    }\r\n    values(): T[] {\r\n        return this.#values;\r\n    }\r\n\r\n    indexOf(key: string): number {\r\n        return is(key) ? this.#keys.indexOf(key) : -1;\r\n    }\r\n\r\n    update(key: string, value: T): void {\r\n        this.throwOnEmptyKey(key)\r\n        let index = this.indexOf(key)\r\n        if (index < 0) {\r\n            throw new ItemNotFoundError(`Item with key [${key}] not found`)\r\n        }\r\n        this.#values[index] = value\r\n    }\r\n\r\n    clear() {\r\n        this.#values = [];\r\n        this.#keys = [];\r\n    }\r\n\r\n    private throwOnEmptyKey(key: string) {\r\n        if (!is(key)) {\r\n            throw new ArgumentError(\"Key is empty\");\r\n        }\r\n    }\r\n}","import { ICuiDictionary, CuiCachable, ICuiManager } from \"../../core/models/interfaces\";\r\nimport { CuiDictionary } from \"../../core/utils/dictionary\";\r\nimport { is } from \"../../core/utils/functions\";\r\n\r\nexport class CuiCacheManager implements ICuiManager<CuiCachable> {\r\n    #cache: ICuiDictionary<CuiCachable>;\r\n    #maxSize: number;\r\n    constructor(maxSize?: number) {\r\n        this.#cache = new CuiDictionary<CuiCachable>();\r\n        this.#maxSize = maxSize ?? 500;\r\n    }\r\n    put(key: string, element: CuiCachable): void {\r\n        if (!is(key)) return;\r\n        if (this.has(key)) {\r\n            this.#cache.update(key, element);\r\n            return;\r\n        }\r\n        this.clean();\r\n        this.#cache.add(key, element);\r\n    }\r\n\r\n    get(key: string): CuiCachable {\r\n        if (!is(key)) return null;\r\n        if (this.has(key)) {\r\n            let item = this.#cache.get(key);\r\n            if (item.refresh()) {\r\n                return item;\r\n            }\r\n            this.#cache.remove(key);\r\n        }\r\n        return null;\r\n    }\r\n\r\n    has(key: string): boolean {\r\n        return is(key) ? this.#cache.containsKey(key) : false;\r\n    }\r\n\r\n    remove(key: string): boolean {\r\n        if (!is(key)) return false;\r\n        if (this.has(key)) {\r\n            this.#cache.remove(key);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    clear(): void {\r\n        this.#cache.clear();\r\n    }\r\n\r\n    private clean() {\r\n        if (this.#cache.keys().length >= this.#maxSize) {\r\n            this.#cache.remove(this.#cache.keys()[0]);\r\n        }\r\n    }\r\n}\r\n\r\n","import { ICuiEventBus, CuiEventReceiver, ICuiLogger, ICuiEventEmitHandler, CuiContext, CuiElement } from \"../models/interfaces\";\r\nimport { is, are, generateRandomString } from \"../utils/functions\";\r\nimport { ArgumentError } from \"../models/errors\";\r\nimport { CuiLoggerFactory } from \"../factories/logger\";\r\n\r\nexport class CuiEventBus implements ICuiEventBus {\r\n    #events: { [event: string]: CuiEventReceiver }\r\n    #log: ICuiLogger;\r\n    #eventHandler: ICuiEventEmitHandler;\r\n\r\n    constructor(emitHandler: ICuiEventEmitHandler) {\r\n        this.#events = {};\r\n        this.#eventHandler = emitHandler;\r\n        this.#log = CuiLoggerFactory.get(\"CuiEventBus\");\r\n    }\r\n\r\n    /**\r\n     * Attaches event to event bus\r\n     * \r\n     * @param {string} name - Event name\r\n     * @param {any} callback - callback function\r\n     * @param {CuiContext} ctx - callback context with id\r\n     * @param {CuiElement} cui - optional - cui element which event shall be attached to \r\n     */\r\n    on(name: string, callback: any, ctx: CuiContext, cui?: CuiElement): string {\r\n        if (!are(name, callback)) {\r\n            throw new ArgumentError(\"Missing argument\")\r\n        }\r\n        // When context is not provided (e.g. anonymous function) then generate random\r\n        let id = this.prepareEventId(ctx);\r\n        this.#log.debug(`Attaching new event: [${name}] for: [${id}]`)\r\n        if (!this.#events[name]) {\r\n            this.#events[name] = {}\r\n        }\r\n\r\n        this.#events[name][id] = { ctx: ctx, callback: callback, $cuid: this.getCuid(cui) }\r\n        return id;\r\n    }\r\n\r\n    /**\r\n    * Detaches specific event from event bus\r\n    *\r\n    * @param {string} name - Event name\r\n    * @param {CuiContext} ctx - callback context with id\r\n    * @param {CuiElement} cui - optional - cui element which event shall be attached to\r\n    */\r\n    detach(name: string, ctx: CuiContext, cui?: CuiElement): void {\r\n        if (!are(name, ctx)) {\r\n            throw new ArgumentError(\"Missing argument\")\r\n        }\r\n        let ev = this.#events[name]\r\n        let id = ctx.getId();\r\n        this.#log.debug(`Detaching item: [${id}] from [${name}]`)\r\n        if (this.isAttached(ev, id)) {\r\n            delete ev[id];\r\n        }\r\n    }\r\n\r\n    /**\r\n    * Detaches all callbacks from event\r\n    *\r\n    * @param {string} name - Event name\r\n    */\r\n    detachAll(name: string): void {\r\n        if (is(name) && this.#events[name]) {\r\n            delete this.#events[name]\r\n        } else {\r\n            this.#log.error(`Event name is missing or incorrect`, \"detachAll\")\r\n        }\r\n    }\r\n\r\n    /**\r\n    * Emits event call to event bus\r\n    *\r\n    * @param {string} name - Event name\r\n    * @param {string} cuid - id of component which emits the event\r\n    * @param {any[]} args  - event arguments\r\n    */\r\n    async emit(event: string, cuid: string, ...args: any[]): Promise<boolean> {\r\n        if (!is(event)) {\r\n            throw new ArgumentError(\"Event name is incorrect\");\r\n        }\r\n        this.#log.debug(`Emit: [${event}]`)\r\n        await this.#eventHandler.handle(this.#events[event], cuid, args)\r\n        return true;\r\n    }\r\n\r\n    /**\r\n    * Checks whether given context is already attached to specific event\r\n    *\r\n    * @param {string} name - Event name\r\n    * @param {CuiContext} ctx - callback context with id\r\n    * @param {CuiElement} cui - optional - cui element which event shall be attached to\r\n    */\r\n    isSubscribing(name: string, ctx: CuiContext, cui?: CuiElement) {\r\n        let ev = this.#events[name]\r\n        return this.isAttached(ev, ctx.getId(), cui)\r\n    }\r\n\r\n    private isAttached(ev: CuiEventReceiver, id: string, cui?: CuiElement): boolean {\r\n        if (is(cui)) {\r\n            return is(ev) && is(id) && is(ev[id]) && is(ev[id].$cuid === cui.$cuid);\r\n        }\r\n        return is(ev) && is(id) && is(ev[id]);\r\n    }\r\n\r\n    private getCuid(cui: CuiElement) {\r\n        return is(cui) ? cui.$cuid : null;\r\n    }\r\n\r\n    private prepareEventId(ctx: CuiContext) {\r\n        return are(ctx) ? ctx.getId() : generateRandomString();\r\n    }\r\n}   ","import { ICuiEventEmitHandler, ICuiLogger, ICuiCallbackExecutor, CuiEventReceiver } from \"../models/interfaces\";\r\nimport { is } from \"../utils/functions\";\r\nimport { CuiLoggerFactory } from \"../factories/logger\";\r\n\r\ninterface EmitHandlerData {\r\n    events: CuiEventReceiver;\r\n    cuid: string;\r\n    args: any[];\r\n}\r\n\r\nclass EmitHandlerBase {\r\n    isBusy: boolean;\r\n    queue: EmitHandlerData[];\r\n    constructor() {\r\n        this.queue = [];\r\n        this.isBusy = false;\r\n    }\r\n    idMatches(emitId: string, handleId: string) {\r\n        return !is(emitId) || (is(emitId) && emitId === handleId);\r\n    }\r\n}\r\n\r\nexport class SimpleEventEmitHandler extends EmitHandlerBase implements ICuiEventEmitHandler {\r\n    #log: ICuiLogger;\r\n    #executor: ICuiCallbackExecutor;\r\n    constructor(executor: ICuiCallbackExecutor) {\r\n        super();\r\n        this.#executor = executor;\r\n        this.#log = CuiLoggerFactory.get(\"SimpleEventEmitHandler\");\r\n    }\r\n\r\n    async handle(events: CuiEventReceiver, cuid: string, args: any[]): Promise<void> {\r\n        if (!is(events)) {\r\n            this.#log.warning(\"No events provided\")\r\n            return\r\n        }\r\n        this.queue.push({\r\n            events: events,\r\n            cuid: cuid,\r\n            args: args\r\n        })\r\n        if (!this.isBusy) {\r\n            if (!this.isBusy) {\r\n                this.isBusy = true;\r\n                this.perform();\r\n                if (this.queue.length > 0) {\r\n                    await this.perform();\r\n                }\r\n                this.isBusy = false;\r\n            }\r\n        }\r\n        return;\r\n    }\r\n\r\n    private async perform() {\r\n        let task = this.queue.shift();\r\n        for (let id in task.events) {\r\n            let event = task.events[id]\r\n            try {\r\n                if (this.idMatches(task.cuid, event.$cuid))\r\n                    await this.#executor.execute(event.callback, event.ctx, task.args)\r\n            }\r\n            catch (e) {\r\n                this.#log.error(e)\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport class TaskedEventEmitHandler extends EmitHandlerBase implements ICuiEventEmitHandler {\r\n    #executor: ICuiCallbackExecutor;\r\n    constructor(executor: ICuiCallbackExecutor) {\r\n        super();\r\n        this.#executor = executor;\r\n    }\r\n\r\n    async handle(events: CuiEventReceiver, cuid: string, args: any[]): Promise<void> {\r\n        if (!is(events)) {\r\n            return\r\n        }\r\n        this.queue.push({\r\n            events: events,\r\n            cuid: cuid,\r\n            args: args\r\n        })\r\n        if (!this.isBusy) {\r\n            this.isBusy = true;\r\n            this.perform();\r\n            if (this.queue.length > 0) {\r\n                this.perform();\r\n            }\r\n            this.isBusy = false;\r\n        }\r\n        return;\r\n    }\r\n\r\n    private async perform(): Promise<void[]> {\r\n        let task = this.queue.shift();\r\n        let promises: Promise<void>[] = []\r\n        for (let id in task.events) {\r\n            let event = task.events[id]\r\n            if (this.idMatches(task.cuid, event.$cuid))\r\n                promises.push(this.#executor.execute(event.callback, event.ctx, task.args))\r\n        }\r\n        return Promise.all(promises)\r\n    }\r\n}\r\n","import { ICuiCallbackExecutor } from \"../models/interfaces\"\r\nimport { is } from \"../utils/functions\"\r\n\r\nexport class CuiCallbackExecutor implements ICuiCallbackExecutor {\r\n    async execute(callback: any, ctx: any, args: any[]): Promise<void> {\r\n        args = args ?? []\r\n        if (is(ctx)) {\r\n            callback.apply(ctx, args)\r\n        } else {\r\n            callback(...args)\r\n        }\r\n        return\r\n    }\r\n}","import { is } from \"../utils/functions\";\r\nimport { CuiUtils } from \"../models/utils\";\r\nimport { IUIInteractionProvider } from \"../models/interfaces\";\r\n\r\nexport interface ICuiDocumentStyleAppender {\r\n    append(style: string): boolean;\r\n}\r\n\r\nexport class CuiDocumentStyleAppender implements ICuiDocumentStyleAppender {\r\n    #interactions: IUIInteractionProvider;\r\n    constructor(interactions: IUIInteractionProvider) {\r\n        this.#interactions = interactions;\r\n    }\r\n\r\n    append(style: string): boolean {\r\n        if (is(style)) {\r\n            const head = document.head || document.getElementsByTagName('head')[0]\r\n            const node = document.createElement('style');\r\n            const text = document.createTextNode(style);\r\n            node.type = 'text/css';\r\n            node.appendChild(text);\r\n            head.appendChild(node);\r\n        }\r\n        return true;\r\n    }\r\n\r\n}","import { CuiColorSetType } from \"../../core/utils/types\";\r\nimport { is, getRangeValue, are } from \"../../core/utils/functions\";\r\nimport { IUIInteractionProvider } from \"../../core/models/interfaces\";\r\nimport { CuiColor, CuiColorSet } from \"../../core/models/colors\";\r\nimport { CSS_APP_BACKGROUND_COLORS, CSS_COMPONENT_BACKGROUND_COLORS, CSS_COMPONENT_BORDER_COLORS, CSS_THEMES } from \"../../core/utils/statics\";\r\n\r\nexport class CuiInstanceColorHandler {\r\n    #root: HTMLElement;\r\n    #interactions: IUIInteractionProvider;\r\n    #LIGHTEN_FACTOR: number = 15;\r\n    #DARKEN_FACTOR: number = 15;\r\n\r\n    constructor(interactions: IUIInteractionProvider) {\r\n        this.#root = document.documentElement;\r\n        this.#interactions = interactions;\r\n    }\r\n\r\n    setAppBackground(light: CuiColor, dark: CuiColor) {\r\n        this.setPropertyIn(CSS_APP_BACKGROUND_COLORS.light, light.toCssString());\r\n        this.setPropertyIn(CSS_APP_BACKGROUND_COLORS.dark, dark.toCssString());\r\n    }\r\n\r\n    setComponentBackground(light: CuiColor, dark: CuiColor) {\r\n        this.setPropertyIn(CSS_COMPONENT_BACKGROUND_COLORS.light, light.toCssString());\r\n        this.setPropertyIn(CSS_COMPONENT_BACKGROUND_COLORS.dark, dark.toCssString());\r\n    }\r\n\r\n    setBordersColors(light: CuiColor, dark: CuiColor) {\r\n        this.setPropertyIn(CSS_COMPONENT_BORDER_COLORS.light, light.toCssString());\r\n        this.setPropertyIn(CSS_COMPONENT_BORDER_COLORS.dark, dark.toCssString());\r\n    }\r\n\r\n    setColor(type: CuiColorSetType, set: CuiColorSet) {\r\n        const colors = CSS_THEMES[type];\r\n        const baseColor = set.base;\r\n        if (!is(colors) || !is(baseColor)) {\r\n            return\r\n        }\r\n        const mutedColor = set.muted ?? baseColor.clone().lighten(this.#LIGHTEN_FACTOR);\r\n        const activeColor = set.active ?? baseColor.clone().darken(this.#DARKEN_FACTOR);\r\n\r\n        this.#interactions.mutate(() => {\r\n            this.setProperty(colors.base, baseColor.toCssString());\r\n            this.setProperty(colors.active, activeColor.toCssString());\r\n            this.setProperty(colors.muted, mutedColor.toCssString());\r\n        }, this)\r\n\r\n    }\r\n\r\n    setLightenFactor(factor: number) {\r\n        this.#LIGHTEN_FACTOR = getRangeValue(factor, 0, 100);\r\n    }\r\n\r\n    setDarkenFactor(factor: number) {\r\n        this.#DARKEN_FACTOR = getRangeValue(factor, 0, 100);\r\n    }\r\n\r\n    setProperty(propertyName: string, value: string) {\r\n        this.#root.style.setProperty(propertyName, value);\r\n    }\r\n\r\n    setPropertyIn(propertyName: string, value: string) {\r\n        if (!are(value, propertyName)) {\r\n            return;\r\n        }\r\n        this.#interactions.mutate(this.setProperty, this, propertyName, value)\r\n    }\r\n}","import { CuiWindowSize } from \"../../core/utils/types\";\r\nimport { calcWindowSize } from \"../../core/utils/functions\";\r\nimport { ICuiEventBus } from \"../../core/models/interfaces\";\r\nimport { EVENTS } from \"../../core/utils/statics\";\r\n\r\nexport interface ICuiResizable {\r\n    resize(data: CuiResizeData): Promise<boolean>;\r\n}\r\n\r\nexport interface ICuiResizableObserver {\r\n    observe(target: ICuiResizable): void;\r\n    unobserve(target: ICuiResizable): void;\r\n    connect(): void;\r\n    disconnect(): void;\r\n}\r\n\r\nexport interface CuiResizeData {\r\n    current: CuiWindowSize;\r\n    previous: CuiWindowSize;\r\n    width: number;\r\n    height: number;\r\n    timestamp: number;\r\n}\r\n\r\nexport class CuiResizeObserver implements ICuiResizableObserver {\r\n\r\n    #items: ICuiResizable[];\r\n    #promises: Promise<boolean>[];\r\n    #prevYValue: number;\r\n    #inProgress: boolean;\r\n    #previousSize: CuiWindowSize;\r\n    #threshold: number;\r\n    #bus: ICuiEventBus\r\n    constructor(bus: ICuiEventBus, threshold?: number) {\r\n        this.#items = [];\r\n        this.#promises = [];\r\n        this.#prevYValue = window.innerWidth;\r\n        this.#inProgress = false;\r\n        this.#previousSize = calcWindowSize(window.innerWidth)\r\n        this.#threshold = threshold ?? 0;\r\n        this.#bus = bus;\r\n    }\r\n\r\n    observe(target: ICuiResizable): void {\r\n        let idx = this.#items.findIndex(x => x === target)\r\n        if (idx < 0) {\r\n            this.#items.push(target);\r\n        }\r\n    }\r\n\r\n    unobserve(target: ICuiResizable): void {\r\n        let idx = this.#items.findIndex(x => x === target)\r\n        if (idx >= 0) {\r\n            this.#items.splice(idx, 1)\r\n        }\r\n    }\r\n    connect(): void {\r\n        window.addEventListener('resize', this.listener.bind(this))\r\n    }\r\n\r\n    disconnect(): void {\r\n        window.removeEventListener('resize', this.listener.bind(this))\r\n    }\r\n\r\n    private listener(ev: UIEvent) {\r\n        if (this.#inProgress) {\r\n            return;\r\n        }\r\n        this.#inProgress = true\r\n        const diff = window.innerWidth - this.#prevYValue;\r\n\r\n        if (Math.abs(diff) >= this.#threshold) {\r\n            const currentSize = calcWindowSize(window.innerWidth);\r\n            if (currentSize !== this.#previousSize) {\r\n                const resizeData: CuiResizeData = {\r\n                    current: currentSize,\r\n                    previous: this.#previousSize,\r\n                    width: window.innerWidth,\r\n                    height: window.innerHeight,\r\n                    timestamp: Date.now()\r\n                };\r\n                this.#bus.emit(EVENTS.ON_RESIZE, null, resizeData)\r\n                if (this.#items.length > 0) {\r\n                    this.#promises = [];\r\n                    this.#items.forEach(x => {\r\n                        this.#promises.push(x.resize(resizeData))\r\n                    })\r\n                    Promise.all(this.#promises)\r\n                    this.#promises = [];\r\n                }\r\n\r\n                this.#previousSize = currentSize;\r\n            }\r\n        }\r\n        this.#inProgress = false\r\n    }\r\n\r\n\r\n}","import { IUIInteractionProvider, ICuiEventBus, ICuiManager, CuiCachable } from \"./interfaces\";\r\nimport { CuiSetup, CuiSetupInit } from \"./setup\";\r\nimport { CuiLightMode } from \"../utils/types\";\r\nimport { CuiInteractionsFactory } from \"../factories/interactions\";\r\nimport { CuiCacheManager } from \"../../app/managers/cache\";\r\nimport { CuiEventBus } from \"../bus/bus\";\r\nimport { TaskedEventEmitHandler } from \"../bus/handlers\";\r\nimport { CuiCallbackExecutor } from \"../bus/executors\";\r\nimport { getName, replacePrefix } from \"../utils/functions\";\r\nimport { CLASSES } from \"../utils/statics\";\r\nimport { ICuiDocumentStyleAppender, CuiDocumentStyleAppender } from \"../styles/appender\";\r\nimport { CuiInstanceColorHandler } from \"../../app/handlers/colors\";\r\nimport { ICuiResizableObserver, CuiResizeObserver } from \"../../app/observers/resize\";\r\n\r\nexport class CuiUtils {\r\n    interactions: IUIInteractionProvider;\r\n    bus: ICuiEventBus;\r\n    setup: CuiSetup;\r\n    cache: ICuiManager<CuiCachable>;\r\n    colors: CuiInstanceColorHandler;\r\n    styleAppender: ICuiDocumentStyleAppender;\r\n    #resizeObserver: ICuiResizableObserver;\r\n    constructor(initialSetup: CuiSetupInit) {\r\n        this.setup = new CuiSetup().fromInit(initialSetup);\r\n        this.interactions = CuiInteractionsFactory.get(initialSetup.interaction)\r\n        this.cache = new CuiCacheManager(this.setup.cacheSize);\r\n        this.bus = new CuiEventBus(new TaskedEventEmitHandler(new CuiCallbackExecutor()));\r\n        this.colors = new CuiInstanceColorHandler(this.interactions);\r\n        this.styleAppender = new CuiDocumentStyleAppender(this.interactions);\r\n        this.#resizeObserver = new CuiResizeObserver(this.bus, this.setup.resizeThreshold);\r\n        this.#resizeObserver.connect();\r\n    }\r\n\r\n    setLightMode(mode: CuiLightMode) {\r\n        const name: string = getName(this.setup.prefix, CLASSES.dark);\r\n        const classes = document.body.classList;\r\n        if (mode === 'dark' && !classes.contains(name)) {\r\n            this.interactions.mutate(() => {\r\n                classes.add(name);\r\n            }, this)\r\n\r\n        } else if (mode === 'light' && classes.contains(name)) {\r\n            this.interactions.mutate(() => {\r\n                classes.remove(name);\r\n            }, this)\r\n        }\r\n    }\r\n\r\n    getLightMode(): CuiLightMode {\r\n        const name: string = getName(this.setup.prefix, CLASSES.dark);\r\n        return document.body.classList.contains(name) ? 'dark' : 'light';\r\n    }\r\n\r\n    setPrintMode(flag: boolean) {\r\n        const name: string = getName(this.setup.prefix, CLASSES.print);\r\n        const classes = document.body.classList;\r\n        if (flag && !classes.contains(name)) {\r\n            classes.add(name);\r\n\r\n        } else if (!flag && classes.contains(name)) {\r\n            classes.remove(name);\r\n        }\r\n    }\r\n\r\n    isPrintMode(): boolean {\r\n        const name: string = getName(this.setup.prefix, CLASSES.print);\r\n        return document.body.classList.contains(name);\r\n    }\r\n\r\n    setProperty(name: string, value: string) {\r\n        let prop = replacePrefix(name, this.setup.prefix);\r\n        document.documentElement.style.setProperty(prop, value);\r\n    }\r\n}","import { IUIInteractionProvider } from \"../models/interfaces\";\r\nimport { CuiInteractionsType } from \"../utils/types\";\r\nimport { FastDom, SyncInteractions } from \"../utils/interactions\";\r\n\r\nexport class CuiInteractionsFactory {\r\n    /**\r\n     * Gets new instance of component focused logger\r\n     * @param type - Interactions type\r\n     */\r\n    public static get(type: CuiInteractionsType): IUIInteractionProvider {\r\n        const interactionType = type;\r\n        switch (interactionType) {\r\n            case 'async':\r\n                return new FastDom();\r\n            default:\r\n                return new SyncInteractions();\r\n        }\r\n    }\r\n}","import { CuiInit } from './app/initializer';\r\n\r\n\r\ndeclare global {\r\n    interface Window {\r\n        cuiInit: CuiInit;\r\n    }\r\n}\r\n\r\nexport * from \"./core/models/interfaces\";\r\nexport * from './core/models/events';\r\nexport * from './core/models/setup';\r\nexport * from './core/models/utils';\r\nexport * from './app/initializer'\r\n\r\nwindow.cuiInit = new CuiInit();"],"sourceRoot":""}